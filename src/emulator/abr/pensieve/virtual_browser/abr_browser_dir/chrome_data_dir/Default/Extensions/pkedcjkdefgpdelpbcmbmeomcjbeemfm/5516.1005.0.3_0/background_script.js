'use strict';window.navigator.userAgent.match(/Chrome\/([0-9]+)/);var oi=function(a,b){this.type=a;this.entryPoint=b};m("castApp.frontEnd.ExtensionMessage",oi,void 0);var pi=function(a){return"urn:x-cast:com.google.cast."+a},qi=pi("tp.connection"),ri=pi("receiver"),si=pi("media"),ti=pi("webrtc"),ui=Lb({Eha:qi,Fha:pi("tp.heartbeat"),Wga:ri,MEDIA:si,Yfa:pi("media.universalRemote.optIn"),Zha:ti});var vi=function(a){return"available"==a||"available_rescan"==a};var wi=function(a,b,c,e,f){this.id=a;this.friendlyName=b;this.iconType=c||"generic";this.description=e||null;this.domain=f||null;this.isLaunching_=!1};pa.cO=window.localStorage;
var xi=0,zi=function(a){return(a=window.localStorage.getItem(yi(a,!1)))?JSON.parse(a):null},Ai=function(a){return(a=window.localStorage.getItem(yi(a,!0)))?JSON.parse(a):null},Ci=function(a){if(Bi.has(a.la()))throw Error("Duplicate instance name "+a.la());Bi.set(a.la(),a);a.ib()},Ii=function(a){for(var b=0,c=ia(Object.keys(pa.cO)),e=c.next();!e.done;e=c.next()){var e=e.value,f=e.length+window.localStorage.getItem(e).length;e.startsWith("mr.")?xi+=f:b+=f}Di=a;(window.localStorage.getItem("version")&&window.localStorage.getItem("version")!==
chrome.runtime.getManifest().version||Ei(a))&&Fi();G(Gi,"initialize: "+xi+" bytes used, "+b+" other bytes");chrome.runtime.onSuspend.addListener(Hi)},Di=null,Gi=D("mr.PersistentDataManager"),Bi=new Map,yi=function(a,b){return"mr."+(b?"persistent.":"temp.")+a.la()},Ei=function(a){return!!window.localStorage.getItem("mrInstanceId")&&window.localStorage.getItem("mrInstanceId")!==a},Hi=function(){G(Gi,"onSuspend");Ji("version",chrome.runtime.getManifest().version);Di&&Ji("mrInstanceId",Di);Bi.forEach(Ki)},
Ki=function(a){var b=a.getData();b&&void 0!=b[0]&&Ji(yi(a,!1),JSON.stringify(b[0]));b&&void 0!=b[1]&&Ji(yi(a,!0),JSON.stringify(b[1]))},Ji=function(a,b){var c;c=window.localStorage.getItem(a);c=void 0!=c?b.length-c.length:a.length+b.length;52E5<=xi+c&&(F(Gi,"Unable to write "+c+" bytes"),Fi());52E5<=xi+c?E(Gi,"Unable to write "+c+" bytes after clearing temporary"):(window.localStorage.setItem(a,b),xi+=c)},Fi=function(){for(var a=ia(Object.keys(pa.cO)),b=a.next();!b.done;b=a.next())b=b.value,b.startsWith("mr.temp.")&&
(xi-=b.length+window.localStorage.getItem(b).length,delete window.localStorage[b]);G(Gi,"removeTemporary_: "+xi+" bytes used")};var Mi=function(){this.cA=Sa();this.xj=new Li(null,null);this.wj=new Li(null,null);this.Ww=[];this.Is=this.uk=0;Ci(this)};d=Mi.prototype;d.$k=function(a){a=a.toLowerCase();var b=new ji;b.update(a);b.update(this.cA);return"r"+Th(b.digest(),!0)};d.QY=function(){return this.xj.model?this.xj:this.wj.model?this.wj:new Li(null,null)};d.la=function(){return"SinkUtils"};
d.getData=function(){return[{recentLaunchedDevice:this.xj,recentDiscoveredDevice:this.wj},{receiverIdToken:this.cA,fixedIpList:this.Ww.join(","),castControlPort:this.uk,lastCloudSinkCheckTimeMillis:this.Is}]};
d.ib=function(){var a=zi(this);a&&(this.xj=a.recentLaunchedDevice||new Li(null,null),this.wj=a.recentDiscoveredDevice||new Li(null,null));if(a=Ai(this))this.cA=a.receiverIdToken||Sa(),this.Ww=a.fixedIpList&&a.fixedIpList.split(",")||[],this.uk=a.castControlPort||0,this.Is=a.lastCloudSinkCheckTimeMillis||0};ra(Mi);var Li=function(a,b){this.model=a;this.ip=b};var Ni=function(a,b){this.Bc=this.Xf=this.fh=this.Ab=this.va=null;this.Wd=new wi(Mi.N().$k(b),a);this.Xc={};this.Bq={};this.Gm=!1};d=Ni.prototype;d.mh=function(){return this.Wd};d.Qn=function(){return this.Wd.friendlyName};d.t$=function(a){this.Bc=a;return this};d.getId=function(){return this.Wd.id};d.bu=function(a){this.Wd.id=a;return this};d.GN=function(a){this.Gm=a;return this};
d.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.Wd.friendlyName!=a.Wd.friendlyName&&(this.Wd.friendlyName=a.Wd.friendlyName,b=!0);this.fh!=a.fh&&(this.fh=a.fh,b=!0);this.Xf!=a.Xf&&(this.Xf=a.Xf,b=!0);this.va!=a.va&&(this.va=a.va,b=!0);this.Ab!=a.Ab&&(this.Ab=a.Ab,b=!0);return b};d.R9=function(a){this.va=a;return this};d.Kb=function(){return this.Ab};d.rm=function(a){this.Ab=a;return this};d.o9=function(a){this.fh=a;return this};d.l9=function(a){this.Xf=a;return this};
d.se=function(a){return this.Xc[a]||"unknown"};d.uV=function(a){return this.Bq[a]||null};d.yp=function(a,b){this.Xc[a]=b;this.Bq[a]=v();return this};d.rO=function(){return"name = "+this.Wd.friendlyName+(this.va?", ip = "+this.va:"")+(this.Bc?", model = "+this.Bc:"")+", apps = "+JSON.stringify(this.Xc)};var Oi=function(a){var b=new Ni(a.Wd.friendlyName,"");b.Wd.id=a.Wd.id;b.va=a.va;b.Ab=a.Ab;b.fh=a.fh;b.Xf=a.Xf;b.Bc=a.Bc;b.Xc=a.Xc;b.Bq=a.Bq;b.Gm=a.Gm;return b};var Pi=function(a,b,c,e,f,g){a=Mi.N().$k(a);this.Me=new wi(a,b,this.rH(e));this.Bc=c||null;this.Gd=e||null;this.va=f||null;this.Ab=g||null;this.Xc={};this.Rk=!1},Qi=function(a){if(!a.Bc||!a.va)return null;var b=new Pi(a.mh().id,a.mh().friendlyName,a.Bc,void 0,a.va,Mi.N().uk||8009);b.Me.id=a.mh().id;b.SA(!0);return b};d=Pi.prototype;
d.update=function(a,b,c,e){var f=!1;this.Me.friendlyName!=a&&(this.Me.friendlyName=a,f=!0);this.va!=b&&(this.va=b,f=!0);this.Ab!=c&&(this.Ab=c,f=!0);this.Gd!=e&&(this.Gd=e,f=!0);return f};d.mh=function(){return this.Me};d.Qn=function(){return this.Me.friendlyName};d.rH=function(a){return a&1?"cast":a&32?"cast_audio_group":"cast_audio"};d.M8=function(a){this.Gd=a;this.Me.iconType=this.rH(this.Gd)};d.getId=function(){return this.Me.id};
var Ri=function(a){var b=new Pi("",a.friendlyName,a.modelName,a.capabilities,a.ip,a.port);b.Me.id=a.id;b.SA(a.discoveredByDial);b.Xc=a.appStatusMap;for(var c in b.Xc)"unavailable"==b.Xc[c]&&(b.Xc[c]="unavailable_rescan");return b};d=Pi.prototype;d.Kb=function(){return this.Ab};d.se=function(a){return this.Xc[a]||"unknown"};d.yp=function(a,b){this.Xc[a]=b};
d.rO=function(){return"name = "+this.Me.friendlyName+(this.va?", ip = "+this.va:"")+(this.Bc?", model = "+this.Bc:"")+", capabilities = "+this.Gd+", apps = "+JSON.stringify(this.Xc)};d.SA=function(a){this.Rk=a};var Si={Sfa:0,Jfa:1},Ti={Uha:0,oQ:1,Xga:2},Ui={DIAL:0,Wfa:1,Xfa:2,Pea:3},Vi={rga:0,TIMEOUT:1,FAILED:2},Wi={EC:0,hea:1,Hea:2,hfa:3,Bea:4,dga:5},Xi={HP:0,SUCCESS:1},Yi=function(a){Hg("MediaRouter.Cast.Session.Ended",a,Ti)},Zi=function(a){Hg("MediaRouter.Cast.Channel.ConnectResult",a,Xi)},$i=function(a){Hg("MediaRouter.Cast.Discovery.Type",a,Ui)},aj=function(a){Hg("MediaRouter.Cast.Session.Fail",a,Vi)};var bj=function(a){this.og=a},ej=function(a){var b=cj.get(a)||null;if(b)return Promise.resolve(b);b=dj.get(a);b||(b=new Vd,dj.set(a,b));return b.promise},fj=function(a){var b=a.og;if(cj.has(b))throw Error("Duplicate module "+b);cj.set(b,a);(b=dj.get(b))&&b.resolve(a)};bj.prototype.handleEvent=pa;var cj=new Map,dj=new Map;var gj=function(a,b,c,e){for(var f=[],g=3;g<arguments.length;++g)f[g-3]=arguments[g];this.Nb=a;this.og=b;this.uh=!1;this.Ea=c;this.q1=f;this.Ch=this.$T.bind(this)};d=gj.prototype;d.gA=function(){Ci(this);this.uh&&this.FE()};d.FE=function(){this.Ea.addListener.apply(this.Ea,[].concat([this.Ch],ka(this.q1)))};d.register=function(){this.uh||(this.uh=!0,this.FE())};d.unregister=function(){this.uh&&(this.Ea.removeListener(this.Ch),this.uh=!1)};d.$i=function(){return this.uh};
d.$T=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var e=this;if(c=cj.get(this.og)||null)return c.handleEvent.apply(c,[].concat([this.Ea],ka(b)));ej(this.og).then(function(a){return a.handleEvent.apply(a,[].concat([e.Ea],ka(b)))});return this.PT()};d.la=function(){return"mr.DeferredEventListener."+this.Nb};d.getData=function(){return[this.uh]};d.ib=function(){this.uh=zi(this)};d.PT=pa;var hj={serviceType:"_googlecast._tcp.local"},ij=null,jj=function(){ij||(ij=new gj("CastMdnsEventListener","mr.cast.SinkDiscoveryService",chrome.mdns.onServiceList,hj));return ij},kj=null,lj=function(){kj||(kj=Kg()?new gj("CastNetworkListChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworkListChanged):new gj("CastNetworksChangedEventListener","mr.cast.SinkDiscoveryService",chrome.networkingPrivate.onNetworksChanged));return kj};var mj=function(a,b){this.og="mr.cast.SinkDiscoveryService";this.fd=b;this.GD=a;this.GD.Z=this.Z.bind(this);this.gd=new C;this.wm=new C;this.pg=new C;this.rJ=null;this.uo=this.Ih="";this.Mk=null;this.cy=this.oo=!1;this.a=D("mr.cast.SinkDiscoveryService")};ja(mj,bj);d=mj.prototype;d.init=function(){Ci(this);this.oo&&(this.XI(),this.EF());fj(this)};d.XI=function(){G(this.a,"Start listening to network changes");lj().register()};
d.start=function(){var a=v(),b=jj();if(b.$i()){if(6E4>a-this.rJ)return;G(this.a,"Forcing mdns discovery");this.iV()}else G(this.a,"Adding mdns listener"),b.register();this.rJ=a};d.iV=function(){chrome.mdns.forceDiscovery(pa);var a=jj();a.unregister();a.register()};
d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.mdns.onServiceList)this.eL.apply(this,[].concat(ka(c)));else if(a==chrome.networkingPrivate.onNetworksChanged||a==chrome.networkingPrivate.onNetworkListChanged)this.EF();else throw Error("Unhandled event");};
d.CT=function(a){if(-1==a.serviceName.indexOf("._googlecast."))return null;var b={};a.serviceData.forEach(function(a){0==a.search(/[a-z]{2}=.+/)&&(b[a.substring(0,2)]=a.substring(3))});var c=b.id;if(!c)return F(this.a,"Missing ID"),null;var e=Mi.N().$k(c),f=Number(a.serviceHostPort.substring(a.serviceHostPort.indexOf(":")+1));if(isNaN(f)||0>f||65535<f)return F(this.a,"Missing or invalid port"),null;if(this.pg.ya(e)){var g=this.pg.get(e);if(g.va==a.ipAddress&&g.Kb()==f)return F(this.a,"Sink has pending connection "+
e),null;F(this.a,"Pending sink changed ip "+e);this.pg.remove(e)}g=b.fn;if(!g||!a.ipAddress)return F(this.a,"Missing friendly name or IP address"),null;var k=Number(b.ca),k=isNaN(k)?0:k;return(e=this.gd.get(e))?(e.update(g,a.ipAddress,f,k)&&(e.SA(!1),this.fd.wd(e)),null):new Pi(c,g,b.md||"",k,a.ipAddress,f)};d.refresh=function(){H(this.a,"Executing forceDiscovery.");chrome.mdns.forceDiscovery(pa)};d.eL=function(a){G(this.a,"Registering "+a.length+" devices");this.DT(a).forEach(this.N1,this)};
d.gw=function(a,b){var c=this;if(!this.pg.ya(a.getId())){this.pg.set(a.getId(),a);var e=function(){c.pg.remove(a.getId());0==c.pg.S()&&c.ap()};this.kn(a).then(function(e){e?(e=c.gd.get(a.getId()),b&&(e?e.Rk&&$i(3):$i(1)),c.Ym(a)):G(c.a,"Inaccessible sink: "+a.getId())}).then(e,e)}};d.N1=function(a){this.gw(a,!0)};d.DT=function(a){var b=this,c=[];a.forEach(function(a){(a=b.CT(a))&&c.push(a)});return c};
d.GE=function(a){var b=this.gd.get(a.getId()),c=null,e=a.va,f=a.Kb();null!=e&&null!=f&&(c=this.wm.get(e+":"+f));if(b&&!c){var g=a.va,k=a.Kb();g&&k&&this.wm.remove(g+":"+k)}c&&!b&&this.gd.remove(c.getId());this.gd.set(a.getId(),a);null!=e&&null!=f&&this.wm.set(e+":"+f,a)};d.Ym=function(a){G(this.a,"Adding sink "+a.getId());this.GE(a);this.oo||(this.oo=!0,this.XI());this.fd.pj(a);Mi.N().wj=new Li(a.Bc,a.va)};d.hz=function(a){G(this.a,"Channel error for sink "+a);this.fm(a)};
d.fm=function(a){var b=this.gd.get(a);if(b){G(this.a,"Removing sink "+a);this.gd.remove(a);a=b.va;var c=b.Kb();null!=a&&null!=c&&this.wm.remove(a+":"+c);this.fd.it(b)}};d.w6=function(){var a=this.gd.F();this.gd.clear();this.wm.clear();a.forEach(this.fd.it,this.fd)};d.kn=function(a){H(this.a,"Checking access to "+a.getId());return this.GD.Bk(a).then(function(b){if(a.Rk){var c=4;b.audioOnly||(c|=1);a.M8(c)}return!0},function(){return!1})};
d.ap=function(){var a=this;G(this.a,"Pruning inactive sinks.");zc(this.ho(),function(b){a.pg.set(b.getId(),b);var c=function(){a.pg.remove(b.getId())};a.kn(b).then(function(c){c||a.fm(b.getId())}).then(c,c)})};d.Z=function(a){return this.gd.get(a,null)};d.wZ=function(a,b){return this.wm.get(a+":"+b)};d.xZ=function(a){var b=[];zc(this.ho(),function(c){vi(c.se(a))&&b.push(c)});return b};d.ho=function(){return this.gd.Ux()};d.wd=function(a){this.fd.wd(a)};d.Nc=function(){return this.gd.F()};d.la=function(){return"cast.SinkDiscoveryService"};
d.getData=function(){var a=this,b={};zc(this.gd.AG(),function(c){var e;e=a.gd.get(c);e={id:e.getId(),ip:e.va,port:e.Kb(),friendlyName:e.Qn(),modelName:e.Bc,capabilities:e.Gd,discoveredByDial:e.Rk,appStatusMap:e.Xc};b[c]=e});return[new nj(b,this.uo),new oj(this.oo)]};d.ib=function(){var a=zi(this);a&&3==a.version&&(this.uo=a.networkIds,this.v0(a.sinkMap));if(a=Ai(this))this.oo=a.hasSavedSinks};d.v0=function(a){this.cy=0<Object.keys(a).length;for(var b in a){var c=Ri(a[b]);this.Z(c.getId())||this.GE(c)}this.ap()};
d.w1=function(a){this.cy=0<Object.keys(a).length;for(var b in a){var c=Ri(a[b]);this.Z(c.getId())||this.gw(c,!1)}};d.EF=function(){var a=this;G(this.a,"Fetching networks state");this.Mk&&Ki(this.Mk);chrome.networkingPrivate.getNetworks({networkType:"All",visible:!0,configured:!0},function(b){for(var c=[],e=0;e<b.length;e++)"Connected"==b[e].ConnectionState&&c.push(b[e].GUID);a.Zca(c.sort().join(","))})};
d.Zca=function(a){G(this.a,"Update current network "+pj(a));a!=this.Ih&&(this.Mk&&(Bi.delete(this.Mk.la()),this.Mk=null),a?(this.uo&&a!=this.uo?this.w6():this.ap(),this.uo=this.Ih=a,this.Mk=new qj(this,this.Ih)):this.Ih="")};var pj=function(a){for(var b=0,c=0;c<a.length;c++)b+=a.charCodeAt(c);return b},nj=function(a,b){this.sinkMap=a;this.networkIds=b;this.version=3},oj=function(a){this.hasSavedSinks=a},qj=function(a,b){this.Cd=a;this.Ih=b;Ci(this)};
qj.prototype.la=function(){return"cast.NetworkSink."+this.Ih};qj.prototype.getData=function(){var a=null,b=this.Cd.getData();b&&(this.Cd.cy||0<this.Cd.Nc().length)&&(a=b[0]);G(this.Cd.a,"Saving sink data for network "+pj(this.Ih));return[null,a]};qj.prototype.ib=function(){G(this.Cd.a,"Restoring sink data for network "+pj(this.Ih));var a=Ai(this);a&&3==a.version&&this.Cd.w1(a.sinkMap)};var rj={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var sj=function(){this.type="GET_STATUS";this.requestId=0};var tj=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var uj=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var vj=function(a,b){this.requestId=a;this.Fca=b;this.qO=null};vj.prototype.kz=function(){};var wj=function(){this.ic=new C};wj.prototype.TC=function(a){var b=this;this.ic.set(a.requestId,a);a.qO=setTimeout(function(){return b.Y3(a)},a.Fca)};wj.prototype.lp=function(a){var b=this.ic.get(a);if(!b)return null;clearTimeout(b.qO);this.ic.remove(a);return b};wj.prototype.Pi=function(a){return this.ic.get(a,null)};wj.prototype.Y3=function(a){this.ic.remove(a.requestId);a.kz()};var xj=function(a){this.pca=a;this.Ql=1E3*Math.floor(1E6*Math.random())};d=xj.prototype;d.SE=function(){Ci(this)};d.Wr=function(){var a=this.Ql++;0==a&&(a=this.Ql++);return a};d.la=function(){return"IdGenerator."+this.pca};d.getData=function(){return[this.Ql]};d.ib=function(){var a=zi(this);a&&(this.Ql=a)};var yj=function(a,b){this.Zc=a;this.Bd=b;this.sj=new wj;this.tL=new xj("cast.RequestIdGenerator")};d=yj.prototype;d.init=function(){this.tL.SE()};d.UC=function(a,b,c){var e=this.tL.Wr();a.requestId=e;a=new Vd;b=new zj(e,a,t(b)&&0<b?b:6E5,c);this.sj.TC(b);return b};d.nA=function(a){this.sj.lp(a.requestId)};d.lp=function(a){return this.sj.lp(a)};
d.sendRequest=function(a,b,c,e,f,g){var k=this;if(!ui.hasOwnProperty(c))return Promise.reject(Error("Custom namespace is not supported"));var p=this.UC(a,l(e)?e:3E3,f),q=p.Cb;this.Zc.St(b,c,a,f||this.Bd,g).then(null,function(){k.nA(p);q.reject(Aj)});return q.promise};d.sendMessage=function(a,b,c,e,f,g){var k=this,p=this.UC(a,l(e)?e:3E3,f),q=p.Cb;this.Zc.St(b,c,a,f||this.Bd,g).then(function(){k.nA(p);q.resolve(!0)},function(){k.nA(p);q.reject(Aj)});return q.promise};
d.V6=function(a,b){var c=new tj(a.appId);c.language=a.language?a.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return this.sendRequest(c,b,ri,a.requestSessionTimeout)};d.W6=function(a,b){return this.sendRequest(new uj(a),b,ri)};var Bj=Error("Timeout"),Aj=Error("Failed to send message"),zj=function(a,b,c,e){vj.call(this,a,c);this.Cb=b;this.sourceId=e};ja(zj,vj);zj.prototype.kz=function(){this.Cb.reject(Bj)};var Cj=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b;this.logRecord=this.deviceJustSetUp=void 0};m("castApp.eventPage.Message",Cj,void 0);var Dj=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};Cj.DeviceData=Dj;Cj.DeviceJustSetUp=function(a,b,c,e){this.ipAddress=a;this.name=b;this.udn=c;this.modelName=e};Cj.DeviceCapabilities=function(){};
Cj.LogRecord=function(a,b,c,e,f,g){this.levelName=a;this.levelValue=b;this.msg=c;this.loggerName=e;this.time=f;this.sequenceNumber=g};var Ej=function(a,b){this.Fc=a;this.Hd=b;this.Qk=new C;this.Pk=new Mc;this.KI=0;this.W1=new C("serviceCheck",this.M_.bind(this),"startDeviceMonitor",this.Z_.bind(this),"releaseDeviceMonitor",this.H_.bind(this),"deviceJustSetUp",this.r_.bind(this),"logRecord",this.y_.bind(this));chrome.runtime.onMessage.addListener(this.C_.bind(this));chrome.runtime.onMessageExternal.addListener(this.u_.bind(this));this.zf("serviceReady")};d=Ej.prototype;d.a=D("castApp.eventPage.Service");d.UP=3E4;
d.S_=function(){if(this.JD()){var a=new Mc;zc(this.Fc.ho(),function(b){var c=b.va;a.add(c);this.Qk.ya(c)||this.Hd.sendRequest(new sj,b,ri)}.bind(this));var b=!1;this.Qk.kb().forEach(function(c){a.contains(c)||(this.Qk.remove(c),b=!0)}.bind(this));b&&this.Pv()}};
d.m_=function(a,b){if(this.JD()&&ui.hasOwnProperty(b.namespace_)&&(a=a.va)&&(b=JSON.parse(b.data),"RECEIVER_STATUS"===b.type)){var c=b.status&&b.status.applications&&b.status.applications[0],e=b=null;c&&(c.appId&&(b=c.appId),c.sessionId&&(e=c.sessionId));c=this.Qk.get(a);this.Qk.set(a,new Dj(a,b,e));c&&c.appId===b||this.Pv()}};
d.JD=function(){if(0===this.Pk.S())return!1;var a=v();a-this.KI>this.UP&&(this.KI=a,chrome.tabs.query({url:["chrome://cast/*","chrome-extension://"+chrome.runtime.id+"/cast_setup/*"]},function(a){0===a.length?(G(this.a,"No tabs found. Clearing device monitor clients."),this.Pk.clear()):G(this.a,"Tab check found active tabs: "+a.map(function(a){return a.id}))}.bind(this)));a=this.Pk.S();G(this.a,"Monitor client count: "+a);return 0<a};
d.C_=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var e=this.W1.get(a.subtype);if(!e)return!1;if(!a.originId)return Ya("Missing origin ID in the incoming message."),!1;try{var f=e(a,b,c);f&&c(f)}catch(g){E(this.a,"Error while handling request",g)}return!1};d.zf=function(a,b){a=new Cj(a,b);H(this.a,"Sending message: "+JSON.stringify(a));chrome.runtime.sendMessage(a)};d.M_=function(){this.zf("serviceReady")};
d.Z_=function(a){this.Pk.contains(a.originId)?G(this.a,"Client: "+a.originId+"already registered, dispatching current device list."):(G(this.a,"Registering monitor client: "+a.originId),this.Pk.add(a.originId));this.Pv();this.k6()};d.H_=function(a){G(this.a,"Unregistering monitor client: "+a.originId);this.Pk.remove(a.originId)};
d.r_=function(a){a=a.deviceJustSetUp;var b=a.udn.replace(/-/g,"").toLowerCase(),c;a.capabilities&&(c=(a.capabilities.audioOutSupported?4:0)|(a.capabilities.videoOutSupported?1:0));c=new Pi(b,a.name,a.modelName,c,a.ipAddress,Mi.N().uk||8009);this.Fc.gw(c,!0)};d.y_=function(a){a=a.logRecord;a=new wd(new zd(a.levelName,a.levelValue),a.msg,a.loggerName,a.time,a.sequenceNumber);Md().logRecord(a)};d.Pv=function(){var a=this.Qk.F();this.zf("devices",a)};
d.k6=function(){this.Fc.refresh();this.Fc.Nc().forEach(function(a){this.Hd.sendRequest(new sj,a,ri)}.bind(this))};d.u_=function(a,b,c){switch(a.type){case "handshake":c(new oi("handshake"));break;case "launch":b=b.tab&&t(b.tab.id)?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(b,{url:"chrome://cast#"+a.entryPoint})}};chrome.cast.Hf={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};m("chrome.cast.AutoJoinPolicy",chrome.cast.Hf,void 0);chrome.cast.mq={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};m("chrome.cast.DefaultActionPolicy",chrome.cast.mq,void 0);chrome.cast.Og={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
m("chrome.cast.Capability",chrome.cast.Og,void 0);chrome.cast.If={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};m("chrome.cast.ErrorCode",chrome.cast.If,void 0);chrome.cast.pQ={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
m("chrome.cast.ReceiverAvailability",chrome.cast.pQ,void 0);chrome.cast.BQ={CHROME:"chrome",IOS:"ios",ANDROID:"android"};m("chrome.cast.SenderPlatform",chrome.cast.BQ,void 0);chrome.cast.oq={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};m("chrome.cast.ReceiverType",chrome.cast.oq,void 0);chrome.cast.CP={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};m("chrome.cast.DialAppState",chrome.cast.CP,void 0);chrome.cast.Wm={CAST:"cast",STOP:"stop"};
m("chrome.cast.ReceiverAction",chrome.cast.Wm,void 0);chrome.cast.AC={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};m("chrome.cast.SessionStatus",chrome.cast.AC,void 0);chrome.cast.VERSION=[1,2];m("chrome.cast.VERSION",chrome.cast.VERSION,void 0);chrome.cast.wda=!0;m("chrome.cast.usingPresentationApi",chrome.cast.wda,void 0);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};m("chrome.cast.Error",chrome.cast.Error,void 0);chrome.cast.AQ=function(a){this.platform=a;this.packageId=this.url=null};m("chrome.cast.SenderApplication",chrome.cast.AQ,void 0);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};
m("chrome.cast.Image",chrome.cast.Image,void 0);chrome.cast.Volume=function(a,b){this.level=l(a)?a:null;this.muted=l(b)?b:null};m("chrome.cast.Volume",chrome.cast.Volume,void 0);chrome.cast.uP=function(a,b,c,e,f){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=e||chrome.cast.Hf.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=f||chrome.cast.mq.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};m("chrome.cast.ApiConfig",chrome.cast.uP,void 0);chrome.cast.EP=function(a,b){this.appName=a;this.launchParameter=b||null};m("chrome.cast.DialRequest",chrome.cast.EP,void 0);
chrome.cast.sC=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};m("chrome.cast.DialLaunchData",chrome.cast.sC,void 0);chrome.cast.DP=function(a,b){this.doLaunch=a;this.launchParameter=b||null};m("chrome.cast.DialLaunchResponse",chrome.cast.DP,void 0);chrome.cast.zC=function(a,b,c){this.appId=a;this.capabilities=ua(b)?b:[chrome.cast.Og.VIDEO_OUT,chrome.cast.Og.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
m("chrome.cast.SessionRequest",chrome.cast.zC,void 0);
chrome.cast.jv=function(a,b,c,e){this.label=a;a=b;Pa.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(Ja,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Ka,"&lt;")),-1!=a.indexOf(">")&&(a=a.replace(La,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(Ma,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(Na,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(Oa,"&#0;")));this.friendlyName=a;this.capabilities=c||[];this.volume=e||null;this.receiverType=chrome.cast.oq.CAST;this.displayStatus=this.isActiveInput=null};
m("chrome.cast.Receiver",chrome.cast.jv,void 0);chrome.cast.qQ=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};m("chrome.cast.ReceiverDisplayStatus",chrome.cast.qQ,void 0);chrome.cast.DC=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};m("chrome.cast.Timeout",chrome.cast.DC,void 0);chrome.cast.timeout=new chrome.cast.DC;m("chrome.cast.timeout",chrome.cast.timeout,void 0);chrome.cast.tP="auto-join";
chrome.cast.xC="cast-session_";chrome.cast.media.Vm={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};m("chrome.cast.media.MediaCommand",chrome.cast.media.Vm,void 0);chrome.cast.media.he={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};m("chrome.cast.media.MetadataType",chrome.cast.media.he,void 0);chrome.cast.media.nq={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};m("chrome.cast.media.PlayerState",chrome.cast.media.nq,void 0);
chrome.cast.media.kv={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};m("chrome.cast.media.RepeatMode",chrome.cast.media.kv,void 0);chrome.cast.media.rQ={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};m("chrome.cast.media.ResumeState",chrome.cast.media.rQ,void 0);chrome.cast.media.BC={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};m("chrome.cast.media.StreamType",chrome.cast.media.BC,void 0);
chrome.cast.media.MP={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};m("chrome.cast.media.IdleReason",chrome.cast.media.MP,void 0);chrome.cast.media.NQ={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};m("chrome.cast.media.TrackType",chrome.cast.media.NQ,void 0);chrome.cast.media.KQ={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};m("chrome.cast.media.TextTrackType",chrome.cast.media.KQ,void 0);
chrome.cast.media.GQ={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};m("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.GQ,void 0);chrome.cast.media.LQ={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};m("chrome.cast.media.TextTrackWindowType",chrome.cast.media.LQ,void 0);
chrome.cast.media.HQ={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};m("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.HQ,void 0);chrome.cast.media.IQ={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};m("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.IQ,void 0);chrome.cast.media.JP=function(){this.customData=null};m("chrome.cast.media.GetStatusRequest",chrome.cast.media.JP,void 0);chrome.cast.media.cQ=function(){this.customData=null};m("chrome.cast.media.PauseRequest",chrome.cast.media.cQ,void 0);chrome.cast.media.eQ=function(){this.customData=null};m("chrome.cast.media.PlayRequest",chrome.cast.media.eQ,void 0);chrome.cast.media.zQ=function(){this.customData=this.resumeState=this.currentTime=null};m("chrome.cast.media.SeekRequest",chrome.cast.media.zQ,void 0);
chrome.cast.media.CQ=function(){this.customData=null};m("chrome.cast.media.StopRequest",chrome.cast.media.CQ,void 0);chrome.cast.media.QQ=function(a){this.volume=a;this.customData=null};m("chrome.cast.media.VolumeRequest",chrome.cast.media.QQ,void 0);chrome.cast.media.PP=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};m("chrome.cast.media.LoadRequest",chrome.cast.media.PP,void 0);
chrome.cast.media.GP=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};m("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.GP,void 0);chrome.cast.media.IP=function(){this.metadataType=this.type=chrome.cast.media.he.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};m("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.IP,void 0);
chrome.cast.media.WP=function(){this.metadataType=this.type=chrome.cast.media.he.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};m("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.WP,void 0);chrome.cast.media.OQ=function(){this.metadataType=this.type=chrome.cast.media.he.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
m("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.OQ,void 0);chrome.cast.media.XP=function(){this.metadataType=this.type=chrome.cast.media.he.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};m("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.XP,void 0);
chrome.cast.media.dQ=function(){this.metadataType=this.type=chrome.cast.media.he.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};m("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.dQ,void 0);chrome.cast.media.VP=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.BC.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
m("chrome.cast.media.MediaInfo",chrome.cast.media.VP,void 0);chrome.cast.media.gQ=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};m("chrome.cast.media.QueueItem",chrome.cast.media.gQ,void 0);chrome.cast.media.AP="CC1AD845";m("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.AP,void 0);chrome.cast.media.timeout={};
m("chrome.cast.media.timeout",chrome.cast.media.timeout,void 0);chrome.cast.media.timeout.load=0;chrome.cast.media.timeout.load=chrome.cast.media.timeout.load;chrome.cast.media.timeout.$a=0;chrome.cast.media.timeout.getStatus=chrome.cast.media.timeout.$a;chrome.cast.media.timeout.play=0;chrome.cast.media.timeout.play=chrome.cast.media.timeout.play;chrome.cast.media.timeout.pause=0;chrome.cast.media.timeout.pause=chrome.cast.media.timeout.pause;chrome.cast.media.timeout.seek=0;
chrome.cast.media.timeout.seek=chrome.cast.media.timeout.seek;chrome.cast.media.timeout.stop=0;chrome.cast.media.timeout.stop=chrome.cast.media.timeout.stop;chrome.cast.media.timeout.tm=0;chrome.cast.media.timeout.setVolume=chrome.cast.media.timeout.tm;chrome.cast.media.timeout.Jw=0;chrome.cast.media.timeout.editTracksInfo=chrome.cast.media.timeout.Jw;chrome.cast.media.timeout.K5=0;chrome.cast.media.timeout.queue=chrome.cast.media.timeout.K5;
chrome.cast.media.MQ=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};m("chrome.cast.media.Track",chrome.cast.media.MQ,void 0);chrome.cast.media.JQ=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};
m("chrome.cast.media.TextTrackStyle",chrome.cast.media.JQ,void 0);chrome.cast.media.iQ=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.kv.OFF;this.customData=null};m("chrome.cast.media.QueueLoadRequest",chrome.cast.media.iQ,void 0);chrome.cast.media.fQ=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};
m("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.fQ,void 0);chrome.cast.media.mQ=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};m("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.mQ,void 0);chrome.cast.media.hQ=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueJumpRequest",chrome.cast.media.hQ,void 0);
chrome.cast.media.lQ=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.lQ,void 0);chrome.cast.media.jQ=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};m("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.jQ,void 0);
chrome.cast.media.kQ=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};m("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.kQ,void 0);chrome.cast.media.u=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.nq.IDLE;this.currentTime=0;this.FI=-1;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.kv.OFF};m("chrome.cast.media.Media",chrome.cast.media.u,void 0);
chrome.cast.media.u.prototype.$a=function(){};chrome.cast.media.u.prototype.getStatus=chrome.cast.media.u.prototype.$a;chrome.cast.media.u.prototype.play=function(){};chrome.cast.media.u.prototype.play=chrome.cast.media.u.prototype.play;chrome.cast.media.u.prototype.k5=function(){};chrome.cast.media.u.prototype.playWithContext=chrome.cast.media.u.prototype.k5;chrome.cast.media.u.prototype.pause=function(){};chrome.cast.media.u.prototype.pause=chrome.cast.media.u.prototype.pause;
chrome.cast.media.u.prototype.f5=function(){};chrome.cast.media.u.prototype.pauseWithContext=chrome.cast.media.u.prototype.f5;chrome.cast.media.u.prototype.seek=function(){};chrome.cast.media.u.prototype.seek=chrome.cast.media.u.prototype.seek;chrome.cast.media.u.prototype.stop=function(){};chrome.cast.media.u.prototype.stop=chrome.cast.media.u.prototype.stop;chrome.cast.media.u.prototype.tm=function(){};chrome.cast.media.u.prototype.setVolume=chrome.cast.media.u.prototype.tm;
chrome.cast.media.u.prototype.Jw=function(){};chrome.cast.media.u.prototype.editTracksInfo=chrome.cast.media.u.prototype.Jw;chrome.cast.media.u.prototype.N5=function(){};chrome.cast.media.u.prototype.queueInsertItems=chrome.cast.media.u.prototype.N5;chrome.cast.media.u.prototype.L5=function(){};chrome.cast.media.u.prototype.queueAppendItem=chrome.cast.media.u.prototype.L5;chrome.cast.media.u.prototype.X5=function(){};chrome.cast.media.u.prototype.queueUpdateItems=chrome.cast.media.u.prototype.X5;
chrome.cast.media.u.prototype.S5=function(){};chrome.cast.media.u.prototype.queuePrev=chrome.cast.media.u.prototype.S5;chrome.cast.media.u.prototype.R5=function(){};chrome.cast.media.u.prototype.queueNext=chrome.cast.media.u.prototype.R5;chrome.cast.media.u.prototype.O5=function(a){this.ux(a)};chrome.cast.media.u.prototype.queueJumpToItem=chrome.cast.media.u.prototype.O5;chrome.cast.media.u.prototype.W5=function(){};chrome.cast.media.u.prototype.queueSetRepeatMode=chrome.cast.media.u.prototype.W5;
chrome.cast.media.u.prototype.U5=function(){};chrome.cast.media.u.prototype.queueRemoveItems=chrome.cast.media.u.prototype.U5;chrome.cast.media.u.prototype.T5=function(a){this.ux(a)};chrome.cast.media.u.prototype.queueRemoveItem=chrome.cast.media.u.prototype.T5;chrome.cast.media.u.prototype.V5=function(){};chrome.cast.media.u.prototype.queueReorderItems=chrome.cast.media.u.prototype.V5;
chrome.cast.media.u.prototype.Q5=function(a,b,c,e){a=this.ux(a);0>a||(0>b?e&&e(new chrome.cast.Error(chrome.cast.If.INVALID_PARAMETER)):a==b&&c&&c())};chrome.cast.media.u.prototype.queueMoveItemToNewIndex=chrome.cast.media.u.prototype.Q5;chrome.cast.media.u.prototype.xca=function(a){return-1<this.supportedMediaCommands.indexOf(a)};chrome.cast.media.u.prototype.supportsCommand=chrome.cast.media.u.prototype.xca;
chrome.cast.media.u.prototype.UW=function(){if(this.playerState==chrome.cast.media.nq.PLAYING&&0<=this.FI){var a=(v()-this.FI)/1E3,a=this.currentTime+this.playbackRate*a;this.media&&null!=this.media.duration&&a>this.media.duration&&(a=this.media.duration);0>a&&(a=0);return a}return this.currentTime};chrome.cast.media.u.prototype.getEstimatedTime=chrome.cast.media.u.prototype.UW;chrome.cast.media.u.prototype.wv=function(){};chrome.cast.media.u.prototype.addUpdateListener=chrome.cast.media.u.prototype.wv;
chrome.cast.media.u.prototype.xv=function(){};chrome.cast.media.u.prototype.addUpdateListenerWithContext=chrome.cast.media.u.prototype.xv;chrome.cast.media.u.prototype.oA=function(){};chrome.cast.media.u.prototype.removeUpdateListener=chrome.cast.media.u.prototype.oA;chrome.cast.media.u.prototype.pA=function(){};chrome.cast.media.u.prototype.removeUpdateListenerWithContext=chrome.cast.media.u.prototype.pA;
chrome.cast.media.u.prototype.ux=function(a){return fb(this.items,function(b){return b.itemId==a})};var Fj=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var Gj=function(a){this.Hd=a;this.a=D("mr.cast.ReceiverStatusQuerier")};Gj.prototype.bca=function(a){var b=this;return(new jf(u(this.J5,this,a),3500,5)).Xt(2).start().then(null,function(c){G(b.a,"Failed to get receiver status from "+a.getId());throw c;})};Gj.prototype.J5=function(a){G(this.a,"Query receiver status: "+a.getId());return this.Hd.sendRequest(new sj,a,ri)};var Hj=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.B=function(a,b,c,e,f){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=e;this.receiver=f;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.AC.CONNECTED;this.transportId=""};m("chrome.cast.Session",chrome.cast.B,void 0);chrome.cast.B.prototype.laa=function(a,b,c){this.oN(null,a,b,c)};chrome.cast.B.prototype.setReceiverVolumeLevel=chrome.cast.B.prototype.laa;
chrome.cast.B.prototype.oN=function(a,b,c,e){b=new Hj(new chrome.cast.Volume(b,null),this.receiver.volume);a.setReceiverVolume(this.sessionId,b,c,e)};chrome.cast.B.prototype.setReceiverVolumeLevelWithContext=chrome.cast.B.prototype.oN;chrome.cast.B.prototype.kaa=function(a,b,c){this.nN(null,a,b,c)};chrome.cast.B.prototype.setReceiverMuted=chrome.cast.B.prototype.kaa;
chrome.cast.B.prototype.nN=function(a,b,c,e){a=new Hj(new chrome.cast.Volume(null,b),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,c,e)};chrome.cast.B.prototype.setReceiverMutedWithContext=chrome.cast.B.prototype.nN;chrome.cast.B.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.B.prototype.leave=chrome.cast.B.prototype.leave;chrome.cast.B.prototype.stop=function(){};chrome.cast.B.prototype.stop=chrome.cast.B.prototype.stop;
chrome.cast.B.prototype.oca=function(){};chrome.cast.B.prototype.stopWithContext=chrome.cast.B.prototype.oca;chrome.cast.B.prototype.sendMessage=function(){};chrome.cast.B.prototype.sendMessage=chrome.cast.B.prototype.sendMessage;chrome.cast.B.prototype.V7=function(){};chrome.cast.B.prototype.sendMessageWithContext=chrome.cast.B.prototype.V7;chrome.cast.B.prototype.wv=function(){};chrome.cast.B.prototype.addUpdateListener=chrome.cast.B.prototype.wv;chrome.cast.B.prototype.xv=function(){};
chrome.cast.B.prototype.addUpdateListenerWithContext=chrome.cast.B.prototype.xv;chrome.cast.B.prototype.oA=function(){};chrome.cast.B.prototype.removeUpdateListener=chrome.cast.B.prototype.oA;chrome.cast.B.prototype.pA=function(){};chrome.cast.B.prototype.removeUpdateListenerWithContext=chrome.cast.B.prototype.pA;chrome.cast.B.prototype.hR=function(){};chrome.cast.B.prototype.addMessageListener=chrome.cast.B.prototype.hR;chrome.cast.B.prototype.iR=function(){};
chrome.cast.B.prototype.addMessageListenerWithContext=chrome.cast.B.prototype.iR;chrome.cast.B.prototype.fR=function(){};chrome.cast.B.prototype.addMediaListener=chrome.cast.B.prototype.fR;chrome.cast.B.prototype.gR=function(){};chrome.cast.B.prototype.addMediaListenerWithContext=chrome.cast.B.prototype.gR;chrome.cast.B.prototype.H6=function(){};chrome.cast.B.prototype.removeMediaListener=chrome.cast.B.prototype.H6;chrome.cast.B.prototype.I6=function(){};
chrome.cast.B.prototype.removeMediaListenerWithContext=chrome.cast.B.prototype.I6;chrome.cast.B.prototype.J6=function(){};chrome.cast.B.prototype.removeMessageListener=chrome.cast.B.prototype.J6;chrome.cast.B.prototype.K6=function(){};chrome.cast.B.prototype.removeMessageListenerWithContext=chrome.cast.B.prototype.K6;chrome.cast.B.prototype.v1=function(a){a.sessionId=this.sessionId};chrome.cast.B.prototype.loadMedia=chrome.cast.B.prototype.v1;chrome.cast.B.prototype.P5=function(a){a.sessionId=this.sessionId};
chrome.cast.B.prototype.queueLoad=chrome.cast.B.prototype.P5;var Kj=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=Ij(a);a=new chrome.cast.B(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||Jj(a)))return null;a.receiver.volume=b.volume;"boolean"==typeof b.isActiveInput&&(a.receiver.isActiveInput=b.isActiveInput);return a},Lj=function(a){var b=
[];if(!a)return b;a&1&&b.push(chrome.cast.Og.VIDEO_OUT);a&2&&b.push(chrome.cast.Og.VIDEO_IN);a&4&&b.push(chrome.cast.Og.AUDIO_OUT);a&8&&b.push(chrome.cast.Og.AUDIO_IN);a&32&&b.push(chrome.cast.Og.MULTIZONE_GROUP);return b},Ij=function(a){return new chrome.cast.jv(a.getId(),a.Qn(),Lj(a.Gd))},Mj=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],e=b.namespaces||[];if(c.length!=e.length)return!0;for(var f={index:0};f.index<c.length;f={index:f.index},f.index++)if(!e.some(function(a){return function(b){return b.name==
c[a.index].name}}(f)))return!0;return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},Nj=function(a){ua(a)?a.forEach(Nj):xa(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(xa(a[b])||ua(a[b]))&&Nj(a[b])})},Oj=function(a,b){return a.namespaces.some(function(a){return a.name==b})},Pj=["MultizoneLeader","MultizoneFollower"],Jj=function(a){return null!==a&&"MultizoneLeader"==a.appId},Qj=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==
a};var Rj=function(a){this.Hd=a;this.a=D("mr.cast.SessionLauncher")};Rj.prototype.Ly=function(a,b){Hg("MediaRouter.Cast.Session.Type",0,Si);return this.Hd.V6(a,b).then(this.x_.bind(this,b),function(a){a&&Bj==a?aj(1):aj(0);throw a;})};Rj.prototype.x_=function(a,b){H(this.a,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw aj(2),Error(b.reason);a=Kj(a,b.status);G(this.a,"Launched session: "+a.sessionId);return a};var Sj=function(a,b,c,e){this.type=a;this.message=b;this.sequenceNumber=l(c)?c:-1;this.timeoutMillis=e||0;this.clientId=""};var Tj=function(a,b){this.Nh=a;this.Wb=b;this.ZI=[];this.sj=new wj};d=Tj.prototype;d.$r=function(a){return(a=this.Wb.Rd(a))?a.routeId:null};d.listen=function(a,b){this.ZI[a]=b};d.Uc=function(a,b,c){H(Uj,"Sending to "+b);H(Uj,JSON.stringify(c));c.clientId=b;this.Nh.bU(a,c)};d.zg=function(a,b){var c=this,e=this.Wb.Rd(a);e&&e.ly?this.Uc(e.routeId,a,b):this.connect(a).then(function(e){e?(e=c.$r(a))?c.Uc(e,a,b):F(Uj,"No route for "+a):F(Uj,"No connected client "+a)},null)};
d.Oo=function(a){H(Uj,"App "+a);var b=this.$r(a);if(b){if(b=this.sj.lp(b))(a=this.Wb.Rd(a))?(a.ly=!0,b.Cb.resolve(!0)):b.Cb.resolve(!1)}else F(Uj,"No route for client "+a)};d.p2=function(a){H(Uj,"Received: "+a);a=JSON.parse(a);var b=a.clientId;"client_connect"==a.type?this.Oo(b):this.$r(b)?(b=this.ZI[a.type])&&b(a):F(Uj,"No route for "+b)};
d.connect=function(a){if(this.H0(a))return Promise.resolve(!0);var b=this.$r(a);if(!b)return F(Uj,"No route for client "+a),Promise.resolve(!1);if(a=this.sj.Pi(b))return a.Cb.promise;a=new Vd;this.sj.TC(new Vj(b,a));return a.promise};d.H0=function(a){a=this.Wb.Rd(a);return null!=a&&a.ly};var Uj=D("mr.cast.ApiMessenger"),Vj=function(a,b){vj.call(this,a,3E4);this.Cb=b};ja(Vj,vj);Vj.prototype.kz=function(){this.Cb.resolve(!1)};var Wj=function(a,b){this.Wk=this.Gf=this.xg="";this.Ab=null;this.Ii=this.xd="";this.Td=this.S0=!1;var c;a instanceof Wj?(this.Td=l(b)?b:a.Td,this.iu(a.xg),this.nB(a.ko()),this.om(a.cg()),this.rm(a.Kb()),this.$h(a.xd),this.fu(a.qg.clone()),this.au(a.Ii)):a&&(c=String(a).match(Rd))?(this.Td=!!b,this.iu(c[1]||"",!0),this.nB(c[2]||"",!0),this.om(c[3]||"",!0),this.rm(c[4]),this.$h(c[5]||"",!0),this.fu(c[6]||"",!0),this.au(c[7]||"",!0)):(this.Td=!!b,this.qg=new Xj(null,null,this.Td))};d=Wj.prototype;
d.toString=function(){var a=[],b=this.xg;b&&a.push(Yj(b,Zj,!0),":");var c=this.cg();if(c||"file"==b)a.push("//"),(b=this.ko())&&a.push(Yj(b,Zj,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.Kb(),null!=c&&a.push(":",String(c));if(c=this.xd)this.qs()&&"/"!=c.charAt(0)&&a.push("/"),a.push(Yj(c,"/"==c.charAt(0)?ak:bk,!0));(c=this.SW())&&a.push("?",c);(c=this.Ii)&&a.push("#",Yj(c,ck));return a.join("")};
d.resolve=function(a){var b=this.clone(),c=a.j0();c?b.iu(a.xg):c=a.k0();c?b.nB(a.ko()):c=a.qs();c?b.om(a.cg()):c=a.bI();var e=a.xd;if(c)b.rm(a.Kb());else if(c=a.aI()){if("/"!=e.charAt(0))if(this.qs()&&!this.aI())e="/"+e;else{var f=b.xd.lastIndexOf("/");-1!=f&&(e=b.xd.substr(0,f+1)+e)}f=e;if(".."==f||"."==f)e="";else if(-1!=f.indexOf("./")||-1!=f.indexOf("/.")){for(var e=Ea(f,"/"),f=f.split("/"),g=[],k=0;k<f.length;){var p=f[k++];"."==p?e&&k==f.length&&g.push(""):".."==p?((1<g.length||1==g.length&&
""!=g[0])&&g.pop(),e&&k==f.length&&g.push("")):(g.push(p),e=!0)}e=g.join("/")}else e=f}c?b.$h(e):c=a.i0();c?b.fu(a.rW()):c=a.f0();c&&b.au(a.Ii);return b};d.clone=function(){return new Wj(this)};d.iu=function(a,b){this.Fi();if(this.xg=b?dk(a,!0):a)this.xg=this.xg.replace(/:$/,"");return this};d.j0=function(){return!!this.xg};d.ko=function(){return this.Gf};d.nB=function(a,b){this.Fi();this.Gf=b?dk(a):a;return this};d.k0=function(){return!!this.Gf};d.cg=function(){return this.Wk};
d.om=function(a,b){this.Fi();this.Wk=b?dk(a,!0):a;return this};d.qs=function(){return!!this.Wk};d.Kb=function(){return this.Ab};d.rm=function(a){this.Fi();if(a){a=Number(a);if(isNaN(a)||0>a)throw Error("Bad port number "+a);this.Ab=a}else this.Ab=null;return this};d.bI=function(){return null!=this.Ab};d.$h=function(a,b){this.Fi();this.xd=b?dk(a,!0):a;return this};d.aI=function(){return!!this.xd};d.i0=function(){return""!==this.qg.toString()};
d.fu=function(a,b){this.Fi();a instanceof Xj?(this.qg=a,this.qg.YA(this.Td)):(b||(a=Yj(a,ek)),this.qg=new Xj(a,null,this.Td));return this};d.SW=function(){return this.qg.toString()};d.rW=function(){return this.qg.Gca()};d.au=function(a,b){this.Fi();this.Ii=b?dk(a):a;return this};d.f0=function(){return!!this.Ii};d.Fi=function(){if(this.S0)throw Error("Tried to modify a read-only Uri");};d.YA=function(a){this.Td=a;this.qg&&this.qg.YA(a);return this};
var dk=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Yj=function(a,b,c){return r(a)?(a=encodeURI(a).replace(b,fk),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},fk=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},Zj=/[#\/\?@]/g,bk=/[\#\?:]/g,ak=/[\#\?]/g,ek=/[\#\?@]/g,ck=/#/g,Xj=function(a,b,c){this.Va=this.tb=null;this.gh=a||null;this.Td=!!c};
Xj.prototype.Zf=function(){if(!this.tb&&(this.tb=new C,this.Va=0,this.gh)){var a=this;Td(this.gh,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)})}};var gk=function(a,b,c){b=Gc(a);if("undefined"==typeof b)throw Error("Keys are undefined");c=new Xj(null,null,c);a=Fc(a);for(var e=0;e<b.length;e++){var f=b[e],g=a[e];ua(g)?c.LN(f,g):c.add(f,g)}return c};d=Xj.prototype;d.S=function(){this.Zf();return this.Va};
d.add=function(a,b){this.Zf();this.xl();a=this.jl(a);var c=this.tb.get(a);c||this.tb.set(a,c=[]);c.push(b);this.Va+=1;return this};d.remove=function(a){this.Zf();a=this.jl(a);return this.tb.ya(a)?(this.xl(),this.Va-=this.tb.get(a).length,this.tb.remove(a)):!1};d.clear=function(){this.xl();this.tb=null;this.Va=0};d.$b=function(){this.Zf();return 0==this.Va};d.ya=function(a){this.Zf();a=this.jl(a);return this.tb.ya(a)};d.Ek=function(a){var b=this.F();return ib(b,a)};
d.kb=function(){this.Zf();for(var a=this.tb.F(),b=this.tb.kb(),c=[],e=0;e<b.length;e++)for(var f=a[e],g=0;g<f.length;g++)c.push(b[e]);return c};d.F=function(a){this.Zf();var b=[];if(r(a))this.ya(a)&&(b=qb(b,this.tb.get(this.jl(a))));else{a=this.tb.F();for(var c=0;c<a.length;c++)b=qb(b,a[c])}return b};d.set=function(a,b){this.Zf();this.xl();a=this.jl(a);this.ya(a)&&(this.Va-=this.tb.get(a).length);this.tb.set(a,[b]);this.Va+=1;return this};
d.get=function(a,b){a=a?this.F(a):[];return 0<a.length?String(a[0]):b};d.LN=function(a,b){this.remove(a);0<b.length&&(this.xl(),this.tb.set(this.jl(a),z(b)),this.Va+=b.length)};d.toString=function(){if(this.gh)return this.gh;if(!this.tb)return"";for(var a=[],b=this.tb.kb(),c=0;c<b.length;c++)for(var e=b[c],f=encodeURIComponent(String(e)),e=this.F(e),g=0;g<e.length;g++){var k=f;""!==e[g]&&(k+="="+encodeURIComponent(String(e[g])));a.push(k)}return this.gh=a.join("&")};d.Gca=function(){return dk(this.toString())};
d.xl=function(){this.gh=null};d.clone=function(){var a=new Xj;a.gh=this.gh;this.tb&&(a.tb=this.tb.clone(),a.Va=this.Va);return a};d.jl=function(a){a=String(a);this.Td&&(a=a.toLowerCase());return a};d.YA=function(a){a&&!this.Td&&(this.Zf(),this.xl(),this.tb.forEach(function(a,c){var b=c.toLowerCase();c!=b&&(this.remove(c),this.LN(b,a))},this));this.Td=a};d.extend=function(a){for(var b=0;b<arguments.length;b++)Jc(arguments[b],function(a,b){this.add(b,a)},this)};var hk=function(a,b,c,e,f,g,k,p){this.Cv=a;this.Jd=b||null;this.Gq=c||null;this.jr=e||null;this.Os=l(f)?f:null;this.Dv=g||null;this.BE=k||null;this.hy=p||!1},ik=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},kk=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:cb(y(a,function(a){a=ik(a,"__castAppId__");if(!a)return null;a=a.match(jk);if(!a||0==a.length)return null;var b=[];3==a.length&&a[2]&&(b=a[2].split(","));return{appId:a[1],capabilities:b}}),function(a){return null!=
a})},lk=function(a){return ik(a,"__castClientId__")};d=hk.prototype;d.In=function(){return y(this.Cv,function(a){return a.appId})};d.HF=function(){return this.Dv};d.xc=function(){return this.Jd};d.ex=function(){return this.Gq?this.Gq:chrome.cast.Hf.TAB_AND_ORIGIN_SCOPED};d.sW=function(){return this.jr?this.jr:chrome.cast.mq.CREATE_SESSION};d.BX=function(){return null==this.Os?chrome.cast.timeout.requestSession:this.Os};
d.toString=function(){var a=new Wj;a.iu("https");a.om("google.com");a.$h("/cast");var b=[];x(this.Cv,function(a){var c="__castAppId__="+a.appId;a.capabilities&&0<a.capabilities.length&&(c=c+"("+a.capabilities.join(","),c+=")");b.push(c)});this.Jd&&b.push("__castClientId__="+this.Jd);this.Gq&&b.push("__castAutoJoinPolicy__="+this.Gq);this.jr&&b.push("__castDefaultActionPolicy__="+this.jr);null!=this.Os&&b.push("__castLaunchTimeout__="+this.Os);this.Dv&&b.push("__dialAppName__="+this.Dv);this.BE&&b.push("__dialPostData__="+
this.BE);this.hy&&b.push("__castInvisibleSender__=true");a.au(b.join("/"));return a.toString()};d.X0=function(a){var b=this.In(),c=mk(a);return db(b,function(a){return ib(c,a)})};
var nk=function(a){a=new Wj(a);if("https"!=a.xg||"google.com"!=a.cg()||"/cast"!=a.xd)return null;var b=a.Ii;a=kk(b);if(!a||0==a.length)return null;var c=lk(b),e=ik(b,"__castAutoJoinPolicy__"),f=ik(b,"__castDefaultActionPolicy__"),g;g=ik(b,"__castLaunchTimeout__");null==g?g=null:(g=Number(g),g=!isNaN(g)&&0<=g?g:null);var k=ik(b,"__dialAppName__"),p=ik(b,"__dialPostData__"),b=ik(b,"__castInvisibleSender__");return new hk(a,c,e,f,g,k,p,null===b?null:"true"==b)},mk=function(a){return(a=nk(a))?a.In():
null},ok=function(a){return(a=nk(a))?a.xc():null},jk=/(^\w+)(?:\(([\w,\ ]*)\))?$/;var pk=function(a,b,c,e,f,g){this.vg=a;this.da=b;this.Wb=c;this.oa=e;this.Zc=f;this.Nh=g;this.nd=new Tj(g,c);this.e6=new Gj(this.vg);this.k8=new Rj(this.vg)};d=pk.prototype;d.init=function(){this.Wb.init();this.nd.listen("v2_message",this.b4.bind(this));this.nd.listen("app_message",this.u2.bind(this));this.nd.listen("leave_session",this.b3.bind(this))};d.Be=function(a,b){this.nd.p2(b)};
d.CA=function(a,b,c,e){var f=this;a=this.oa.VF(a);c&&0==a.length&&a.push(c.clientId);a.slice().forEach(function(a){a!=e&&f.UL(a,b)})};d.UL=function(a,b){b.clientId=a;this.nd.zg(a,b)};d.XL=function(a,b,c){b={receiver:Ij(b),action:c};this.UL(a,new Sj("receiver_action",b))};
d.b4=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.oa.Mx(c);if(e)if(c=this.oa.sH(c))if(c=this.da.Z(c))switch(b.type){case "STOP":this.r2(a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":this.o2(a,c,e);break;case "SET_VOLUME":this.q2(a,c);break;default:F(qk,"Unknown request")}else this.lm(a,
chrome.cast.If.INVALID_PARAMETER,"No receiver");else this.lm(a,chrome.cast.If.INVALID_PARAMETER,"No sink ID");else this.lm(a,chrome.cast.If.INVALID_PARAMETER,"Unknown session ID")}else this.lm(a,chrome.cast.If.INVALID_PARAMETER,"No session ID")};d.lm=function(a,b,c){b=new chrome.cast.Error(b,c);this.BA(a,b)};d.BA=function(a,b){this.nd.zg(a.clientId,new Sj("error",b,a.sequenceNumber))};
d.r2=function(a,b){var c=this,e=a.message;Gg("MediaRouter.Cast.Session.End");var f=e.sessionId,g=this.oa.ve(f);g&&(g.Cs=!0);this.vg.sendRequest(e,b,ri,a.timeoutMillis,a.clientId).then(function(){c.zj(f,a)},function(){c.zj(f,a)})};d.o2=function(a,b,c){var e=this,f=a.message,g=f.type;g in rj&&(f.type=rj[g]);this.vg.sendRequest(f,b,si,a.timeoutMillis,a.clientId,c.transportId).then(function(b){e.PK(c,b);e.nd.zg(a.clientId,new Sj("v2_message",b,a.sequenceNumber))},function(b){e.BA(a,b)})};
d.q2=function(a,b){var c=this,e=a.message;delete e.sessionId;this.vg.sendRequest(e,b,ri,a.timeoutMillis,a.clientId).then(function(){c.nd.zg(a.clientId,new Sj("v2_message",null,a.sequenceNumber))},function(b){c.BA(a,b)})};
d.u2=function(a){var b=this,c=a.message,e=c.sessionId;if(e){var f=this.oa.sH(e);f?(f=this.da.Z(f))?(e=this.oa.Mx(e),gb(e.namespaces,function(a){return a.name==c.namespaceName})?this.Zc.St(f,c.namespaceName,c.message,a.clientId,e.transportId).then(function(){b.nd.zg(a.clientId,new Sj("app_message",null,a.sequenceNumber))},function(){b.lm(a,chrome.cast.If.CHANNEL_ERROR,"Channel to receiver not available")}):this.lm(a,chrome.cast.If.INVALID_PARAMETER,"Invalid namespace")):F(qk,"No receiver from sinkId"):
F(qk,"No sinkId from sessionId")}else F(qk,"No sessionId")};d.M6=function(a){var b=this;a.be.slice().forEach(function(a){b.Nh.lZ(a)||b.Nh.em(a,!0)})};d.it=function(a){(a=this.oa.bo(a))&&a.session&&this.zj(a.session.sessionId)};
d.b3=function(a){var b=this;G(qk,"Leave session");var c=a.message,e=this.oa.ve(c);if(e){var f=a.clientId,g=this.Wb.Rd(f);if(g){var k=[],p=[],q=g.tabId,B=g.origin,O=g.autoJoinPolicy;e.Tf.forEach(function(a){var c=b.Wb.Rd(a);O==chrome.cast.Hf.TAB_AND_ORIGIN_SCOPED&&q==c.tabId&&B==c.origin||O==chrome.cast.Hf.ORIGIN_SCOPED&&B==c.origin?(c.vI=!0,k.push(a)):p.push(a)});this.nd.zg(f,new Sj("leave_session",null,a.sequenceNumber));k.forEach(function(a){b.nd.zg(a,new Sj("disconnect_session",c))});e.Tf=p}else F(qk,
"No client record")}else F(qk,"No session")};d.SK=function(a,b){Oj(a,si)&&this.vg.sendRequest(new sj,b,si,void 0,void 0,a.transportId).catch(pa)};d.TK=function(a,b){var c=this,e=a.getId();G(qk,"Query status for "+e);this.e6.bca(a).then(function(f){c.iK(e,f);b&&(f=c.oa.bs(e))&&c.SK(f,a)},pa)};d.J3=function(a,b){ui.hasOwnProperty(b.namespace_)?this.G3(a,b):this.F3(a,b)};
d.c1=function(a){if("*"==a.destinationId)return!0;a=a.destinationId;if(a==this.Zc.mH()||null!=this.Wb.Rd(a))return!0;G(qk,"Invalid destination "+a);return!1};
d.G3=function(a,b){var c=this;H(qk,"Cast message: "+JSON.stringify(b));if(this.c1(b))if(b.namespace_==ti)(a=this.oa.bo(a))&&a.be.forEach(function(a){c.Nh.aU(a,b)});else{var e=JSON.parse(b.data),f=this.F_(e),f=f?f.sourceId:void 0;switch(e.type){case "RECEIVER_STATUS":this.iK(a,e);break;case "MEDIA_STATUS":this.I3(a,b,f)}}else this.Zc.VD(a,b.destinationId,b.sourceId,!0)};
d.F_=function(a){var b=this.vg.lp(a.requestId);if(!b)return null;var c=b.Cb;switch(a.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete a.requestId;c.reject(new chrome.cast.Error(chrome.cast.If.SESSION_ERROR,a.reason||a.type,a));break;default:c.resolve(a)}return b};
d.F3=function(a,b){var c=this;H(qk,"App message: "+JSON.stringify(b));if(a=this.oa.bs(a)){var e;e="*"==b.destinationId?this.oa.VF(a.sessionId):[b.destinationId];var f=new Fj(a.sessionId,b.namespace_,b.data);e.forEach(function(a){c.nd.zg(a,new Sj("app_message",f))})}else F(qk,"No session for incoming app message")};
var rk=function(a,b){a.forEach(function(a){a.sessionId=b;var c=a.supportedMediaCommands,f=[];c&1&&f.push(chrome.cast.media.Vm.PAUSE);c&2&&f.push(chrome.cast.media.Vm.SEEK);c&4&&f.push(chrome.cast.media.Vm.STREAM_VOLUME);c&8&&f.push(chrome.cast.media.Vm.STREAM_MUTE);a.supportedMediaCommands=f});return a};d=pk.prototype;d.PK=function(a,b){a=a.sessionId;b.sessionId=a;this.oa.Iaa(a,rk(b.status,a))};d.n3=function(a,b,c){this.nd.zg(c,new Sj("new_session",a));this.SK(a,b)};
d.Gt=function(a){if(a=this.oa.bs(a)){a=a.sessionId;var b=this.oa.ve(a);b&&b.Cs||this.zj(a)}};d.zj=function(a,b){this.CA(a,new Sj("remove_session",a,b?b.sequenceNumber:void 0),b);(b=this.oa.ve(a))&&this.M6(b);this.oa.zj(a)};
d.iK=function(a,b){H(qk,"Receiver status for "+a);var c=b.status;if(c)if(b=this.da.Z(a)){var c=Kj(b,c),e=this.oa.bo(a);e?c?c.sessionId==e.session.sessionId?this.R_(e,c):(this.SH(a),this.Nh.Se(null,b,null,c)):this.SH(a):c&&this.Nh.Se(null,b,null,c)}else Gg("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),F(qk,"Got message from receiver "+a+", but sink is no longer available.")};
d.R_=function(a,b){var c=a.session;Mj(c,b)&&(H(qk,"Updating session "+b.sessionId),c.statusText=b.statusText,c.namespaces=b.namespaces,c.receiver.volume=b.receiver.volume,this.Nh.kda(a),this.CA(c.sessionId,new Sj("update_session",c),void 0))};d.SH=function(a){this.Gt(a);Yi(1)};d.I3=function(a,b,c){if(a=this.oa.bs(a))if(b=JSON.parse(b.data))this.PK(a,b),this.CA(b.sessionId,new Sj("v2_message",b),void 0,c)};
d.RS=function(a,b){var c=Lj(b.Gd);return(b=gb(a.Cv,function(a){return eb(a.capabilities,function(a){return ib(c,a)})}))?b.appId:a.In()[0]};d.Ly=function(a,b){var c=nk(a);if(!c)return Promise.reject(Error("Invalid source "+a));a=this.RS(c,b);var c=c.BX(),e=new yg("MediaRouter.Cast.Session.Launch");return this.k8.Ly(new chrome.cast.zC(a,void 0,c),b).then(function(a){e.end("Success");return a},function(a){e.end("Failure");throw a;})};var qk=D("mr.cast.ApiHandler");var sk=D("mr.RuntimeErrorUtils"),tk=function(){chrome.runtime.lastError&&sk.mF(chrome.runtime.lastError.message||"unknown runtime error")};var uk=function(){this.Jz=new C;this.Kz=new C;this.Vo=new C};d=uk.prototype;d.Bk=function(a,b){var c=this,e=a.getId(),f=a.va+":"+a.Kb(),g=this.Jz.get(e);if(g){if(this.Vo.get(e)==f)return H(vk,"Using pending creation to "+e),g;G(vk,"Device "+e+" IP changed from "+this.Vo.get(a.getId())+" to "+f);this.SQ(a)}a=this.fU(a,b).then(function(a){c.iw(e);Zi(1);return a},function(a){f==c.Vo.get(e)&&c.iw(e);Zi(0);return Promise.reject(a)});this.Jz.set(e,a);this.Vo.set(e,f);return a};
d.SQ=function(a){a=a.getId();H(vk,"Aborting connection to device "+a);var b=this.Kz.get(a);b&&b.abort();this.iw(a)};d.iw=function(a){this.Jz.remove(a);this.Kz.remove(a);this.Vo.remove(a)};d.fU=function(a,b){if(1===b)return this.tK(a);var c=t(b)&&1<b?b:3;b=new jf(this.tK.bind(this,a),1E3,c);this.Kz.set(a.getId(),b);return b.Xt(1.5).start().then(null,function(b){G(vk,"Failed to create channel to "+a.getId()+" after "+c+" attempts.");return Promise.reject(b)})};
d.tK=function(a){var b=wk++;G(vk,"Connecting to (id "+b+") "+a.getId());var c=new yg("MediaRouter.Cast.Mdns.Channel.Open");return this.d4(a).then(function(a){G(vk,"Channel opened (id "+b+"): "+JSON.stringify(a));c.end("Success");return a},function(a){G(vk,"Channel did not open (id "+b+").");c.end("Failure");return Promise.reject(a)})};
d.d4=function(a){a={ipAddress:a.va,port:a.Kb(),auth:"ssl_verified",timeout:1E4,livenessTimeout:1E4,pingInterval:5E3,capabilities:0};G(vk,"Opening channel to "+JSON.stringify(a));var b=new Vd;chrome.cast.channel.open(a,function(a){tk();"open"==a.readyState?b.resolve(a):(chrome.cast.channel.close(a,function(){chrome.runtime.lastError||H(vk,"Channel close success")}),b.reject(Error(a.errorState)))});return b.promise};var vk=D("mr.cast.ChannelFactory"),wk=0;var xk=function(a,b,c,e){return{namespace_:a,data:r(b)?b:JSON.stringify(b),sourceId:c,destinationId:e}};var yk=function(a){this.type="CLOSE";this.reasonCode=a};var Ak=function(a){this.type="CONNECT";this.origin={};this.userAgent=Vb;var b=this.userAgent.indexOf("(")+1,b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:hi,platform:zk(),systemVersion:b,connectionType:1};this.connType=a?0:2},zk=function(){switch(Mg()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var Bk=function(){this.Kg=new C};d=Bk.prototype;d.init=function(){Ci(this)};d.yz=function(a,b,c,e){if(!this.dI(a,b,c)){var f=xk(qi,new Ak(e),b,c);chrome.cast.channel.send(a,f,tk);this.Kg.set(this.uy(a,b,c),e)}};d.bT=function(a,b,c,e){this.dI(a,b,c)&&(this.pL(a,b,c),b=xk(qi,new yk(e?5:0),b,c),chrome.cast.channel.send(a,b,tk))};d.pL=function(a,b,c){this.Kg.remove(this.uy(a,b,c))};d.O6=function(a){var b=this;this.Kg.kb().forEach(function(c){c.split("#")[0]==a.channelId.toString()&&b.Kg.remove(c)})};
d.g2=function(a,b){var c=this;this.Kg.forEach(function(e,f){var g=f.split("#");g[0]==a.channelId.toString()&&(c.yz(b,g[1],g[2],e),c.Kg.remove(f))})};d.zU=function(a,b,c){this.yz(a,b,c,0==c.indexOf("receiver-0"))};d.dI=function(a,b,c){return this.Kg.ya(this.uy(a,b,c))};d.uy=function(a,b,c){return[a.channelId,b,c].join("#")};d.la=function(){return"cast.VirtualConnectionManager"};d.getData=function(){var a=this.Kg.b();return[new Ck(a)]};
d.ib=function(){var a=zi(this);if(a)for(var b in a.eP)this.Kg.set(b,a.eP[b])};ra(Bk);var Ck=function(a){this.eP=a};var Dk=function(a,b){this.fw=b;this.Bd=a;this.Th=new C;this.Yg=new C;this.ck=Bk.N();this.GS=new uk;this.Z=null};d=Dk.prototype;d.init=function(){chrome.cast.channel.onMessage.addListener(this.B2.bind(this));chrome.cast.channel.onError.addListener(this.z2.bind(this));this.ck.init();Ci(this)};d.mH=function(){return this.Bd};d.St=function(a,b,c,e,f){var g=this,k=e||this.Bd,p=f||"receiver-0";return this.Bk(a).then(function(a){return g.c8(a,b,c,k,p)})};
d.e4=function(a,b,c,e){var f=this;return this.Bk(a).then(function(a){return f.ck.yz(a,b,c,e)})};d.VD=function(a,b,c,e){(a=this.Th.get(a))&&this.ck.bT(a,b,c,e)};
d.B2=function(a,b){var c=this.Yg.get(a.channelId);if(c){var e=this.Z(c);if(e){if(ui.hasOwnProperty(b.namespace_)){c=JSON.parse(b.data);if("CLOSE"==c.type){this.ck.pL(a,b.destinationId,b.sourceId);return}G(Ek,"Got message "+(c.type||c.responseType)+" from "+e.getId())}else G(Ek,"Got message in "+b.namespace_+" from "+e.getId());this.fw.A2(e,b)}else F(Ek,"Receiver "+c+" not found.")}else F(Ek,"This message is from unknown receiver.")};
d.WD=function(a){chrome.cast.channel.close(a,function(){chrome.runtime.lastError||H(Ek,"Channel close success")});var b=this.Yg.get(a.channelId);b&&(this.Yg.remove(a.channelId),this.Th.remove(b))};d.z2=function(a,b){F(Ek,"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):""));b&&this.bR(b.errorState,b);this.UD(a)};
d.bR=function(a,b){switch(a){case "unknown":a=0;break;case "authentication_error":a=1;break;case "connect_error":a=2;break;default:return}if(b){if(-8192<=b.nssErrorCode&&-7192>b.nssErrorCode||2==b.challengeReplyErrorType||8==b.challengeReplyErrorType||9==b.challengeReplyErrorType||11==b.challengeReplyErrorType||-200>=b.netReturnValue&&-300<b.netReturnValue||30==b.eventType||31==b.eventType||32==b.eventType)a=3;if(26==b.eventType||-201==b.netReturnValue||-8181==b.nssErrorCode||-8162==b.nssErrorCode||
-8161==b.nssErrorCode)a=4;-138==b.netReturnValue&&(a=5);if(-8182==b.nssErrorCode||10==b.eventType||12==b.eventType)a=1}F(Ek,"Channel error code: "+a);Hg("MediaRouter.Cast.Channel.Error",a,Wi)};d.UD=function(a){var b=this,c=this.Yg.get(a.channelId);this.WD(a);if(c){var e=this.Z(c);e&&this.Bk(e).then(function(c){G(Ek,"Re-connected to receiver: "+e.getId());b.ck.g2(a,c);b.fw.C2(e)},function(){G(Ek,"Failed to re-connect to receiver: "+e.getId());b.ck.O6(a);b.fw.hz(e,a.errorState)})}};
d.Bk=function(a){var b=this,c=a.getId(),e=this.Th.get(c);return e&&"open"==e.readyState?Promise.resolve(e):this.GS.Bk(a).then(function(a){if(b.Yg.ya(a.channelId))return a;b.Th.get(c)&&(F(Ek,"Duplicate channel to a receiver "+c),b.WD(b.Th.get(c)));G(Ek,"Connected to: "+c);b.Th.set(c,a);b.Yg.set(a.channelId,c);return a},null)};
d.c8=function(a,b,c,e,f){var g=this;this.ck.zU(a,e,f);Nj(c);var k=xk(b,c,e,f);G(Ek,"Channel is sending message");H(Ek,"....message was: "+JSON.stringify(k));return new Promise(function(b,c){tk();chrome.cast.channel.send(a,k,function(a){a.errorState?(c(Error("Failed to send message")),g.UD(a)):b(!0)})})};d.la=function(){return"cast.ChannelService"};d.getData=function(){return[new Fk(this.Th.b(),this.Yg.b())]};d.ib=function(){var a=zi(this);a&&(this.Th.addAll(a.d6),this.Yg.addAll(a.HS))};
var Ek=D("mr.cast.ChannelService"),Fk=function(a,b){this.d6=a;this.HS=b};var Gk=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var Hk=function(a,b){this.vg=a;this.da=b;this.ic=new Mc;this.Cc=new C};d=Hk.prototype;d.init=function(){Ci(this)};d.eA=function(a){var b=this.Cc.get(a);b?b.hA++:this.Cc.set(a,{hA:1});this.J7()};d.PB=function(a){var b=this.Cc.get(a);b&&(b.hA--,0<b.hA||(zc(this.da.ho(),function(b){switch(b.se(a)){case "available":b.yp(a,"available_rescan");break;case "unavailable":b.yp(a,"unavailable_rescan")}}),this.Cc.remove(a)))};
d.J7=function(){G(this.a,"Scanning sinks for app availability");zc(this.da.ho(),this.sp,this)};
d.sp=function(a){var b=this;zc(this.Cc.AG(),function(c){var e;a:{switch(a.se(c)){case "unknown":case "available_rescan":case "unavailable_rescan":e=!0;break a}e=!1}if(e){var f=a.getId()+":"+c;b.ic.contains(f)||(b.ic.add(f),e=function(){b.ic.remove(f)},(new jf(b.LS.bind(b,a,c),5500,3)).Xt(2).start().then(b.JO.bind(b,a,c),function(){E(b.a,"Failed to get app availability response for "+a.getId()+", appId "+c+" after 3 attempts.");b.JO(a,c,"unknown")}).then(e,e))}})};
d.JO=function(a,b,c){c!=a.se(b)&&(G(this.a,b+" on "+a.getId()+" is "+c),a.yp(b,c),this.da.wd(a))};
d.LS=function(a,b){var c=this,e=new Gk;e.appId=[b];var f=new yg("MediaRouter.Cast.App.Availability");return this.vg.sendRequest(e,a,ri,5E3).then(function(a){f.end("Success");H(c.a,"App availability response "+JSON.stringify(a));for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(e){f.end("Failure");E(c.a,"checkAppAvailability_ failed for "+a.getId()+", appId "+b);throw e;})};
d.la=function(){return"cast.AppDiscoveryService"};d.getData=function(){return[new Ik(this.Cc.b())]};d.ib=function(){var a=zi(this);a&&this.Cc.addAll(a.s6)};d.a=D("mr.cast.AppDiscoveryService");var Ik=function(a){this.s6=a};var Jk=function(a,b,c){this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,Jk);else if(b=Error().stack)this.stack=b;this.errorCode=a};ja(Jk,Error);var Kk=function(a,b){this.sinks=a;this.origins=b||null},Lk=new Kk([]);var Mk=function(){},Nk=function(a){if(!Ea(a,"urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;b=Wa(b,"/",2);if(3!=b.length)return null;var c=Wa(b[1],"-",1);if(2!=c.length)return null;var e=new Mk;e.qra=a;e.IK=b[0];e.xqa=c[0];e.Pra=c[1];e.ai=b[2];return e};Mk.prototype.T=function(){return this.ai};var Ok=function(a,b,c,e,f,g){this.id=a;this.sinkId=b;this.mediaSource=c;this.isLocal=e;this.description=f;this.iconUrl=g;this.allowStop=!0;this.customControllerPath=null;this.forDisplay=!0;this.offTheRecord=!1;this.Ik=e},Pk=function(a,b,c,e,f,g,k){return new Ok("urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+e,c,e,f,g,k)};var Qk=function(a,b,c,e){return Pk(c,"cast",b.getId(),a,e,"",null)};var Rk=function(a,b,c,e,f,g){this.routeId=a;this.clientId=b;this.autoJoinPolicy=e;this.origin=f;this.tabId=g;this.vI=this.ly=!1},Sk=function(){this.Bb=[]};d=Sk.prototype;d.init=function(){Ci(this)};d.S=function(){return this.Bb.length};d.Rd=function(a){return gb(this.Bb,function(b){return b.clientId==a})};d.qh=function(a){return gb(this.Bb,function(b){return b.routeId==a})};d.tv=function(a,b,c,e,f,g){a=new Rk(a,b,c,e,f,g);this.Bb.push(a);return a};
d.lA=function(a){this.Bb=cb(this.Bb,function(b){return b.clientId!=a})};d.la=function(){return"cast.ClientRecords"};d.getData=function(){return[new Tk(this.Bb)]};d.ib=function(){var a=zi(this);a&&(this.Bb=a.Ft)};var Tk=function(a){this.Ft=a};var Uk=function(a){this.da=a},Vk=function(a){var b=[];a.forEach(function(a){var c="Receiver-"+a.replace(/\./g,"_"),f=Mi.N().uk||8009;b.push({serviceName:c+"._googlecast._tcp.local",serviceHostPort:c+":"+f,ipAddress:a,serviceData:["id=mdns:"+c,"ve=02","ca=5","st=1","fn="+c,"md=Chromecast"]})});return b};Uk.prototype.init=function(){var a=Vk(Mi.N().Ww);this.da.eL(a)};var Wk=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var Xk=function(a,b){this.Tf=[];this.be=[];this.sinkId=a;this.session=b;this.Ps=this.Ao=null;this.offTheRecord=this.Cs=!1};d=Xk.prototype;d.tv=function(a){if(ib(this.Tf,a))return!1;this.Tf.push(a);return!0};d.lA=function(a){return nb(this.Tf,a)};d.Se=function(a){if(ib(this.be,a))return!1;this.be.push(a);return!0};d.em=function(a){return nb(this.be,a)};d.g_=function(a,b){Jj(a)?(this.Ps=a,this.Ao=b):Jj(this.session)&&(this.Ps=this.session,this.Ao=this.sinkId,this.session=a,this.sinkId=b);return this};
var Yk=function(){this.a=D("mr.cast.SessionRecords");this.Bb=[]};d=Yk.prototype;d.init=function(){Ci(this)};d.tq=function(a,b){G(this.a,"Adding new session: "+b+", "+a.sessionId);var c=this.ve(a.sessionId);if(c)return c.g_(a,b);a=new Xk(b,a);this.Bb.push(a);return a};d.zj=function(a){G(this.a,"Removing session "+a);this.Bb=cb(this.Bb,function(b){return b.session.sessionId!=a})};d.VF=function(a){return(a=this.ve(a))?a.Tf:[]};d.bs=function(a){return(a=this.bo(a))?a.session:null};
d.Rd=function(a){return gb(this.Bb,function(b){return ib(b.Tf,a)})};d.qh=function(a){return gb(this.Bb,function(b){return ib(b.be,a)})};d.RY=function(a){return gb(this.Bb,function(b){return null!=gb(b.be,function(b){return Nk(b).IK==a})})};d.bo=function(a){return gb(this.Bb,function(b){return b.sinkId==a||b.Ao==a})};d.ve=function(a){return gb(this.Bb,function(b){return b.session.sessionId==a})};d.sH=function(a){return(a=this.ve(a))?a.sinkId:null};d.Mx=function(a){return(a=this.ve(a))?a.session:null};
d.Iaa=function(a,b){var c=this.Mx(a);c&&(a=cb(b,function(a){return a.playerState!=chrome.cast.media.nq.IDLE}),a.forEach(function(a){if(!a.media){var b=gb(c.media,function(b){return b.mediaSessionId==a.mediaSessionId});b&&(a.media=b.media)}}),c.media=a)};d.E5=function(a){for(var b=0;b<this.Bb.length;b++)this.Bb[b].lA(a)};d.la=function(){return"cast.SessionRecords"};d.getData=function(){return[new Zk(this.Bb)]};
d.ib=function(){var a=zi(this);if(a)for(var b=0;b<a.Ft.length;b++){var c=a.Ft[b],e=new Xk(c.sinkId,c.session);e.Tf=c.Tf;e.be=c.be;e.Cs=c.Cs;e.Ps=c.Ps;e.Ao=c.Ao;this.Bb.push(e)}};var Zk=function(a){this.Ft=a};var $k=function(a){this.Bd="sender-"+Sa();this.eb=new C;this.cj=null;Ci(this);this.w=a;this.Wb=new Sk;this.oa=new Yk;this.Zc=new Dk(this.Bd,this);this.da=new mj(this.Zc,this);this.MT=new Uk(this.da);this.Hd=new yj(this.Zc,this.Bd);this.od=new Hk(this.Hd,this.da);this.Fd=new pk(this.Hd,this.da,this.Wb,this.oa,this.Zc,this);this.FD=new Ej(this.da,this.Hd);this.Wba=this.da.start.bind(this.da)};d=$k.prototype;d.getName=function(){return"cast"};
d.Ud=function(){this.Hd.init();this.oa.init();this.Fd.init();this.Zc.init();this.da.init();this.MT.init();this.od.init();this.w.fA(this.Wba)};d.ig=function(){return this.eb.F()};d.Jn=function(a){var b=this,c=new Mc;this.Ir(a).forEach(function(a){b.da.xZ(a).map(function(a){return a.mh()}).forEach(function(a){c.add(a)})});return new Kk(c.F(),-1!=a.indexOf("0F5096E8")?Rg:null)};d.Tj=function(a){var b=this;this.Ir(a).forEach(function(a){b.od.eA(a)});this.w.oy()&&this.da.start()};
d.Wj=function(a){var b=this;this.Ir(a).forEach(function(a){b.od.PB(a)})};d.Sj=function(){};d.Vj=function(){};d.Z=function(a){return(a=this.da.Z(a))?a.mh():null};d.R7=function(a){var b=new sg(Wk,"warning","dismiss");b.routeId=a;this.w.dg().send(b)};d.QH=function(a,b){E(this.a,"Error launching.",b);this.R7(a.id);this.w.onPresentationConnectionClosed(a.id,"error","Launch error");this.em(a.id,!1)};
d.nr=function(a,b,c,e,f,g,k){var p=this;Mi.N().xj=new Li(b.Bc,b.va);var q=Qk(a,b,c,!0);q.forDisplay=!1;q.offTheRecord=e;this.eb.set(q.id,q);this.w.Ul(this,q);this.w.Vh(this.la(),!0);(e=nk(a))&&e.xc()&&this.JC(e,q.id,g,k);Pg(a)||Qg(a)?(q.ze={tabId:k,sessionId:"",RN:b.va||"",SN:b.Bc||""},this.w.Np(this,q,c,function(e){return wg(p.UI(a,b,c,f,g,k,e))}).promise.then(function(){p.WM(q)},function(a){p.QH(q,a)})):this.UI(a,b,c,f,g,k,q).then(null,function(a){p.QH(q,a)});return Promise.resolve(q)};
d.UI=function(a,b,c,e,f,g,k){var p=this;return this.Fd.Ly(this.Pz(a,b,e),b).then(function(e){p.Se(a,b,c,e,f,g,k);return k})};d.Ye=function(a,b,c,e,f,g,k){var p=this,q=this.da.Z(b);if(!q)return vg(Error("No sink with ID "+b));var B=lk(a);if(B){setTimeout(function(){p.Fd.XL(B,q,chrome.cast.Wm.CAST)},0);var O=function(){return p.nr(a,q,c,e,f,g,k)},S=this.Wb.Rd(B);if(S)return wg(this.hd(S.routeId).then(O,O));if(g&&k&&(b=this.kE(a,g,k,e,f,b)))return b}return wg(this.nr(a,q,c,e,f,g,k))};
d.bU=function(a,b){this.w.Be(this,a,b)};d.aU=function(a,b){var c=this.eb.get(a);c&&c.Ik&&this.w.gt(this,a,b)};
d.em=function(a,b){G(this.a,"Remove route "+a);var c=this.Wb.qh(a);if(c){b=b||c.vI;var e=c.clientId;G(this.a,"Remove client "+e);this.oa.E5(e);this.Wb.lA(e)}if(e=this.oa.qh(a))e.em(a),this.fJ(e.be);var f=this.eb.get(a);f&&(f.Ik&&e&&(this.Zc.VD(f.sinkId,c?c.clientId:this.Bd,e.session.transportId,b),f.forDisplay&&c&&(this.cj={xk:c,bM:e})),this.eb.remove(a),this.w.oj(this,f),this.ig().some(function(a){return a.isLocal})||this.w.Vh(this.la(),!1))};
d.kda=function(a){var b=this;a.be.forEach(function(c){if(c=b.eb.get(c)){var e=a.session;c.ze&&c.forDisplay?b.WM(c):(c.description=e.statusText||e.displayName,b.w.Jh(b,c))}})};d.dda=function(a){var b=this;db(a,function(a){a=b.eb.get(a,null);if(!a||!a.mediaSource)return!1;var c=nk(a.mediaSource),c=c?c.hy:!1;return a.isLocal&&!c})&&x(a,function(a){if(a=b.eb.get(a,null))a.isLocal=!0})};
d.fJ=function(a){var b=this,c=[],e=[],f=null;a.forEach(function(a){if(a=b.eb.get(a)){a.forDisplay=!1;var g=nk(a.mediaSource);g&&gb(g.In(),Qj)||(a.Ik?(g=g?g.ex():null,f||g==chrome.cast.Hf.CUSTOM_CONTROLLER_SCOPED||(c.push(a),f=a.sinkId)):f&&f!=a.sinkId?c.push(a):e.push(a))}});x(0<c.length?c:e,function(a){a.forDisplay=!0})};d.JC=function(a,b,c,e){var f=a.xc();f&&!this.Wb.Rd(f)&&(G(this.a,"Add client "+f),this.Wb.tv(b,f,a.In(),a.ex(),c||null,l(e)?e:null))};
d.WM=function(a){var b=this.oa.qh(a.id);b&&(b=b.session,b.statusText=a.description||b.statusText)};
d.Se=function(a,b,c,e,f,g,k){var p=null!=a,q;null==a?(q=new hk([{appId:e.appId,capabilities:e.capabilities}]),a=q.toString()):q=nk(a);var B=k;if(B){if(!this.eb.get(B.id))return F(this.a,"Route "+B.id+" not added"),B}else B=Qk(a,b,c||e.sessionId,p),this.eb.set(B.id,B);c=B.id;G(this.a,"Add route "+c);a=null;q&&(a=q.xc(),this.JC(q,c,f,g));(f=this.oa.bo(b.getId()))||(f=this.oa.tq(e,b.getId()));f.Se(c);B.Ik&&this.Zc.e4(b,a||this.Bd,e.transportId,!(q&&q.hy));f.offTheRecord=B.offTheRecord;q=f.be;this.dda(q);
this.fJ(q);q=B;g=e.sessionId;c=e.appId;("0F5096E8"==c||"85CDB22F"==c)&&g&&q.ze&&(q.ze.sessionId=g);!Oj(e,si)||null!==e&&ib(Pj,e.appId)||(q.customControllerPath="cast_route_details.html?"+["sessionId="+g,"appId="+c].join("&"));q.description=e.statusText||e.displayName;k?this.w.Jh(this,B):(this.w.Ul(this,B),B.isLocal&&this.w.Vh(this.la(),!0));a&&f.tv(a)&&this.Fd.n3(e,b,a);return B};
d.hd=function(a){var b=this,c=this.eb.get(a);if(!c)return Promise.reject(new Jk(3,"Route in Cast provider not found for routeId  "+a));var e=this.oa.qh(a);if(!e)return this.em(a,!0),Promise.resolve();var f=e.session.sessionId,g=this.da.Z(c.sinkId);if(!g)return this.Fd.zj(f),Promise.resolve();(a=this.Wb.qh(a))&&this.Fd.XL(a.clientId,g,chrome.cast.Wm.STOP);Yi(0);return new Promise(function(a){var c=function(){b.Fd.Gt(g.getId());a()};b.Hd.W6(f,g).then(c,c)})};
d.dV=function(a){var b=this,c=null;Ac(this.eb.Ux(),function(e){if(!e.Ik)return!1;var f=b.da.Z(e.sinkId);if(!f||!a.X0(b.Pz(e.mediaSource,f)))return!1;c=e;return!0});if(!c||!c.mediaSource)return null;var e=ok(c.mediaSource);if(!e)return null;var f=this.Wb.Rd(e);return f?(e=this.oa.Rd(e))?{xk:f,bM:e}:null:null};
d.ER=function(a,b,c){var e=this.dV(a);if(!e){if(!this.cj||this.cj.xk.origin!=b||this.cj.xk.tabId!=c)return null;e=this.cj}switch(a.ex()){case chrome.cast.Hf.PAGE_SCOPED:return null;case chrome.cast.Hf.ORIGIN_SCOPED:if(b!=e.xk.origin)return null;break;case chrome.cast.Hf.TAB_AND_ORIGIN_SCOPED:if(b!=e.xk.origin||c!=e.xk.tabId)return null}return this.oa.ve(e.bM.session.sessionId)};
d.kE=function(a,b,c,e,f,g){var k=this,p=null;Ac(this.eb.Ux(),function(a){var b=a.ze;return b&&null!=b.tabId&&b.tabId==c&&Og(a.mediaSource)?(p=a,!0):!1});if(!p)return null;var q=function(){return k.Ye(a,g||p.sinkId,"",e,f,b,null==c?void 0:c)};return wg(this.hd(p.id).then(q,q))};
d.vi=function(a,b,c,e,f){if(!nk(a))return vg(Error("Unsupported presentation URL"));b=Nk(b);b=this.oa.ve(b.IK);if(!b)return vg(Error("No matching route"));var g=this.da.Z(b.sinkId);if(!g)return vg(Error("No sink"));a=this.Se(a,g,c,b.session,e,f);return ug(a)};
d.bj=function(a,b,c,e,f,g){var k=nk(a);if(!k)return vg(Error("Unsupported presentation URL"));var p;if(b==chrome.cast.tP){if(p=this.ER(k,f,g),!p&&k.sW()!=chrome.cast.mq.CAST_THIS_TAB&&(e=this.kE(a,f,g,c,e)))return e}else p=0==b.indexOf(chrome.cast.xC)?this.oa.ve(b.substr(chrome.cast.xC.length)):this.oa.RY(b);if(!p)return vg(Error("No matching route"));if(p.offTheRecord!=c)return vg(Error("Off the record mismatch"));e=this.da.Z(p.sinkId);if(!e)return vg(Error("No sink"));a=this.Se(a,e,b,p.session,
f,g);a.offTheRecord=c;return ug(a)};d.eh=function(a){this.em(a,!1)};d.fg=function(a){var b=!0,c=!0;if(a=this.da.Z(a))b=a.Gd,c=!!(b&1),b=!!(b&4);return Eh(b,c)};d.Wn=function(){return"cast_streaming"};
d.Zh=function(a,b,c){var e=this;if(!c)return this.Fd.Be(a,b),Promise.resolve();var f=this.oa.qh(a);if(!f)return Promise.reject(Error("Not managing the route "+a));var g=this.da.Z(f.sinkId);if(!g)return Promise.reject(Error("Sink no longer accessible"));var k=(a=this.Wb.qh(a))?a.clientId:this.Bd;return new Promise(function(a){e.Zc.St(g,c.namespace,b,k,f.session.transportId).then(a,a)})};
d.hn=function(a,b){var c=this.da.Z(b);if(!c)return!1;a=this.Pz(a,c);return(a=mk(a))&&0!=a.length?db(a,function(a){return vi(c.se(a))}):!1};d.tk=function(a,b){var c=this.Ir(a);return c&&0!=c.length?b&&b.mediaSource?(a=mk(b.mediaSource),db(a,function(a){return ib(c,a)})):!0:!1};d.lZ=function(a){return(a=this.eb.get(a))?lk(a.mediaSource):null};d.Pz=function(a,b,c){return Pg(a)||Qg(a)?(a={appId:0==(b.Gd&1)?"85CDB22F":"0F5096E8",capabilities:Lj(b.Gd)},(new hk([a],void 0,void 0,void 0,c)).toString()):a};
d.Ir=function(a){var b=[];Pg(a)||Qg(a)?(b.push("85CDB22F"),b.push("0F5096E8")):(a=mk(a))&&(b=qb(b,a));return b};d.hz=function(a){this.da.hz(a.getId());Yi(2)};d.C2=function(a){this.Fd.TK(a,!0)};d.A2=function(a,b){this.FD.m_(a,b);this.Fd.J3(a.getId(),b)};d.pj=function(a){this.w.onSinkAvailabilityUpdated(this,1);this.wd(a);this.Fd.TK(a)};d.it=function(a){if(0==this.da.Nc().length)this.w.onSinkAvailabilityUpdated(this,0);this.Fd.it(a.getId());this.TH()};d.wd=function(a){this.od.sp(a);this.TH()};
d.TH=function(){this.FD.S_();this.w.Rc()};d.la=function(){return"cast.Provider"};d.getData=function(){return[new al(this.Bd,this.eb.b(),this.cj)]};d.ib=function(){var a=zi(this);a&&(this.Bd=a.$L,this.eb.addAll(a.routes),this.cj=a.h1)};d.yg=function(){return null};d.a=D("mr.CastProvider");var al=function(a,b,c){this.$L=a;this.routes=b;this.h1=c};var bl=function(){if(!Tc)return!1;try{return new ActiveXObject("MSXML2.DOMDocument"),!0}catch(a){return!1}},cl=Tc&&bl();var dl=function(){this.re=[];this.Ue=[]};d=dl.prototype;d.I1=function(){0==this.re.length&&(this.re=this.Ue,this.re.reverse(),this.Ue=[])};d.enqueue=function(a){this.Ue.push(a)};d.dh=function(){this.I1();return this.re.pop()};d.S=function(){return this.re.length+this.Ue.length};d.$b=function(){return 0==this.re.length&&0==this.Ue.length};d.clear=function(){this.re=[];this.Ue=[]};d.contains=function(a){return ib(this.re,a)||ib(this.Ue,a)};
d.remove=function(a){var b;b=this.re;var c=ab(b,a);0<=c?(mb(b,c),b=!0):b=!1;return b||nb(this.Ue,a)};d.F=function(){for(var a=[],b=this.re.length-1;0<=b;--b)a.push(this.re[b]);for(var c=this.Ue.length,b=0;b<c;++b)a.push(this.Ue[b]);return a};var el=function(a,b){I.call(this);this.AJ=a||0;this.hj=b||10;if(this.AJ>this.hj)throw Error("[goog.structs.Pool] Min can not be greater than max");this.pc=new dl;this.wh=new Mc;this.Dw=0;this.wy=null;this.wq()};w(el,I);d=el.prototype;d.getObject=function(){var a=v();if(!(null!=this.wy&&a-this.wy<this.Dw)){var b=this.B6();b&&(this.wy=a,this.wh.add(b));return b}};d.yj=function(a){return this.wh.remove(a)?(this.uv(a),!0):!1};
d.B6=function(){for(var a;0<this.oG()&&(a=this.pc.dh(),!this.fz(a));)this.wq();!a&&this.S()<this.hj&&(a=this.Uf());return a};d.uv=function(a){this.wh.remove(a);this.fz(a)&&this.S()<this.hj?this.pc.enqueue(a):this.Bi(a)};d.wq=function(){for(var a=this.pc;this.S()<this.AJ;)a.enqueue(this.Uf());for(;this.S()>this.hj&&0<this.oG();)this.Bi(a.dh())};d.Uf=function(){return{}};d.Bi=function(a){if("function"==typeof a.pb)a.pb();else for(var b in a)a[b]=null};
d.fz=function(a){return"function"==typeof a.vS?a.vS():!0};d.contains=function(a){return this.pc.contains(a)||this.wh.contains(a)};d.S=function(){return this.pc.S()+this.wh.S()};d.uX=function(){return this.wh.S()};d.oG=function(){return this.pc.S()};d.$b=function(){return this.pc.$b()&&this.wh.$b()};d.L=function(){el.U.L.call(this);if(0<this.uX())throw Error("[goog.structs.Pool] Objects not released");delete this.wh;for(var a=this.pc;!a.$b();)this.Bi(a.dh());delete this.pc};var fl=function(a,b){this.Hs=a;this.bk=b};fl.prototype.getKey=function(){return this.Hs};fl.prototype.qc=function(){return this.bk};fl.prototype.clone=function(){return new fl(this.Hs,this.bk)};var gl=function(a){this.Yd=[];a&&this.z0(a)};d=gl.prototype;d.insert=function(a,b){var c=this.Yd;c.push(new fl(a,b));this.f2(c.length-1)};d.z0=function(a){var b;if(a instanceof gl){if(b=a.kb(),a=a.F(),0>=this.S()){for(var c=this.Yd,e=0;e<b.length;e++)c.push(new fl(b[e],a[e]));return}}else b=Eb(a),a=Db(a);for(e=0;e<b.length;e++)this.insert(b[e],a[e])};d.remove=function(){var a=this.Yd,b=a.length,c=a[0];if(!(0>=b))return 1==b?jb(a):(a[0]=a.pop(),this.e2(0)),c.qc()};
d.e2=function(a){for(var b=this.Yd,c=b.length,e=b[a];a<c>>1;){var f=this.CX(a),g=this.jZ(a),f=g<c&&b[g].getKey()<b[f].getKey()?g:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e};d.f2=function(a){for(var b=this.Yd,c=b[a];0<a;){var e=this.xY(a);if(b[e].getKey()>c.getKey())b[a]=b[e],a=e;else break}b[a]=c};d.CX=function(a){return 2*a+1};d.jZ=function(a){return 2*a+2};d.xY=function(a){return a-1>>1};d.F=function(){for(var a=this.Yd,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].qc());return b};
d.kb=function(){for(var a=this.Yd,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].getKey());return b};d.Ek=function(a){return db(this.Yd,function(b){return b.qc()==a})};d.ya=function(a){return db(this.Yd,function(b){return b.getKey()==a})};d.clone=function(){return new gl(this)};d.S=function(){return this.Yd.length};d.$b=function(){return 0==this.Yd.length};d.clear=function(){jb(this.Yd)};var hl=function(){gl.call(this)};w(hl,gl);hl.prototype.enqueue=function(a,b){this.insert(a,b)};hl.prototype.dh=function(){return this.remove()};var il=function(a,b){this.xE=void 0;this.Lt=new hl;el.call(this,a,b)};w(il,el);d=il.prototype;d.getObject=function(a,b){if(!a)return(a=il.U.getObject.call(this))&&this.Dw&&(this.xE=h.setTimeout(u(this.os,this),this.Dw)),a;this.Lt.enqueue(l(b)?b:100,a);this.os()};d.os=function(){for(var a=this.Lt;0<a.S();){var b=this.getObject();if(b)a.dh().apply(this,[b]);else break}};d.uv=function(a){il.U.uv.call(this,a);this.os()};d.wq=function(){il.U.wq.call(this);this.os()};
d.L=function(){il.U.L.call(this);h.clearTimeout(this.xE);this.Lt.clear();this.Lt=null};var jl=function(a,b,c,e){this.Yi=a;this.Lg=!!e;il.call(this,b,c)};w(jl,il);jl.prototype.Uf=function(){var a=new rf,b=this.Yi;b&&b.forEach(function(b,e){a.headers.set(e,b)});this.Lg&&a.pB(!0);return a};jl.prototype.fz=function(a){return!a.isDisposed()&&!a.kg()};var kl=function(a,b,c,e,f,g){K.call(this);this.mg=l(a)?a:1;this.Hg=l(f)?Math.max(0,f):0;this.Lg=!!g;this.Tm=new jl(b,c,e,g);this.Dc=new C;this.Ea=new Xh(this)};w(kl,K);var ll="ready complete success error abort timeout".split(" ");d=kl.prototype;d.ju=function(a){this.Hg=Math.max(0,a)};
d.send=function(a,b,c,e,f,g,k,p,q,B){if(this.Dc.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new ml(b,u(this.t_,this,a),c,e,f,k,l(p)?p:this.mg,q,l(B)?B:this.Lg);this.Dc.set(a,b);a=u(this.j_,this,a);this.Tm.getObject(a,g);return b};d.abort=function(a,b){var c=this.Dc.get(a);if(c){var e=c.av;c.n8(!0);b&&(e&&(this.qL(e,c.hC),te(e,"ready",function(){this.Tm.yj(e)},!1,this)),this.Dc.remove(a));e&&e.abort()}};
d.j_=function(a,b){var c=this.Dc.get(a);c&&!c.av?(this.rR(b,c.hC),b.ju(this.Hg),b.uN(c.gm),b.pB(c.Lg),c.av=b,this.dispatchEvent(new nl("ready",this,a,b)),this.BL(a,b),c.FC&&b.abort()):this.Tm.yj(b)};d.t_=function(a,b){var c=b.target;switch(b.type){case "ready":this.BL(a,c);break;case "complete":return this.p_(a,c,b);case "success":this.a0(a,c);break;case "timeout":case "error":this.mo(a,c);break;case "abort":this.h_(a,c)}return null};
d.BL=function(a,b){var c=this.Dc.get(a);!c||c.aE||c.by()?(c&&(this.qL(b,c.hC),this.Dc.remove(a)),this.Tm.yj(b)):(c.p0(),b.send(c.getUrl(),c.Y1,c.$c,c.Pr()))};d.p_=function(a,b,c){var e=this.Dc.get(a);if(7==b.yh||b.Vd()||e.by())if(this.dispatchEvent(new nl("complete",this,a,b)),e&&(e.X8(!0),e.$D))return e.$D.call(b,c);return null};d.h_=function(a,b){this.dispatchEvent(new nl("abort",this,a,b))};d.a0=function(a,b){this.dispatchEvent(new nl("success",this,a,b))};
d.mo=function(a,b){this.Dc.get(a).by()&&this.dispatchEvent(new nl("error",this,a,b))};d.qL=function(a,b,c){this.Ea.jd(a,c||ll,b)};d.rR=function(a,b,c){this.Ea.listen(a,c||ll,b)};d.L=function(){kl.U.L.call(this);this.Tm.pb();this.Tm=null;this.Ea.pb();this.Ea=null;this.Dc.clear();this.Dc=null};var nl=function(a,b,c,e){J.call(this,a,b);this.id=c;this.av=e};w(nl,J);
var ml=function(a,b,c,e,f,g,k,p,q){this.Ru=a;this.Y1=c||"GET";this.$c=e;this.Yi=f||null;this.mg=l(k)?k:1;this.jD=0;this.FC=this.aE=!1;this.hC=b;this.$D=g;this.gm=p||"";this.Lg=!!q;this.av=null};d=ml.prototype;d.getUrl=function(){return this.Ru};d.Pr=function(){return this.Yi};d.Vr=function(){return this.mg};d.p0=function(){this.jD++};d.by=function(){return this.jD>this.mg};d.X8=function(a){this.aE=a};d.n8=function(a){this.FC=a};var ol=function(){this.name="unknown";this.state="error";this.D0=null;this.allowStop=!0;this.serviceData=this.wg=null;this.extraData={}},rl=function(a,b,c){this.Me=a;(a=b)||(pl||(pl=new kl(3,null,1,10,2E3)),a=pl);this.lq=a;this.Um=[];c||(ql||(ql=new kl(0,null,1,10,15E3)),c=ql);this.sP=c;this.a=D("mr.dial.Client")};d=rl.prototype;d.abort=function(){var a=this;this.Um.forEach(function(b){a.lq.abort(b,!0);a.sP.abort(b,!0)})};
d.launchApp=function(a,b){var c=new Vd,e=(++sl).toString();this.Um.push(e);this.sP.send(e,this.dx(a),"POST",b,null,0,this.pF("launchApp","POST",e,c));return c.promise};d.aO=function(a){var b=new Vd,c=(++sl).toString();this.Um.push(c);this.lq.send(c,this.dx(a),"DELETE",null,null,0,this.pF("stopApp","DELETE",c,b),0);return b.promise};d.cx=function(a){var b=this;return new Promise(function(c){var e=(++sl).toString();b.Um.push(e);b.lq.send(e,b.dx(a),"GET",null,null,0,u(b.U2,b,e,c))})};
d.U2=function(a,b,c){nb(this.Um,a);a=c.target;kf(this.a,"GetAppInfo","GET",a,!0);if(a.Vd()){c=a.kH();if(!c)if(c=a.Qi(),"undefined"!=typeof DOMParser)c=(new DOMParser).parseFromString(c,"application/xml");else if(cl){var e=new ActiveXObject("MSXML2.DOMDocument");e.resolveExternals=!1;e.validateOnParse=!1;try{e.setProperty("ProhibitDTD",!0),e.setProperty("MaxXMLSize",2048),e.setProperty("MaxElementDepth",256)}catch(p){}e.loadXML(c);c=e}else throw Error("Your browser does not support loading xml documents");
if(c)if((e=c.getElementsByTagName("service"))&&1==e.length){c=new ol;for(var f=0,g=e[0].childNodes.length;f<g;f++){var k=e[0].childNodes[f];if("state"==k.nodeName){a:switch(k.textContent){case "running":k="running";break a;case "stopped":k="stopped";break a;default:k="error"}c.state=k}else"name"==k.nodeName?c.name=k.textContent:"link"==k.nodeName?c.wg=k.getAttribute("href"):"options"==k.nodeName?c.allowStop="false"!=k.getAttribute("allowStop"):c.extraData[k.nodeName]=k.innerHTML}if("unknown"==c.name)G(this.a,
"GET response missing name value"),b(new tl(a,null));else if("error"==c.state)G(this.a,"GET response missing state value"),b(new tl(a,null));else{if((e=/installable=(.+)/.exec(c.state))&&e[1])c.state="installable",c.D0=e[1];else if("running"!=c.state&&"stopped"!=c.state){G(this.a,"GET response has invalid state value");b(new tl(a,null));return}b(new tl(a,c))}}else G(this.a,"Invalid GET response (invalid service)"),b(new tl(a,null));else G(this.a,"Empty response"),b(new tl(a,null))}else G(this.a,"Request to "+
a.Sr()+" failed"),b(new tl(a,null))};d.dx=function(a){var b=this.Me.fh;"/"!=b.charAt(b.length-1)&&(b+="/");return b+a};d.pF=function(a,b,c,e){var f=this;return function(g){nb(f.Um,c);g=g.target;kf(f.a,a,b,g,!0);g.Vd()?e.resolve(void 0):e.reject(Error(lf(g.yh)))}};var pl=null,ql=null,sl=999,tl=function(a,b){this.rP=a;this.Kf=b;this.G7=!!b&&"running"==b.state};var ul=function(a,b,c){this.appName=b;this.launchParameter=c||""},wl=function(a){if(Ea(a,"urn:dial-multiscreen-org:dial:application:")){var b=a.indexOf("?"),c=a.substring(42,0<b?b:void 0);a=c&&0<c.length?new ul(a,c,0<b?a.substring(b+1):void 0):null}else a=vl(a);return a},vl=function(a){var b=(new Wj(a)).Ii;if(!b)return null;var c=xl.exec(b),c=c?c[1]:null;if(!c)return null;c=decodeURIComponent(c);if(b=(b=yl.exec(b))?b[1]:void 0)try{b=Vh(b)}catch(e){return F(zl,"Invalid base64 encoded postData:"+b),
null}return new ul(a,c,b)},zl=D("mr.DialProvider"),xl=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,yl=/__dialPostData__=([A-Za-z0-9]+={0,2})/;var Al=function(a,b){this.Ya=a;this.appName=b};var Bl=function(a){this.zd=new Map;this.rv=a};d=Bl.prototype;d.init=function(){Ci(this)};d.clear=function(){this.zd.clear()};d.add=function(a){this.MF(a.Ya.id)||(this.zd.set(a.Ya.id,a),this.rv.m2(a))};d.MF=function(a){return this.zd.get(a)||null};d.NF=function(a){for(var b=ia(this.zd),c=b.next();!c.done;c=b.next())if(c=ia(c.value),c.next(),c=c.next().value,c.Ya.sinkId==a)return c;return null};d.x6=function(a){if(a=this.NF(a))this.zd.delete(a.Ya.id),this.rv.MJ(a)};
d.nL=function(a){var b=this.zd.get(a);b&&(this.zd.delete(a),this.rv.MJ(b))};d.ig=function(){return Array.from(this.zd.values(),function(a){return a.Ya})};d.sV=function(){return Array.from(this.zd.values())};d.la=function(){return"dial.ActivityRecords"};d.getData=function(){return[Array.from(this.zd)]};d.ib=function(){var a=zi(this);a&&(this.zd=new Map(a))};var Cl={Yea:0,hha:1,pga:2,Xea:3},Dl={ERROR:0,Hga:1,EMPTY:2},El=function(a){Hg("MediaRouter.Dial.Create.Route",a,Cl)},Fl=function(a){Hg("MediaRouter.Dial.Device.Description.Failure",a,Dl)};var Gl=function(a){return Promise.all(a.map(function(a){return a.then(function(a){return{wF:!0,value:a}},function(a){return{wF:!1,reason:a}})}))};var Hl=function(a,b){this.a=D("mr.dial.AppDiscoveryService");this.Cc=new Set;this.da=a;this.kd=b;this.ic=new Map;this.mw=new Map;this.Oe=null;this.jm=!1};d=Hl.prototype;d.init=function(){Ci(this)};d.start=function(){G(this.a,"Starting periodic scanning.");this.jm||(this.jm=!0,this.JE())};d.stop=function(){G(this.a,"Stopping periodic scanning.");this.jm&&(this.jm=!1,this.Oe&&(clearTimeout(this.Oe),this.Oe=null),this.ic.clear(),this.mw.forEach(function(a){a.abort()}))};
d.eA=function(a){if(!this.Cc.has(a)||this.vR(a))this.Cc.add(a),0!=this.da.ds()&&(this.jm?this.da.Nc().forEach(this.IE.bind(this,a)):this.start())};d.PB=function(a){this.Cc.delete(a)};d.VY=function(){return Array.from(this.Cc)};
d.JE=function(){var a=this;G(this.a,"Start app status scan.");var b=[];this.da.Nc().forEach(function(c){b.push.apply(b,a.sp(c))});this.kd.sV().forEach(function(c){b.push(a.I7(c))});var c=function(){a.jm&&!a.Oe&&(H(a.a,"Scan complete; scheduling for next scan."),a.Oe=setTimeout(a.iU.bind(a),6E4))};Gl(b).then(c,c)};d.iU=function(){H(this.a,"Start app status scan (timer-based)");this.Oe=null;this.JE()};
d.sp=function(a){if(!a.Gm)return[];for(var b=[],c=ia(this.Cc),e=c.next();!e.done;e=c.next())b.push(this.IE(e.value,a));return b};d.IE=function(a,b){if("unknown"!=b.se(a)&&36E5>v()-b.uV(a)||!b.Gm)return Promise.resolve();H(this.a,"Querying "+b.getId()+" for "+a+" to update app status");return this.GF(b,a).then(this.M1.bind(this,b,a))};
d.I7=function(a){var b=this.da.Z(a.Ya.sinkId);if(!b)return F(this.a,"Activity refers to nonexistent sink: "+a.Ya.id),Promise.resolve();if(!b.Gm)return Promise.resolve();a=a.appName;H(this.a,"Querying "+b.getId()+" for "+a+" to update activity");return this.GF(b,a).then(this.L1.bind(this,b,a))};d.HW=function(a){var b=this.mw.get(a.getId());b||(b=new rl(a),H(this.a,"Created DIAL client for "+a.getId()),this.mw.set(a.getId(),b));return b};
d.GF=function(a,b){var c=this,e=Il(a,b),f=this.ic.get(e);if(f)return f;f=this.HW(a).cx(b);this.ic.set(e,f);a=function(){c.ic.delete(e)};f.then(a,a);return f};d.EV=function(a,b){if(404==b.rP.$a())return"unavailable";b=b.Kf;if("Netflix"==a)return this.hU(b);switch(b.state){case "running":case "stopped":return"available";default:return"unavailable"}};
d.hU=function(a){return a.extraData&&l(a.extraData.capabilities)&&"websocket"==a.extraData.capabilities&&("running"==a.state||"stopped"==a.state)?"available":"unavailable"};var Il=function(a,b){return a.getId()+":"+b};d=Hl.prototype;d.M1=function(a,b,c){if(404==c.rP.$a()||c.Kf){c=this.EV(b,c);H(this.a,"Got app status "+c+" from "+a.getId()+" for "+b);var e=a.se(b);a.yp(b,c);c!=e&&this.da.v2(b,a)}else F(this.a,"Failed to process app availability; "+a.getId()+" does not support app availability"),a.GN(!1)};
d.L1=function(a,b,c){(a=this.kd.NF(a.getId()))&&a.appName==b&&!c.G7&&this.kd.nL(a.Ya.id)};d.vR=function(a){return this.da.Nc().some(function(b){return"unknown"==b.se(a)})};d.la=function(){return"dial.AppDiscoveryService"};d.getData=function(){return[this.VY()]};d.ib=function(){var a=zi(this);this.Cc=new Set(a||[])};var Jl=function(){this.configId=this.modelName=this.deviceType=this.Sw=this.Uw=this.Cq=this.ipAddress=this.friendlyName=this.deviceLabel=this.$p=null};Jl.prototype.yda=function(){return this.deviceLabel?this.$p?this.friendlyName?this.ipAddress?this.Cq?this.Uw?this.Sw?null:"Missing expireTimeMillis":"Missing fetchTimeMillis":"Missing appUrl":"Missing ipAddress":"Missing friendlyName":"Missing uniqueId":"Missing deviceLabel"};
Jl.prototype.toString=function(){return JSON.stringify(this,function(a,b){return r(b)&&0==b.indexOf("uuid:")?"***":b})};var Ml=function(a){this.Vv=new C;this.ic=new Mc;this.Iz=new C;var b;(b=a)||(Kl||(Kl=new kl(3,null,1,10,2E3)),b=Kl);this.lq=b;a||(Ll||(Ll=new kl(2,null,1,10,3E3)),a=Ll);this.TQ=a;this.a=D("mr.dial.DeviceDescriptionService")};d=Ml.prototype;
d.EW=function(a){var b=this.KS(a);return b?(Gg("MediaRouter.Dial.Device.Description.Cached"),Promise.resolve(b)):this.ic.contains(a.deviceLabel)?Promise.reject(Error("Duplicate request for device "+a.deviceLabel)):this.VU(a)};d.KS=function(a){var b=this.Vv.get(a.deviceLabel);return b?b.configId!=a.configId||v()>=b.Sw?(H(this.a,"Removing invalid entry "+b.toString()),this.Vv.remove(a.deviceLabel),null):b:null};
d.VU=function(a){var b=this;return new Promise(function(c,e){b.ic.add(a.deviceLabel);b.lq.send(a.deviceLabel,a.deviceDescriptionUrl,"GET",null,null,0,function(f){(f=b.v5(a,f))?c(f):e(Error("Failed to get device description"))})})};
d.v5=function(a,b){this.ic.remove(a.deviceLabel);b=b.target;kf(this.a,"fetchDeviceDescription","GET",b);if(!b.Vd())return G(this.a,"Request to "+b.Sr()+" failed"),Fl(0),null;var c=b.kH();if(!c)return G(this.a,"Invalid or empty response"),Fl(2),null;b=this.z4(b,a,c);if(!b)return Fl(1),G(this.a,"Invalid device description"),null;G(this.a,"Got device description for "+b.deviceLabel);H(this.a,"... device description was: "+b.toString());null!=b.configId&&(H(this.a,"Caching device description for "+b.deviceLabel),
this.Vv.set(a.deviceLabel,b));return b};
d.z4=function(a,b,c){var e=new Jl;e.Uw=v();e.Sw=e.Uw+18E5;e.deviceLabel=b.deviceLabel;e.configId=b.configId;e.Cq=a.getResponseHeader("Application-URL")||null;a=e.Cq;a=a instanceof Wj?a.clone():new Wj(a,void 0);e.ipAddress=a.cg();e.deviceType=Nl(c,"deviceType");e.modelName=Nl(c,"modelName");e.friendlyName=Nl(c,"friendlyName");e.$p=Nl(c,"UDN");a=e.yda();H(this.a,"Device description: "+Ol(c));return a?(F(this.a,"Device description failed to validate ("+a+"): "+JSON.stringify(e)),null):e};
var Nl=function(a,b){return(a=a.getElementsByTagName(b))&&0!=a.length?a[0].textContent:null},Ol=function(a){var b=function(a){for(var b=0,c=a.length;b<c;b++)a[b].textContent="***"};b(a.getElementsByTagName("UDN"));b(a.getElementsByTagName("serialNumber"));return(new XMLSerializer).serializeToString(a)};
Ml.prototype.kn=function(a){var b=this,c=this.Iz.get(a);if(c)return c.promise;c=new Vd;this.Iz.set(a,c);this.TQ.send(a,a,"GET",null,null,0,function(e){b.Iz.remove(a);e=e.target;kf(b.a,"checkAccess","GET",e,!1);c.resolve(e.Vd())});return c.promise};var Kl=null,Ll=null;var Pl=null,Ql=null,Rl=function(){Pl||(Pl=new gj("dial.DialOnDeviceListEventListener","mr.dial.SinkDiscoveryService",chrome.dial.onDeviceList));Ql||(Ql=new gj("dial.DialOnErrorEventListener","mr.dial.SinkDiscoveryService",chrome.dial.onError));return[Pl,Ql]};var Sl=function(a,b){this.og="mr.dial.SinkDiscoveryService";this.Hp=a;this.AE=b||new Ml;this.a=D("mr.dial.SinkDiscoveryService");this.Le=new C;this.ct=this.Ny=!1};ja(Sl,bj);d=Sl.prototype;d.init=function(){Ci(this);fj(this)};d.start=function(){this.Ny||(G(this.a,"Starting..."),this.Ny=!0,Rl().forEach(function(a){return a.register()}),this.refresh())};d.refresh=function(){var a=this;this.Ny?chrome.dial.discoverNow(function(b){G(a.a,"chrome.dial.discoverNow = "+b)}):G(this.a,"Not started. Ignoring discover().")};
d.O2=function(a){var b=this;G(this.a,"onDeviceList returned "+a.length+" devices");H(this.a,"....the list is: "+JSON.stringify(a));this.ct=!1;var c=[],e=new Mc;a.forEach(function(a){c.push(b.w5(a).then(function(a){e.add(a.getId());b.G1(a)},function(){}))});a=function(){b.ct||b.ap(e)};Promise.all(c).then(a,a)};
d.G1=function(a){if(!this.ct){H(this.a,"mayAddSink, id = "+a.getId());var b=this.Le.get(a.getId());b?b.update(a)&&(H(this.a,"Updated sink "+b.getId()),this.Hp.wd(b)):(H(this.a,"Adding new sink "+a.getId()),Pd(this.a,Hd,"...sink was "+a.rO()),this.Le.set(a.getId(),a),this.Hp.pj(a))}};d.ap=function(a){var b=this;this.Le.F().forEach(function(c){a.contains(c.getId())||b.IS(c).then(function(a){a||(b.Le.remove(c.getId()),b.Hp.Ce([c]))})})};d.IS=function(a){return a.Xf?this.AE.kn(a.Xf):Promise.resolve(!1)};
d.w5=function(a){return this.AE.EW(a).then(function(b){var c;b.$p?(c=b.$p,0==c.indexOf("uuid:")&&(c=c.substr(5)),c=c.replace(/-/g,"").toLowerCase()):c="";var e=b.$p?Mi.N().$k(c):a.deviceLabel,f=Tl.test(b.modelName);return(new Ni(b.friendlyName,c)).bu(e).R9(b.ipAddress).o9(b.Cq).l9(a.deviceDescriptionUrl).t$(b.modelName).GN(!f)})};
d.R3=function(a){switch(a.code){case "no_valid_network_interfaces":case "network_disconnected":F(this.a,"DIAL error: "+a.code+". Clear device list now.");a=this.Le.F();this.Le.clear();this.Hp.Ce(a);this.ct=!0;break;case "no_listeners":case "socket_error":case "cellular_network":case "unknown":F(this.a,"DIAL error: "+a.code+". Keep device list.");break;default:F(this.a,"Unhandled DIAL error: "+a.code)}};d.Z=function(a){return this.Le.get(a,null)};
d.yZ=function(a){var b=[];this.Nc().forEach(function(c){"available"==c.se(a)&&b.push(c.mh())});var c=Ul[a];return new Kk(b,c?[c]:void 0)};d.Nc=function(){return this.Le.F()};d.ds=function(){return this.Le.S()};d.v2=function(a,b){this.Hp.wd(b)};
d.handleEvent=function(a,b){for(var c=[],e=1;e<arguments.length;++e)c[e-1]=arguments[e];if(a==chrome.dial.onDeviceList)this.O2.apply(this,[].concat(ka(c)));else if(a==chrome.dial.onError)this.R3.apply(this,[].concat(ka(c)));else throw Error("Unhandled event");};d.la=function(){return"dial.DialSinkDiscoveryService"};d.getData=function(){return[this.Le.b()]};d.ib=function(){var a=zi(this);if(a)for(var b in a)this.Le.set(b,Oi(a[b]))};
var Ul={YouTube:"https://www.youtube.com",Netflix:"https://www.netflix.com",Pandora:"https://www.pandora.com",Radio:"https://www.pandora.com",Hulu:"https://www.hulu.com",Vimeo:"https://www.vimeo.com",Dailymotion:"https://www.dailymotion.com","com.dailymotion":"https://www.dailymotion.com"},Tl=/Eureka Dongle|Chromecast Audio/i;var Vl=function(a,b,c){this.w=a;this.Fc=b||new Sl(this);this.kd=new Bl(this);this.od=c||new Hl(this.Fc,this.kd);this.v7=new xj("dial.RouteIdGenerator")};d=Vl.prototype;d.getName=function(){return"dial"};d.Ud=function(){this.v7.SE();this.kd.init();this.Fc.init();this.od.init();this.Eo()};d.Jn=function(a){H(this.a,"GetAvailableSinks for "+a);return(a=wl(a))?this.Fc.yZ(a.appName):Lk};d.Tj=function(a){if(a=wl(a))this.od.eA(a.appName),this.Eo()};d.Wj=function(a){if(a=wl(a))this.od.PB(a.appName),this.Ys()};
d.Sj=function(){this.Eo()};d.Vj=function(){this.Ys()};d.Ys=function(){(0==this.Fc.ds()||0==this.od.Cc.size&&0==this.kd.zd.size)&&this.od.stop()};d.Eo=function(){this.Fc.start();0<this.Fc.ds()&&(0<this.od.Cc.size||0<this.kd.zd.size)&&this.od.start()};d.Z=function(a){return(a=this.Fc.Z(a))?a.mh():null};d.ig=function(){return this.kd.ig()};
d.Ye=function(a,b,c,e){var f=this,g=this.Fc.Z(b);if(!g)return El(0),vg(Error("Unkown sink: "+b));Mi.N().xj=new Li(g.Bc,g.va);var k=wl(a);if(!k)return vg(Error("No app name set."));var p=k.appName,q=new rl(g);return wg(q.cx(p).then(function(a){if(!a.Kf)throw Error("Failed to get app info");if("running"==a.Kf.state)return q.aO(p)}).then(function(){return q.launchApp(p,k.launchParameter)}).then(function(){return f.Se(b,a,!0,p,c,e)}).catch(function(a){El(3);throw a;}))};d.bj=function(){return vg(Error("no supported"))};
d.vi=function(){return vg(Error("no supported"))};d.eh=function(){};d.Se=function(a,b,c,e,f,g){El(1);a=Pk(f,this.getName(),a,b,c,e,null);a.offTheRecord=g;this.kd.add(new Al(a,e));return a};d.pj=function(a){this.w.onSinkAvailabilityUpdated(this,1);this.Eo();this.od.sp(a);this.w.Rc();Mi.N().wj=new Li(a.Bc,a.va)};d.Ce=function(a){var b=this;if(0==this.Fc.ds())this.w.onSinkAvailabilityUpdated(this,0);this.Ys();a.forEach(function(a){b.kd.x6(a.getId())});this.w.Rc()};d.wd=function(){this.w.Rc()};
d.m2=function(a){this.Eo();this.w.Ul(this,a.Ya)};d.MJ=function(a){a=a.Ya;if(a.isLocal)this.w.onPresentationConnectionStateChanged(a.id,"terminated");this.Ys();this.w.oj(this,a)};d.hd=function(a){var b=this.kd.MF(a);if(!b)return Promise.reject(new Jk(3,"Route in DIAL provider not found for routeId "+a));this.kd.nL(a);return(a=this.Fc.Z(b.Ya.sinkId))?(new rl(a)).aO(b.appName):Promise.reject(new Jk(3,"Sink in DIAL provider not found for sinkId "+b.Ya.sinkId))};d.fg=function(){return null};d.Wn=function(){return null};
d.Zh=function(){return Promise.reject(Error("DIAL sending message is not supported"))};d.hn=function(a,b){b=this.Fc.Z(b);return!b||Pg(a)?!1:(a=wl(a))?"available"==b.se(a.appName):!1};d.tk=function(){return!1};d.yg=function(){return null};d.a=D("mr.DialProvider");var Wl=function(a,b){this.DS=a;this.Gw=b;this.Wg=this.DS.da;this.a=D("mr.cast.CastDialSinkDiscoveryCallbacks")};d=Wl.prototype;d.lU=function(a){return this.Wg.kn(a)};d.qH=function(a){var b=this.Wg.Z(a.getId());return b?b:(a=a.va)?this.Wg.wZ(a,Mi.N().uk||8009):null};d.pj=function(a){this.qH(a)?$i(2):this.EO(a);this.Gw.pj(a)};d.EO=function(a){var b=this,c=Qi(a);c&&this.lU(c).then(function(e){e?b.qH(a)?$i(2):(b.Wg.Ym(c),$i(0)):Gg("MediaRouter.Dial.Sink.Discovered.NonCast")},pa)};
d.Ce=function(a){var b=this;x(a,function(a){var c=b.Wg.Z(a.getId());c&&c.Rk&&b.Wg.fm(a.getId())});this.Gw.Ce(a)};d.wd=function(a){var b=this.Wg.Z(a.getId());b?b.Rk&&(b.update(a.Qn(),a.va,b.Kb(),b.Gd)&&G(this.a,"Updated Cast sink with DIAL sink: "+a.getId()),this.Wg.wd(b)):this.EO(a);this.Gw.wd(a)};var Xl=function(a,b){this.da=new Sl(new Wl(b,this));this.Xh=new C;this.w=a;this.xp=this.Fj=0;this.zo=new Mc;this.Za=new Vl(this,this.da)};d=Xl.prototype;d.la=function(){return"cast.DialProviderWrapper"};d.getData=function(){return[new Yl(this.Xh.b(),this.Fj,this.xp,this.zo.F())]};d.ib=function(){var a=zi(this);a&&(this.Xh.addAll(a.x7),this.Fj=a.sequenceNumber,this.xp=a.m8,this.zo.addAll(a.j1))};d.getName=function(){return this.Za.getName()};d.Ud=function(){this.Za.Ud();Ci(this)};d.ig=function(){return this.Za.ig()};
d.$J=function(){};d.Jn=function(a){return this.Za.Jn(a)};d.Tj=function(a){this.Za.Tj(a)};d.Wj=function(a){this.Za.Wj(a)};d.Sj=function(a){this.Za.Sj(a)};d.Vj=function(a){this.Za.Vj(a)};d.Z=function(a){return this.Za.Z(a)};d.Kr=function(a){return new rl(a)};d.nx=function(a){return this.da.Z(a)};
d.gU=function(a,b,c,e){var f=this,g=wl(a),k=this.nx(b);if(!k)return Promise.reject(Error("Attempting custom launch with closed route"));var p=g.appName;if(!p)return Promise.reject(Error("No app name given"));var q=lk(a);if(!q)return Promise.reject(Error("No client ID"));var B=null;return this.Kr(k).cx(p).then(function(a){if(!a.Kf)return Promise.reject(Error("Failed to get app info"));B=a.Kf}).then(function(){return f.Za.Se(b,a,!0,p,e||"",c)}).then(function(a){var b={routeId:a.id,AI:!1,sinkId:k.getId(),
appName:p,Kf:B,launchParameter:g.launchParameter,session:null,clientId:null};f.Xh.set(a.id,b);f.xT(b,q);return a})};d.I0=function(a){return Zl.test(a)};d.Ye=function(a,b,c,e,f,g,k){return this.I0(a)?wg(this.gU(a,b,e,c)):this.Za.Ye(a,b,c,e,f,g,k)};
d.hd=function(a){var b=this.Xh.get(a);return b&&b.session&&b.clientId?(a={receiver:this.uw(b.sinkId),action:chrome.cast.Wm.STOP},a=new Sj("receiver_action",a),a.clientId=b.clientId,this.w.Be(this,b.routeId,a),a=new Sj("remove_session",b.session.sessionId,void 0),a.clientId=b.clientId,this.w.Be(this,b.routeId,a),b.AI=!0,Promise.resolve()):this.Za.hd(a)};
d.Zh=function(a,b,c){var e=JSON.parse(b);switch(e.type){case "client_connect":return this.R6(a,e.clientId);case "custom_dial_launch":if(this.zo.contains(e.sequenceNumber))return this.G2(a,e);break;case "v2_message":if("STOP"==e.message.type)return this.hd(a),Promise.resolve()}return this.Za.Zh(a,b,c)};d.rY=function(){var a=String(this.xp);this.xp=(this.xp+1)%9007199254740992;return a};
d.xT=function(a,b){var c=this.uw(a.sinkId),e=new Sj("receiver_action",{receiver:c,action:chrome.cast.Wm.CAST});e.clientId=b;this.w.Be(this,a.routeId,e);c=new chrome.cast.B(this.rY(),"",a.appName,[],c);a.session=c;a.clientId=b;c=new Sj("new_session",c);c.clientId=b;this.w.Be(this,a.routeId,c)};
d.G2=function(a,b){this.zo.remove(b.sequenceNumber);b=b.message;a=this.Xh.get(a);if(!a)return Promise.reject(Error("Unknown route"));if(b&&!b.doLaunch)return Promise.resolve();var c=this.nx(a.sinkId);if(!c)return Promise.reject(Error("Custom launch response for sink that no longer exists"));var c=new rl(c),e=a.launchParameter,e=(b?b.launchParameter:null)||e;return c.launchApp(a.appName,e)};
d.uw=function(a){var b=this.nx(a);a=new chrome.cast.jv(a,b.Qn());a.ipAddress=b.va;a.receiverType=chrome.cast.oq.DIAL;return a};d.qY=function(){var a=this.Fj;this.Fj=(this.Fj+1)%9007199254740992;return a};
d.R6=function(a,b){a=this.Xh.get(a);if(!a)return Promise.reject(Error("Unknown route"));var c=this.uw(a.sinkId);c.receiverType=chrome.cast.oq.DIAL;c=new Sj("custom_dial_launch",new chrome.cast.sC(c,a.Kf.state,a.Kf.extraData));c.clientId=b;c.sequenceNumber=this.qY();this.zo.add(c.sequenceNumber);this.w.Be(this,a.routeId,c);return Promise.resolve()};d.fg=function(a){return this.Za.fg(a)};d.Wn=function(a){return this.Za.Wn(a)};d.hn=function(a,b){return this.Za.hn(a,b)};
d.tk=function(a,b){return this.Za.tk(a,b)};d.vi=function(a,b,c,e,f){return this.Za.vi(a,b,c,e,f)};d.bj=function(a,b,c,e,f,g){return this.Za.bj(a,b,c,e,f,g)};d.eh=function(a){var b=this.Xh.get(a);this.Xh.remove(a);b&&b.AI?this.Za.hd(a):this.Za.eh(a)};d.Rc=function(){this.w.Rc()};d.onSinkAvailabilityUpdated=function(a,b){this.w.onSinkAvailabilityUpdated(a,b)};d.Ul=function(a,b){this.w.Ul(this,b)};d.oj=function(a,b){this.w.oj(this,b)};d.Jh=function(a,b){this.w.Jh(this,b)};
d.Be=function(a,b,c){this.w.Be(this,b,c)};d.onPresentationConnectionStateChanged=function(a,b){this.w.onPresentationConnectionStateChanged(a,b)};d.onPresentationConnectionClosed=function(a,b,c){this.w.onPresentationConnectionClosed(a,b,c)};d.Gx=function(a){return this.w.Gx(a)};d.Kx=function(){return this.w.Kx()};d.dg=function(){return this.w.dg()};d.gt=function(a,b,c){this.w.gt(this,b,c)};d.nz=function(a){this.w.nz(a)};d.pj=function(a){this.Za.pj(a)};d.Ce=function(a){this.Za.Ce(a)};d.wd=function(a){this.Za.wd(a)};
d.Np=function(){};d.Ou=function(){};d.yg=function(a,b){return this.Za.yg(a,b)};d.fA=function(a){this.w.fA(a)};d.oy=function(){return this.w.oy()};d.Vh=function(a,b){return this.w.Vh(a,b)};var Yl=function(a,b,c,e){this.x7=a;this.sequenceNumber=b;this.m8=c;this.j1=e},Zl=/__dialAppName__/;var $l=function(a,b){this.routeId=a;this.message=b},am=function(a){return"string"!=typeof a.message};var bm=function(a){if(0>=a)throw Error("invalid buffer size");this.rb=[];this.Hm=[];this.Jl=a};d=bm.prototype;d.enqueue=function(a){this.S()>=this.Jl&&this.dh();this.Hm.push(a)};d.dh=function(){if(this.$b())throw Error("Empty queue");0==this.rb.length&&(this.rb=this.Hm,this.rb.reverse(),this.Hm=[]);return this.rb.pop()};d.VT=function(){var a=this.F();this.clear();return a};d.S=function(){return this.rb.length+this.Hm.length};d.K0=function(){return this.S()==this.Jl};d.$b=function(){return 0==this.S()};
d.F=function(){var a=this.rb.slice();a.reverse();a.push.apply(a,[].concat(ka(this.Hm)));return a};d.clear=function(){this.rb=[];this.Hm=[]};var cm=function(a){I.call(this);I.call(this);this.ud=a;this.xa=this.Js=null};ja(cm,I);cm.prototype.L=function(){this.xa&&(gf(this.xa),this.xa=null)};cm.prototype.ML=function(){if(!this.xa)if(null===this.Js||v()-this.Js>=this.ud)this.Uc();else{var a=Math.max(this.Js+this.ud-v(),5);this.xa=ff(this.Uc,a,this)}};cm.prototype.Uc=function(){this.xa=null;this.KE();this.Js=v()};cm.prototype.KE=function(){};var dm=function(a,b){cm.call(this,20);this.yf=new Map;this.Dh=new Set;this.DA=null;this.Kq=this.Ig=0;this.PN=!1;this.w=a;this.X1=b;this.a=D("mr.RouteMessageSender")};ja(dm,cm);d=dm.prototype;d.init=function(a){this.DA=a;Ci(this)};d.n1=function(a){this.Dh.has(a)||(this.Dh.add(a),this.g0(a)&&this.ML())};d.AB=function(a){this.Dh.delete(a)};
d.send=function(a,b){var c=this.yf.get(a);c||(c=new bm(50),this.yf.set(a,c));if(c.K0()){F(this.a,"Queue is full; dropping oldest message");H(this.a,"   for route "+a);var e=c.dh();this.Ig-=am(e)?0:e.message.length;am(e)&&this.Kq--}b=new $l(a,b);c.enqueue(b);this.Ig+=am(b)?0:b.message.length;am(b)&&this.Kq++;this.XB();this.Dh.has(a)&&this.ML()};d.oj=function(a){this.Dh.delete(a);var b=this.yf.get(a);b&&(this.yf.delete(a),this.ZJ(b.F()),this.XB())};
d.ZJ=function(a){if(0!=a.length){a=ia(a);for(var b=a.next();!b.done;b=a.next())b=b.value,this.Ig-=am(b)?0:b.message.length,am(b)&&this.Kq--}};d.g0=function(a){return this.yf.has(a)&&!this.yf.get(a).$b()};d.XB=function(){var a=0<this.Kq||this.Ig>this.X1;a!=this.PN&&(this.PN=a,this.w.Vh(this.la(),a))};d.KE=function(){if(this.DA){for(var a=ia(this.Dh),b=a.next();!b.done;b=a.next()){var b=b.value,c=this.yf.get(b);c&&!c.$b()&&(c=c.VT(),this.DA(b,c),this.ZJ(c))}this.XB()}else E(this.a,"sendMessagesCallback not set. Messages not delivered.")};
d.la=function(){return"mr.RouteMessageSender"};d.getData=function(){var a=Array.from(this.yf,function(a){return[a[0],a[1].F()]}),b=Array.from(this.Dh);return[new em(a,b,this.Ig)]};d.ib=function(){var a=this,b=zi(this);b&&(this.yf=new Map,b.Y5.forEach(function(b){var c=b[0];b=b[1];var f=new bm(50);a.yf.set(c,f);b.forEach(function(a){f.enqueue(a)})}),this.Dh=new Set(b.r1),this.Ig=b.Lca)};var em=function(a,b,c){this.Y5=a;this.r1=b;this.Lca=c};var fm={CC:0,rC:1,$P:2},gm=function(a){Hg("MediaRouter.CastStreaming.Start.Success",a,fm)};var hm=D("mr.mirror.cast.LogUploader"),jm=function(a,b,c){im("raw_events.log.gz",a,b,c);return b?"https://crash.corp.google.com/samples?stbtiq="+b:""},im=function(a,b,c,e){if(0==b.size)G(hm,"Trying to upload an empty file to Crash"),e&&e(null);else{var f=new FormData;f.append("prod","Cast");f.append("ver",chrome.runtime.getManifest().version);f.append(a,b);c&&f.append("comments",c);vf("https://clients2.google.com/cr/report",function(a){a=a.target;var b=null;a.Vd()?(b=a.Qi(),G(hm,"Upload to Crash succeeded: "+
b)):G(hm,"Upload to Crash failed. HTTP status: "+a.$a());e&&e(b)},"POST",f,void 0,3E4)}};var km=function(){this.to=0};km.prototype.zba=function(){var a={fraction:.01,autoSubmitTimeLimitMillis:6048E5},b=a.autoSubmitTimeLimitMillis,c=v();return this.to&&b&&c-this.to<b?!1:Math.random()<a.fraction};
var mm=function(a,b,c,e){var f=new lm;f.extVersion=chrome.runtime.getManifest().version;f.extChannel="public";f.minBitrate=c.minVideoBitrate;f.maxBitrate=c.maxVideoBitrate;f.resolution=c.QX();f.minResolution=c.eY();f.resolutionChangePolicy=c.bZ();f.maxFrameRate=c.maxFrameRate;f.minLatency=c.minLatencyMillis;f.maxLatency=c.maxLatencyMillis;f.animatedLatency=c.animatedLatencyMillis;f.useDscp=c.dscpEnabled;f.useTdls=c.useTdls;null!==b&&(f.receiverVersion=b);null!==a&&(f.receiverProductName=a);e.length&&
(f.Kqa=e);return f},om=function(a,b,c,e,f){G(nm,"getRawEvents");return new Promise(function(g,k){var p=function(b){G(nm,"Got receiver version: "+b);b=JSON.stringify(mm(c,b,e,f));chrome.cast.streaming.rtpStream.getRawEvents(a,b,g)};"Chromecast"==c?Df(b).then(p,k):p(null)})},pm=function(a,b,c,e){G(nm,"getStats");return new Promise(function(f,g){var k=function(b){G(nm,"Got receiver version: "+b);var g=mm(c,b,e,[]);chrome.cast.streaming.rtpStream.getStats(a,function(a){var b={tags:g};Nb(b,a);f(b)})};
"Chromecast"==c?Df(b).then(k,g):k(null)})};km.prototype.la=function(){return"mirror.cast.LogUtils"};km.prototype.getData=function(){return[void 0,{lastAutoSubmitMillis:this.to}]};km.prototype.ib=function(){var a=Ai(this);this.to=a&&a.lastAutoSubmitMillis||0};ra(km);var nm=D("mr.mirror.cast.LogUtils"),lm=function(){this.ext="MR";this.senderProductName="Google Chrome";this.senderVersion=hi;this.senderPlatform=Zc;this.senderUserAgent=Vb||""};var qm=function(a,b,c){Gh.call(this,a,b,c)};ja(qm,Gh);var rm=function(a){return a&&a.getAudioTracks()&&0<a.getAudioTracks().length?a.getAudioTracks()[0]:null},sm=function(a){return a&&a.getVideoTracks()&&0<a.getVideoTracks().length?a.getVideoTracks()[0]:null};var tm=D("mr.NetworkUtils"),um=function(a,b){return Ah?new Promise(function(c,e){chrome.networkingPrivate.setWifiTDLSEnabledState(a,b,function(a){chrome.runtime.lastError?(tm.ea("Unable to set TDLS state: state = "+b+", error = "+chrome.runtime.lastError.message),e("Unable to set TDLS state to "+b+".")):(tm.info("TDLS state changed: state = "+b+", status = "+a),c(a))})}):Promise.reject("TDLS feature not enabled.")};var vm={zga:"OFFER",dea:"ANSWER",Rga:"PRESENTATION",jfa:"GET_STATUS",vha:"STATUS_RESPONSE"};var wm=function(a,b){this.sessionId=a;this.seqNum=b;this.type="PRESENTATION"};var xm=function(){this.MB=null;this.SL=[];this.Mp=[];this.aL=this.LP=null},ym=function(){this.details=this.description=this.code=null},zm=function(){this.status=this.Jc=this.error=this.result=this.type=this.seqNum=this.sessionId=null},Am=function(a){var b;try{if("string"!==typeof a)throw SyntaxError("Cannot parse non-string as JSON");b=JSON.parse(a);if(!(b instanceof Object))throw Error("non-Object result from JSON parse");var c=new zm;null!=b.sessionId&&(c.sessionId=String(b.sessionId));if("seqNum"in
b){if("number"!==typeof b.seqNum)throw Error('"seqNum" must be a number');c.seqNum=b.seqNum}if("type"in b){for(var e=String(b.type).toUpperCase(),f=ia(Object.keys(vm)),g=f.next();!g.done;g=f.next())if(vm[g.value]==e){c.type=e;break}if(!c.type)throw Error('not a known message "type"');}"result"in b&&(c.result=String(b.result));if("error"in b){var k=b.error;if(!(k instanceof Object))throw Error('"error" must be a struct');c.error=new ym;if("code"in k){if("number"!==typeof k.code)throw Error('"error.code" must be a number');
c.error.code=k.code}"description"in k&&(c.error.description=String(k.description));if("details"in k){if(!(k.details instanceof Object))throw Error('"error.details" must be a struct');c.error.details=k.details}}if("answer"in b){var p=b.answer;if(!(p instanceof Object))throw Error('"answer" must be a struct');c.Jc=new xm;if("udpPort"in p){if("number"!==typeof p.udpPort)throw Error('"answer.udpPort" must be a number');c.Jc.MB=p.udpPort}e=function(a){return a instanceof Array?a.every(function(a){return"number"===
typeof a}):!1};if("sendIndexes"in p){if(!e(p.sendIndexes))throw Error('"answer.sendIndexes" must be an array of numbers');c.Jc.SL=p.sendIndexes}if("ssrcs"in p){if(!e(p.ssrcs))throw Error('"answer.ssrcs" must be an array of numbers');c.Jc.Mp=p.ssrcs}"IV"in p&&(c.Jc.LP=String(p.IV));"receiverGetStatus"in p&&(c.Jc.aL="true"==String(p.receiverGetStatus).toLowerCase())}"status"in b&&(c.status=b.status);return c}catch(q){b=q instanceof SyntaxError?"JSON parse error: "+q.message:"Type coercion error: "+
q.message}"string"==typeof a?a="a string: "+a:a instanceof ArrayBuffer?(a=new Uint8Array(a),a="an ArrayBuffer whose base64 is "+btoa(String.fromCharCode.apply(null,a))):a="of invalid data type "+typeof a;throw Error(b+". Input was "+a);},Bm=function(a,b,c){this.type="GET_STATUS";this.sessionId=a;this.seqNum=b;this.get_status=c};var Cm=function(a,b){this.address=a;this.port=b},Dm=function(a,b,c){Vg.call(this,b);this.a=D("mr.mirror.cast.Session");this.Wl=a;this.Pa=a.fg().clone();this.bd=rg.Qr(b.id);this.D=b.ze.sessionId;this.$d=new Cm(b.ze.RN,2344);this.zt=b.ze.SN;this.Yc=null;this.ni=!1;this.lc=null;this.ek=!1;this.ci=0;this.wa=this.xq=this.yq=null;this.o5=["H264","VP8"];this.gy=new C;this.lD=null;this.IL=u(this.Q3,this);this.HL=u(this.P3,this);this.ao=null;this.fp=new Zh(30);this.bL=!1;this.$j=c||null;this.FA=new xj("mirror.cast.SeqNumGenerator");
this.ed=this.tf=null;this.dz=0};ja(Dm,Vg);d=Dm.prototype;d.start=function(a){var b=this,c=rm(a);a=sm(a);this.tf=new yg("MediaRouter.CastStreaming.Session.Launch");this.wa=new Vd;this.t0();this.Pa.useTdls&&um(this.$d.address,!0).then(function(a){"Connected"!=a&&(b.Pa.useTdls=!1)},function(){b.Pa.useTdls=!1});chrome.cast.streaming.session.create(c,a,function(a,c,g){b.Yc=a;b.lc=c;b.ci=g;b.bd.onMessage=u(b.ht,b);b.dz=0;b.EA({type:"OFFER",sessionId:b.getId(),seqNum:b.FA.Wr(),offer:b.sn()})});return this.wa.promise};
d.stop=function(){this.ed&&(this.ed.end(),this.ed=null);G(this.a,"Stopping "+this.getId());null!==this.Yc&&(chrome.cast.streaming.rtpStream.stop(this.Yc),chrome.cast.streaming.rtpStream.destroy(this.Yc),this.Yc=null,this.ni=!1);null!==this.lc&&(chrome.cast.streaming.rtpStream.stop(this.lc),chrome.cast.streaming.rtpStream.destroy(this.lc),this.lc=null,this.ek=!1);this.ci&&(chrome.cast.streaming.udpTransport.destroy(this.ci),this.ci=0);this.Pa.useTdls&&um(this.$d.address,!1);this.wa&&(this.wa.resolve(this),
this.wa=null);chrome.cast.streaming.rtpStream.onStarted.removeListener(this.IL);chrome.cast.streaming.rtpStream.onError.removeListener(this.HL);null!==this.ao&&(window.clearTimeout(this.ao),this.ao=null);this.yq=this.xq=null;if(this.$j&&this.$j.onSessionStop)this.$j.onSessionStop(this.$d);return!0};d.f$=function(a){this.ni&&chrome.cast.streaming.rtpStream.toggleLogging(this.Yc,a);this.ek&&chrome.cast.streaming.rtpStream.toggleLogging(this.lc,a)};
d.getLogs=function(){var a=this;if(!this.ni&&!this.ek)return Promise.reject(Error("No streams has been started yet."));var b=[];if(this.ni){var c=om(this.Yc,this.$d.address,this.zt,this.Pa,this.fp.F());b.push(c)}this.ek&&(c=om(this.lc,this.$d.address,this.zt,this.Pa,this.fp.F()),b.push(c));return Promise.all(b).then(function(b){b=new Blob(b,{type:"application/gzip"});G(a.a,"Events blob size: "+b.size);return b})};
d.getStats=function(){var a=[];if(this.ni){var b=pm(this.Yc,this.$d.address,this.zt,this.Pa);a.push(b)}this.ek&&(b=pm(this.lc,this.$d.address,this.zt,this.Pa),a.push(b));this.fp.S()&&a.push(Promise.resolve({receiverStatusData:this.fp.F()}));return Promise.all(a).then(function(a){var b={};a.forEach(function(a){Nb(b,a)});return b})};
d.rT=function(){var a=chrome.cast.streaming.rtpStream.getSupportedParams(this.Yc)[0];a.payload.maxLatency=this.Pa.maxLatencyMillis;a.payload.minLatency=this.Pa.minLatencyMillis;a.payload.animatedLatency=this.Pa.animatedLatencyMillis;a.payload.ssrc=Math.floor(499999*Math.random())+1;a.payload.feedbackSsrc=2;a.payload.payloadType=127;a.payload.aesKey=this.yq;a.payload.aesIvMask=this.xq;return a};
d.FT=function(){var a=this,b=[];if(null===this.lc)return b;var c=chrome.cast.streaming.rtpStream.getSupportedParams(this.lc);this.o5.forEach(function(e){var f=c.find(function(a){return a.payload.codecName.toLowerCase()==e.toLowerCase()});f&&(f.payload.maxFrameRate=a.Pa.maxFrameRate,f.payload.minBitrate=a.Pa.minVideoBitrate,f.payload.maxBitrate=a.Pa.maxVideoBitrate,f.payload.maxLatency=a.Pa.maxLatencyMillis,f.payload.minLatency=a.Pa.minLatencyMillis,f.payload.animatedLatency=a.Pa.animatedLatencyMillis,
f.payload.aesKey=a.yq,f.payload.aesIvMask=a.xq,f.payload.ssrc=Math.floor(499999*Math.random())+500001,f.payload.feedbackSsrc=12,f.payload.payloadType=96,b.push(f))});return b};
d.sn=function(){var a=this,b=0,c=[];if(this.Yc){var e=this.rT();this.lD=e;e={index:b,type:"audio_source",codecName:e.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:e.payload.payloadType,ssrc:e.payload.ssrc,targetDelay:this.Pa.animatedLatencyMillis,aesKey:e.payload.aesKey,aesIvMask:e.payload.aesIvMask,bitRate:128E3,sampleRate:e.payload.clockRate,timeBase:"1/"+e.payload.clockRate,channels:e.payload.channels,rtpExtensions:["adaptive_playout_delay"]};this.Pa.enableLogging&&Nb(e,{receiverRtcpEventLog:!0});
this.Pa.dscpEnabled&&Nb(e,{receiverRtcpDscp:46});c.push(e);b++}this.FT().forEach(function(e){var f={index:b,type:"video_source",codecName:e.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:e.payload.payloadType,ssrc:e.payload.ssrc,targetDelay:a.Pa.animatedLatencyMillis,aesKey:e.payload.aesKey,aesIvMask:e.payload.aesIvMask,maxFrameRate:Math.round(1E3*e.payload.maxFrameRate)+"/1000",timeBase:"1/90000",maxBitRate:e.payload.maxBitrate,resolutions:[{width:a.Pa.maxWidth,height:a.Pa.maxHeight}],
rtpExtensions:["adaptive_playout_delay"]};a.Pa.enableLogging&&Nb(f,{receiverRtcpEventLog:!0});a.Pa.dscpEnabled&&Nb(f,{receiverRtcpDscp:46});c.push(f);a.gy.set(b,e);b++});return{supportedStreams:c}};d.Q3=function(a){a==this.Yc?this.ni=!0:a==this.lc&&(this.ek=!0);this.ni&&(null===this.lc||this.ek)&&(this.f$(this.Pa.enableLogging),this.wa&&(this.wa.resolve(this),this.wa=null));this.ed=new Dg("MediaRouter.CastStreaming.Session.Length")};
d.P3=function(a,b){if(a==this.Yc)F(this.a,"Audio stream error "+b);else if(a==this.lc)F(this.a,"Video stream error "+b);else{F(this.a,"Error for stream "+a+": "+b);return}this.wa&&(this.wa.reject(Error("Error for stream "+a+": "+b)),this.wa=null);this.stop()};
d.eca=function(a,b){H(this.a,"Starting streaming ... "+JSON.stringify({udpTransportId:this.ci,receiverIpEndPoint:this.$d,"audio ID":this.Yc,"video ID":this.lc,"audio params":a,"video params":b}));if(wa(chrome.cast.streaming.udpTransport.Q$)){var c={};this.Pa.dscpEnabled&&(G(this.a,"Enable DSCP in sender."),c.DSCP=!0);chrome.cast.streaming.udpTransport.Q$(this.ci,c)}chrome.cast.streaming.udpTransport.setDestination(this.ci,{address:this.$d.address,port:this.$d.port});chrome.cast.streaming.rtpStream.onStarted.addListener(this.IL);
chrome.cast.streaming.rtpStream.onError.addListener(this.HL);a&&chrome.cast.streaming.rtpStream.start(this.Yc,a);b&&chrome.cast.streaming.rtpStream.start(this.lc,b)};
d.ht=function(a){var b=this;if("urn:x-cast:com.google.cast.webrtc"==a.namespace_){var c,e=null;try{c=Am(a.data)}catch(q){c=new zm,e=q.message}if("ANSWER"==c.type)if("ok"==c.result&&c.Jc){c.Jc.MB&&(this.$d.port=c.Jc.MB);this.bL=!!c.Jc.aL;if(this.$j)this.$j.onAnswer(this.$d);this.tf&&(this.tf.end(),this.tf=null);G(this.a,"Starting streaming");var f=this.lD,g=null;c.Jc.SL.forEach(function(a){f&&0==a?c.Jc.Mp[a]&&(f.payload.feedbackSsrc=c.Jc.Mp[a]):b.gy.ya(a)&&(g?F(b.a,"Receiver selected multiple video stream"):
(g=b.gy.get(a),c.Jc.Mp[a]&&(g.payload.feedbackSsrc=c.Jc.Mp[a])))});null!==this.lc&&null===g&&(F(this.a,"Receiver is capable of video, but did not specify a video stream index in the ANSWER message."),chrome.cast.streaming.rtpStream.destroy(this.lc),this.lc=null);if(f||g)this.dH(),this.eca(f,g),this.wa&&(this.wa.resolve(this),this.wa=null)}else this.wa&&(this.wa.reject(Error("Non-OK answer received: "+JSON.stringify(c))),this.wa=null),this.stop();else if("STATUS_RESPONSE"==c.type&&c.status instanceof
Object){a={};for(var e=ia(Object.keys(c.status)),k=e.next();!k.done;k=e.next()){var k=k.value,p=c.status[k];ua(p)&&p.length?a[k]=p.pop():a[k]=p}e={};e[(new Date).toISOString()]=a;this.fp.add(e)}else e||(e="Ignoring message: "+JSON.stringify(c)),10>this.dz?F(this.a,e):H(this.a,e),++this.dz}};d.t0=function(){this.xq=Nh(window.crypto.getRandomValues(new Uint8Array(16)));this.yq=Nh(window.crypto.getRandomValues(new Uint8Array(16)))};d.VL=function(){this.EA(this.KY())};
d.EA=function(a){this.bd.sendMessage(a,{namespace:"urn:x-cast:com.google.cast.webrtc"})};d.dH=function(){this.ao=null;if(this.ci&&this.bL){var a=new Bm(this.getId(),this.FA.Wr(),["wifiSnr","wifiSpeed","wifiFcsError"]);this.EA(a);this.ao=window.setTimeout(u(this.dH,this),12E4)}};d.KY=function(){var a=new wm(this.D,this.FA.Wr());a.title=this.jA||void 0;a.icons=this.iconUrl&&!this.ys?[new chrome.cast.Image(this.iconUrl)]:[];return a};d.getId=function(){return this.D};d.eg=function(){return this.Wl};
d.L=function(){this.bd.pb();this.stop()};var Em=function(a){Ug.call(this,"cast_streaming",a);this.$j=null};ja(Em,Ug);d=Em.prototype;d.getName=function(){return"cast_streaming"};d.eg=function(a,b,c){return new qm(a,b,c)};d.fr=function(a,b){return new Dm(a,b,this.$j)};d.Et=function(){gm(0)};d.At=function(){gm(1)};d.dA=function(){gm(2)};d.Bt=function(){Gg("MediaRouter.CastStreaming.Session.End")};d.Ct=function(a){Hg("MediaRouter.CastStreaming.Start.Failure",a,Ig)};d.Dt=function(){Gg("MediaRouter.CastStreaming.Stream.End")};
d.rD=function(){var a=this,b=this.Ja,c=b.getLogs().then(function(a){return a},function(b){F(a.m,"Get cast streaming logs failed.",b)}),b=b.getStats().then(function(a){return a},function(b){F(a.m,"Get cast streaming stats failed.",b)}),e=new Promise(function(a){chrome.metricsPrivate.getIsCrashReportingEnabled(a)});return Promise.all([c,b,e]).then(function(b){var c=ia(b);b=c.next().value;var e=c.next().value,c=c.next().value;if(b){var f=new FileReader;f.onloadend=function(){Ji("mr.temp.mirror.cast.Service.mirrorLogs",
f.result)};f.readAsBinaryString(b)}c&&(b&&km.N().zba()?jm(b,void 0,a.x2.bind(a)):e&&im("stats.json",new Blob([JSON.stringify(e)],{type:"application/json"}),void 0,void 0))})};d.x2=function(a){a&&(km.N().to=v())};d.hY=function(a){var b=this;G(this.m,"Received message to upload logs for "+a);return this.Ja?this.Ja.getLogs().then(function(b){return jm(b,a)},function(c){F(b.m,"Get cast streaming logs failed.",c);return b.qJ(a)}):Promise.resolve(this.qJ(a))};
d.qJ=function(a){var b=window.localStorage["mr.temp.mirror.cast.Service.mirrorLogs"];if(!b)return"";window.localStorage.removeItem("mr.temp.mirror.cast.Service.mirrorLogs");G(this.m,"Uploading saved logs for feedback.");for(var c=new Uint8Array(b.length),e=0;e<c.length;e++)c[e]=b.charCodeAt(e);return jm(new Blob([c],{type:"application/gzip"}),a)};var Fm=function(a,b){Vg.call(this,b);this.Wl=a;this.Uo=new Vd;this.o=this.Uo.promise;this.bd=rg.Qr(b.id);this.wa=new Vd;this.my=this.Fb=!1;this.ed=this.tf=null;this.Gp();this.kB();this.Db(new Wg("GET_TURN_CREDENTIALS"))};ja(Fm,Vg);d=Fm.prototype;d.start=function(a){var b=this;return this.o.then(function(c){if(c.Bs())return Promise.reject(new Jg("Mirroring already started"));b.tf=new yg("MediaRouter.WebRtc.Session.Launch");c.addStream(a);c.start();return b.wa.promise})};
d.stop=function(){this.ed&&this.ed.end();this.my=this.Fb=!1;this.tf=this.ed=null;this.o.then(function(a){a.stop()});return!0};d.L=function(){this.bd.pb();this.stop()};
d.Gp=function(){var a=this;this.bd.onMessage=function(b){if(!b.type)throw Error("Message has no type.");switch(b.type){case "TURN_CREDENTIALS":a.Uo.resolve(new bh(a.Ya.id,b.data.credentials));break;case "ANSWER":a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "KNOCK_ANSWER":a.my=!0;a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "STOP":a.wa.reject(new Jg("Stop signal received"));a.stop();break;default:throw new Jg("Unknown message type: "+b.type);}}};
d.kB=function(){var a=this;this.o.then(function(b){b.eN(function(b){b=new Yg(b,a.Wl.fg(),ah);a.Db(new Wg("OFFER",b))});b.dN(function(b){a.Db(Xg(b))});b.cN(function(){a.Fb=!0;a.Db(new Wg("SESSION_START_SUCCESS"));!a.my&&a.tf&&a.tf.end();a.tf=null;a.ed=new Dg("MediaRouter.WebRtc.Session.Length");a.wa.resolve(a)});b.aN(function(){a.Db(new Wg("SESSION_END"))});b.bN(function(b){a.Fb||a.wa.reject(b);a.Db(new Wg("SESSION_FAILURE"))})})};d.Db=function(a){this.bd.sendMessage(a,Gm)};d.eg=function(){return this.Wl};
var Gm={channelType:"cloud"};var Hm=function(a){Ug.call(this,"webrtc",a)};ja(Hm,Ug);d=Hm.prototype;d.eg=function(a,b,c){return new Gh(a,b,c)};d.fr=function(a,b){return new Fm(a,b)};d.Et=function(){$g(0)};d.At=function(){$g(1)};d.dA=function(){$g(2)};d.Bt=function(){Gg("MediaRouter.WebRtc.Session.End")};d.Ct=function(a){Hg("MediaRouter.WebRtc.Start.Failure",a,Ig)};d.Dt=function(){Gg("MediaRouter.WebRtc.Stream.End")};var Im=function(a,b,c,e,f,g){this.EI=a;this.Cd=b;this.Wk=e||null;this.Ll=c||null;this.Pe=f||null;this.Bj=g||null};d=Im.prototype;d.ih=function(){var a="";this.Pe?a=this.Pe:this.Ll&&(a=this.Ll);return a};d.getId=function(){return this.EI+"@"+this.Cd};d.getService=function(){return this.Cd};d.cg=function(){return this.Wk};d.merge=function(a){!this.Bj&&a.Bj&&(this.Bj=a.Bj);!this.Pe&&a.Pe&&(this.Pe=a.Pe);this.Pe&&a.Pe&&this.Bj&&(this.Pe=a.Pe)};var Jm=function(a,b){this.Qg=a;this.Sca=b},Km=new Jm("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),Lm=new Jm("https://www.googleapis.com/calendar/v3",""),Mm=new Jm("https://www.googleapis.com/hangouts/v1",""),Nm=new Jm("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var Om=function(a,b){this.qb=a;this.Zb=b;this.a=D("mr.cloud.calendar.CalendarService")};d=Om.prototype;d.fV=function(){var a=this;return this.nW(this.Zb.Qe,9E5).then(function(b){G(a.a,a.AF(b.length)+" events discovered before filtering.");return a.pX(b)},function(b){F(a.a,"Error getting Hangouts from calendar: "+b);return[]})};d.AF=function(a){return 20<a?"20+":a.toString()};d.nW=function(a,b){var c=this,e=v();return this.PV(a,new Date(e),new Date(e+b)).then(function(a){return a.filter(c.Q0)})};
d.Q0=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};d.PV=function(a,b,c){a=this.qb.Hi(Lm.Qg,["calendars",a,"events"],{timeMin:b.toJSON(),timeMax:c.toJSON(),singleEvents:!0});H(this.a,"Retrieving Hangouts from Calendar: "+a);return this.qb.Ug(a,"GET").then(function(a){return a.items?a.items:[]})};
d.pX=function(a){var b=this;a=a.reduce(function(a,e){if(e.hangoutLink){var c=new Wj(e.hangoutLink),g=b.E4(c.xd);if(2==g.length){var c=g[0],g=g[1],k,p;-1!=c.indexOf(".")&&(k=g,p=c);a.push(new Im(g,c,k,p,e.summary))}else F(b.a,"Invalid hangout link from calendar event: "+e.hangoutLink)}return a},[]);G(this.a,this.AF(a.length)+" events discovered with Hangout links.");return a};d.E4=function(a){return a.substring(12).split("/")};var Pm=function(a,b){this.email=a;this.imageUrl=null!=b?b:null},Qm=function(a){this.type=a},Rm=function(a,b,c){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=null!=b?b:null;this.flungUrl=null!=c?c:null};ja(Rm,Qm);
var Sm=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},Tm={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},Um=new Sm("_knockingStartWebrtcSession",Tm,"viewer"),Vm=new Sm("_startWebrtcSession",Tm),Wm=new Sm("_stopSession",{},"viewer");var Xm=function(a){this.Gb=a;this.id=a.id;this.a=D("mr.cloud.devices.CloudDevice")};d=Xm.prototype;d.isAvailable=function(){if(this.getState().appStatus){var a=this.L0(),b=this.G0(),c=this.ND(864E5);H(this.a,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}a=this.ND(9E5);G(this.a,"Availability for legacy receiver app: "+a);return a};d.ND=function(a){var b=this.AX();return!!(b&&b>v()-a)};d.G0=function(){return"available"==this.getState().appStatus};
d.L0=function(){return"online"==this.Gb.connectionStatus};d.AX=function(){return this.Gb.lastUpdateTimeMs?Number(this.Gb.lastUpdateTimeMs):null};d.ih=function(){return this.getState().settings.receiverName};d.getId=function(){return this.id};d.getState=function(){return this.Gb.state._cloudCast};d.R0=function(){return this.Gb.invitations?0!=this.Gb.invitations.length:!1};var Ym=function(a){this.qb=a;this.Zk=this.Cl=this.dj=null;this.Ds=this.As=!1;this.a=D("mr.cloud.devices.CloudDevicesService");Ci(this)};d=Ym.prototype;d.getDevice=function(a){a=this.qb.Hi(Km.Qg,["devices",a]);return this.qb.Ug(a,"GET").then(function(a){return new Xm(a)})};d.m1=function(){return this.VI({descriptionSubstring:"Chrome Streaming Receiver"})};
d.VI=function(a){var b=this,c=this.qb.Hi(Km.Qg,["devices"],a);return this.qb.Ug(c,"GET").then(function(c){var e=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new Xm(a)});if(c=c.nextPageToken){var g=Jb(a);g.token=c;return b.VI(g).then(function(a){return e.concat(a)})}return e})};d.la=function(){return"CloudDevicesService"};d.getData=function(){return[new Zm(this.dj,this.Zk,this.Cl)]};
d.ib=function(){var a=zi(this);a&&(this.dj=a.i1,this.Zk=a.gcmRegistrationId,this.Cl=a.g1)};d.p6=function(){var a=this;return new Promise(function(b,c){a.As?c(Error("Registering...")):(a.As=!0,a.Zk&&a.Cl&&a.Cl+864E5>=v()?(a.As=!1,b(a.Zk)):chrome.gcm.register(["919648714761"],function(e){a.As=!1;e?(H(a.a,"Got GCM ID: "+e),a.Zk=e,a.Cl=v(),a.dj=null,b(e)):(F(a.a,"Error: "+chrome.runtime.lastError.message),a.Zk=null,a.Cl=null,a.dj=null,c(Error(chrome.runtime.lastError.message)))}))})};
d.Aba=function(){return!this.dj||this.dj+864E5<v()};d.subscribe=function(a){var b=this;if(this.Ds)return Promise.resolve();this.Ds=!0;if(!a||!this.Aba())return Promise.resolve();a={filters:["myDevices"],gcmRegistrationId:a,gcmSenderId:"919648714761",expirationTimeMs:864E5};var c=this.qb.Hi(Km.Qg,["subscriptions","subscribe"],{});return this.qb.Ug(c,"POST",a).then(function(){H(b.a,"Subscribed on: "+v());b.dj=v();b.Ds=!1;return Promise.resolve()},function(a){b.Ds=!1;throw a;})};
var Zm=function(a,b,c){this.i1=a;this.gcmRegistrationId=b;this.g1=c};var $m={ACCEPTED:0,DENIED:1,TIMEOUT:2},an={SUCCESS:0,HP:1},bn={PQ:0,oQ:1,aia:2,tfa:3,sfa:4,aga:5,TIMEOUT:6,Sga:7},cn={qfa:0,wha:1},dn={Bga:0,Vfa:1,Rha:2,lfa:3},en=function(a){Hg("MediaRouter.Cloud.Knock.Result",a,$m)},fn=function(a){Hg("MediaRouter.Cloud.Session.Start",a,an)},gn=function(a){Hg("MediaRouter.Cloud.Session.Type",a,cn)},hn=function(a){Hg("MediaRouter.Cloud.Device.UserRole",a,dn)};var jn=function(a,b,c,e,f,g,k){var p=Mi.N().$k(a);this.bb=new wi(p,b,g,k,f);this.deviceId=a;this.vca=c;this.model=e};jn.prototype.gO=function(a){return ib(this.vca,a)};var kn=function(a,b,c,e,f){jn.call(this,a,b,["cloud"],"Chrome Streaming Receiver",e);this.pv=c;this.isAvailable=f};ja(kn,jn);var ln=function(a){var b=a.getService();a.cg()&&(b=a.cg());var c;a.Ll&&a.ih()!=a.Ll&&(c=a.Ll);jn.call(this,a.getId(),a.ih(),["mesi"],"Hangout",b,"hangout",c);this.wA=a.Bj||""};ja(ln,jn);var mn=function(a,b,c){this.mda=a;this.fd=b;this.Eg=new C;this.pu=new C;this.Bl=null;this.Z1=c};d=mn.prototype;d.Nc=function(){this.wS()&&(this.Bl=v(),this.Fn());return this.Eg.F()};d.Ym=function(a){this.Eg.set(a.bb.id,a)};d.fm=function(a){return this.Eg.remove(a)};d.Z=function(a){return this.Eg.get(a,null)};d.wS=function(){var a=this.Bl+this.Z1;return null==this.Bl||a<v()};d.Fn=function(){var a=this;return this.mda().then(function(b){a.lda(b)})};
d.lda=function(a){var b=new C(this.Eg),c=new C,e=new C,f=[],g=[];a.forEach(function(a){var k=a.bb.id;c.set(k,a);e.set(k,a.deviceId);b.ya(k)?b.ya(k)&&JSON.stringify(b.get(k))!=JSON.stringify(a)&&g.push(a.bb):f.push(a.bb);b.remove(k)});a=b.kb().map(function(a){return b.get(a).bb});this.pu.clear();this.pu=e;this.Eg.clear();this.Eg=c;this.tS(f,g,a)};d.tS=function(a,b,c){0<a.length&&this.fd.uz(a);0<b.length&&this.fd.Rc(b);0<c.length&&this.fd.Ce(c)};
d.b=function(){return new nn(this.Eg.b(),this.pu.b(),this.Bl)};d.$I=function(a){for(var b in a.sinks){var c=a.sinks[b],e=null;"Hangout"==c.model?(e=c.deviceId.split("@"),e=new ln(new Im(e[0],e[1],c.bb.description,c.bb.domain,c.bb.friendlyName,c.wA))):"Chrome Streaming Receiver"==c.model&&(e=new kn(c.deviceId,c.bb.friendlyName,c.pv,c.bb.domain,c.isAvailable));this.Eg.set(b,e)}for(b in a.XD)this.pu.set(b,a.XD[b]);a.GI&&(this.Bl=a.GI)};d.ZA=function(a){this.Bl=a};
var nn=function(a,b,c){this.sinks=a;this.XD=b;this.GI=c};var on=function(a,b,c){this.ow=a;this.fd=b;this.je=new mn(this.Fn.bind(this),b,2E4);c.m9(this);c.K1();Ci(this)};d=on.prototype;d.Nc=function(){var a=this;this.ow.p6().then(function(b){a.ow.subscribe(b)},function(){});return this.je.Nc().filter(function(a){return a.isAvailable})};d.Z=function(a){return this.je.Z(a)};
d.Fn=function(){return this.ow.m1().then(function(a){return a.map(function(a){Gg("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");var b=a.isAvailable()&&!a.R0();return new kn(a.getId(),a.ih(),a.Gb.personalizedInfo.maxRole,"default",b)})})};d.la=function(){return"CloudSinkDiscoveryService"};d.getData=function(){return[{cache:this.je.b()}]};d.ib=function(){var a=zi(this);a&&this.je.$I(a.cache)};d.K2=function(a){a=a.Xja;this.je.Ym(a);this.je.ZA(v());this.fd.uz([a.bb])};
d.P2=function(a){var b=this.je.Z(a.sinkId);b&&(b.isAvailable=a.isAvailable,this.je.ZA(v()),this.fd.Rc([b.bb]))};d.M2=function(a){if(a=this.je.Z(a.sinkId))this.je.fm(a.bb.id),this.je.ZA(v()),this.fd.Ce([a.bb])};var pn=function(a,b){this.input=a;this.domain=b};var qn=function(a,b,c){this.pS=a;this.U1=b;this.ul=new mn(this.Fn.bind(this),c,2E4);this.Do=new C;Ci(this)};qn.prototype.OC=function(a,b){a=new Im(a,b,a,b);this.Do.set(a.getId(),a);return a};qn.prototype.addManualHangout=qn.prototype.OC;qn.prototype.E6=function(a,b){this.Ry(new Im(a,b,a,b))};qn.prototype.removeManualHangout=qn.prototype.E6;d=qn.prototype;d.Nc=function(){return this.ul.Nc()};d.Z=function(a){return this.ul.Z(a)};
d.Fn=function(){var a=this;G(this.a,"Fetching hangouts");return Gl([this.U1.cV(),this.pS.fV()]).then(function(b){var c=a.Do.F().slice();b.forEach(function(b){b.wF?c=c.concat(b.value):E(a.a,"Error discovering Hangouts",b.reason)});var e=c.reduce(function(a,b){var c=a[b.getId()];c?c.merge(b):c=b;a[c.getId()]=c;return a},{});return Object.keys(e).map(function(b){b=e[b];Gg("MediaRouter.Cloud.Hangout.Sink.Discovered");return a.Ry(b)})})};d.Ry=function(a){return new ln(a)};
d.eR=function(a){a=this.OC(a.input,a.domain);a=this.Ry(a);this.ul.Ym(a);return a.bb};d.D6=function(a){return this.Do.remove(a.deviceId)?(this.ul.fm(a.bb.id),!0):!1};d.la=function(){return"HangoutSinkDiscoveryService"};d.getData=function(){return[{cache:this.ul.b(),manualHangouts:this.Do.b()}]};d.ib=function(){var a=zi(this);if(a){this.ul.$I(a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.Do.set(b,new Im(c.EI,c.Cd,c.Ll,c.Wk,c.Pe,c.Bj))}}};d.a=D("mr.cloud.discovery.HangoutSinkDiscoveryService");var rn=function(a){this.Zb=a};d=rn.prototype;d.Hi=function(a,b,c){var e="";b.forEach(function(a){e+="/"+encodeURIComponent(a)});a=new Wj(a+e);c&&(c=gk(c),a.fu(c));return a};d.Ug=function(a,b,c){var e=this;return this.Zb.getAuthToken().then(function(f){var g=e.DV(f);return e.qS(g,a,b,c).catch(function(g){if("INVALID_ACCESS_ERROR"==g)return e.PU(f,a,b,c);throw g;})})};d.PU=function(a,b,c,e){var f=this;return this.Zb.OU(a).then(function(){return f.Ug(b,c,e)})};
d.qS=function(a,b,c,e){var f=this;return new Promise(function(g,k){a.sendRequest(f.lV(b,c,function(a){a&&!a.error?g(a):f.N0(a)?k("INVALID_ACCESS_ERROR"):k(f.A4(a))},e))})};d.N0=function(a){return!!a&&401==a.error.code};d.DV=function(a){a=new ki(void 0,void 0,void 0,!1,!1,a);a.init();return a};d.A4=function(a){return a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a)};d.lV=function(a,b,c,e){a={callback:c,method:b,path:a.toString()};e&&(a.body=e);return a};var sn=function(){this.Df=!1;this.Qe=null;this.Al=!1;this.a=D("mr.cloud.identity.IdentityService");Ci(this);this.o1();this.xN()};d=sn.prototype;d.M0=function(){return"google.com"==this.GH()};d.b1=function(){return this.Al||this.Df&&!!this.Qe&&(-1!=tn.indexOf(this.Qe)||-1!=tn.indexOf(this.GH()))};d.GH=function(){return this.Qe?this.Qe.substr(this.Qe.indexOf("@")+1):""};d.getAuthToken=function(){return this.KF(!0)};
d.KF=function(a){return chrome.identity?new Promise(function(b,c){chrome.identity.getAuthToken({interactive:a},function(a){chrome.runtime.lastError?c(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==a?c(Error("User is not logged in (no token found)")):b(a)})}):Promise.reject(Error("chrome.identity permission required for auth."))};d.OU=function(a){return new Promise(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})};
d.xN=function(){var a=this;this.KF(!1).then(function(b){chrome.identity.getProfileUserInfo(function(c){a.Df=!!c.email||!!c.id;a.Qe=c.email||null;b&&!a.Df&&(a.Al=!0)})},function(b){H(a.a,"Unable to set sign in and email.",b)})};d.o1=function(){var a=this;chrome.identity.onSignInChanged.addListener(function(b,c){a.Df=c;G(a.a,"Signed in change: "+a.Df);a.Df?a.xN():(a.Qe=null,a.Al=!1)})};
d.l6=function(){var a=this;return this.getAuthToken().then(function(b){var c=window.gapi;if(!c)return E(a.a,"gapi not loaded."),!1;G(a.a,"Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};d.la=function(){return"IdentityService"};d.getData=function(){return[null,{signedIn:this.Df,userEmail:this.Qe,kioskAuth:this.Al}]};d.ib=function(){var a=Ai(this);a&&(a.signedIn&&(this.Df=a.signedIn),a.userEmail&&(this.Qe=a.userEmail),a.kioskAuth&&(this.Al=a.kioskAuth))};var tn="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");var un={nC:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},xP:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},vn=un,vn=un;var xn=function(a,b){var c=["0"];b=wn[b][0]&7;if(0<b){c.push(".");for(var e=0;e<b;e++)c.push("0")}return a.replace(/0.00/g,c.join(""))},wn={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,
"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.",
"S/."],PHP:[2,"\u20b1","PHP"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd","RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var yn={qC:".",fv:",",vC:"%",ov:"0",bQ:"+",TP:"-",tC:"E",wC:"\u2030",gv:"\u221e",YP:"NaN",pC:"#,##0.###",wQ:"#E0",aQ:"#,##0%",yP:"\u00a4#,##0.00",BP:"USD"},zn=yn,zn=yn;var An=function(a,b,c){this.po=b||zn.BP;this.KT=c||0;this.Ws=40;this.ye=1;this.Pj=0;this.ij=3;this.at=this.ng=0;this.QN=this.$O=!1;this.Yo=this.tj="";this.Hh="-";this.Pl="";this.Xd=1;this.mj=!1;this.Wi=[];this.Su=this.vE=!1;this.pn=0;this.qD=null;"number"==typeof a?this.zR(a):this.jk(a)};d=An.prototype;d.r$=function(a){if(0<this.Pj&&0<a)throw Error("Can't combine significant digits and minimum fraction digits");this.ng=a;return this};d.h$=function(a){this.ij=a;return this};
d.Laa=function(a){if(0<this.ng&&0<=a)throw Error("Can't combine significant digits and minimum fraction digits");this.Pj=a;return this};d.jk=function(a){a.replace(/ /g,"\u00a0");var b=[0];this.tj=this.nt(a,b);var c=b[0];this.a5(a,b);c=b[0]-c;this.Yo=this.nt(a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.Xd&&(this.mj=!0),this.Hh=this.nt(a,b),b[0]+=c,this.Pl=this.nt(a,b)):(this.Hh=this.tj+this.Hh,this.Pl+=this.Yo)};
d.zR=function(a){switch(a){case 1:this.jk(zn.pC);break;case 2:this.jk(zn.wQ);break;case 3:this.jk(zn.aQ);break;case 4:this.jk(xn(zn.yP,this.po));break;case 5:this.dD(1);break;case 6:this.dD(2);break;default:throw Error("Unsupported pattern type.");}};d.dD=function(a){this.pn=a;this.jk(zn.pC);this.r$(0);this.h$(2);this.Laa(2)};
d.parse=function(a,b){b=b||[0];if(0!=this.pn)throw Error("Parsing of compact numbers is unimplemented");var c;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.tj,b[0])==b[0],f=a.indexOf(this.Hh,b[0])==b[0];e&&f&&(this.tj.length>this.Hh.length?f=!1:this.tj.length<this.Hh.length&&(e=!1));e?b[0]+=this.tj.length:f&&(b[0]+=this.Hh.length);a.indexOf(zn.gv,b[0])==b[0]?(b[0]+=zn.gv.length,c=Infinity):c=this.L4(a,b);if(e){if(a.indexOf(this.Yo,b[0])!=b[0])return NaN;b[0]+=this.Yo.length}else if(f){if(a.indexOf(this.Pl,
b[0])!=b[0])return NaN;b[0]+=this.Pl.length}return f?-c:c};
d.L4=function(a,b){var c=!1,e=!1,f=!1,g=1,k=zn.qC,p=zn.fv,q=zn.tC;if(0!=this.pn)throw Error("Parsing of compact style numbers is not implemented");for(var B="";b[0]<a.length;b[0]++){var O=a.charAt(b[0]),S=this.jG(O);if(0<=S&&9>=S)B+=S,f=!0;else if(O==k.charAt(0)){if(c||e)break;B+=".";c=!0}else if(O==p.charAt(0)&&("\u00a0"!=p.charAt(0)||b[0]+1<a.length&&0<=this.jG(a.charAt(b[0]+1)))){if(c||e)break}else if(O==q.charAt(0)){if(e)break;B+="E";e=!0}else if("+"==O||"-"==O)B+=O;else if(1==this.Xd&&O==zn.vC.charAt(0)){if(1!=
g)break;g=100;if(f){b[0]++;break}}else if(1==this.Xd&&O==zn.wC.charAt(0)){if(1!=g)break;g=1E3;if(f){b[0]++;break}}else break}1!=this.Xd&&(g=this.Xd);return parseFloat(B)/g};d.format=function(a){if(isNaN(a))return zn.YP;var b=[],c=this.RZ(null===this.qD?a:this.qD,a);a/=Math.pow(10,c.Hw);b.push(c.prefix);var e=0>a||0==a&&0>1/a;b.push(e?this.Hh:this.tj);isFinite(a)?(a=a*(e?-1:1)*this.Xd,this.Su?this.sca(a,b):this.DB(a,this.ye,b)):b.push(zn.gv);b.push(e?this.Pl:this.Yo);b.push(c.fO);return b.join("")};
d.DL=function(a){var b=Math.pow(10,this.ij),c=0>=this.Pj?Math.round(a*b):Math.round(this.u7(a*b,this.Pj,this.ij));isFinite(c)?(a=Math.floor(c/b),b=Math.floor(c-a*b)):b=0;return{mI:a,oV:b}};
d.DB=function(a,b,c){if(this.ng>this.ij)throw Error("Min value must be less than max value");c||(c=[]);a=this.DL(a);var e=Math.pow(10,this.ij),f=a.mI,g=a.oV,k=0==f?0:this.xs(f)+1,p=0<this.ng||0<g||this.QN&&k<this.Pj;a=this.ng;p&&(a=this.QN&&0<this.Pj?this.Pj-k:this.ng);for(var q="",k=f;1E20<k;)q="0"+q,k=Math.round(k/10);var q=k+q,B=zn.qC,k=zn.ov.charCodeAt(0),O=q.length,S=0;if(0<f||0<b){for(f=O;f<b;f++)c.push(String.fromCharCode(k));if(2<=this.Wi.length)for(b=1;b<this.Wi.length;b++)S+=this.Wi[b];
b=O-S;if(0<b)for(var f=this.Wi,S=O=0,qa,wc=zn.fv,Bb=q.length,Ic=0;Ic<Bb;Ic++){if(c.push(String.fromCharCode(k+1*Number(q.charAt(Ic)))),1<Bb-Ic)if(qa=f[S],Ic<b){var yB=b-Ic;(1===qa||0<qa&&1===yB%qa)&&c.push(wc)}else S<f.length&&(Ic===b?S+=1:qa===Ic-b-O+1&&(c.push(wc),O+=qa,S+=1))}else{b=q;q=this.Wi;f=zn.fv;qa=b.length;wc=[];for(O=q.length-1;0<=O&&0<qa;O--){S=q[O];for(Bb=0;Bb<S&&0<=qa-Bb-1;Bb++)wc.push(String.fromCharCode(k+1*Number(b.charAt(qa-Bb-1))));qa-=S;0<qa&&wc.push(f)}c.push.apply(c,wc.reverse())}}else p||
c.push(String.fromCharCode(k));(this.vE||p)&&c.push(B);e=""+(g+e);for(g=e.length;"0"==e.charAt(g-1)&&g>a+1;)g--;for(f=1;f<g;f++)c.push(String.fromCharCode(k+1*Number(e.charAt(f))))};d.KC=function(a,b){b.push(zn.tC);0>a?(a=-a,b.push(zn.TP)):this.$O&&b.push(zn.bQ);a=""+a;for(var c=zn.ov,e=a.length;e<this.at;e++)b.push(c);b.push(a)};d.PX=function(a,b){var c=Math.pow(10,b);if(isFinite(c)&&0!==c)return a/c;c=Math.pow(10,Math.floor(b/2));a=a/c/c;1==b%2&&(a=0<b?a/10:10*a);return a};
d.sca=function(a,b){if(0==a)this.DB(a,this.ye,b),this.KC(0,b);else{var c=Math.floor(Math.log(a)/Math.log(10)+2E-15);a=this.PX(a,c);var e=this.ye;if(1<this.Ws&&this.Ws>this.ye){for(;0!=c%this.Ws;)a*=10,c--;e=1}else 1>this.ye?(c++,a/=10):(c-=this.ye-1,a*=Math.pow(10,this.ye-1));this.DB(a,e,b);this.KC(c,b)}};d.jG=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=zn.ov.charCodeAt(0);return b<=a&&a<b+10?a-b:-1};
d.nt=function(a,b){for(var c="",e=!1,f=a.length;b[0]<f;b[0]++){var g=a.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==a.charAt(b[0]+1)?(b[0]++,c+="'"):e=!e;else if(e)c+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return c;case "\u00a4":if(b[0]+1<f&&"\u00a4"==a.charAt(b[0]+1))b[0]++,c+=this.po;else switch(this.KT){case 0:c+=wn[this.po][1];break;case 2:var g=this.po,k=wn[g],c=c+(g==k[1]?g:g+" "+k[1]);break;case 1:c+=wn[this.po][2]}break;case "%":if(!this.mj&&1!=this.Xd)throw Error("Too many percent/permill");
if(this.mj&&100!=this.Xd)throw Error("Inconsistent use of percent/permill characters");this.Xd=100;this.mj=!1;c+=zn.vC;break;case "\u2030":if(!this.mj&&1!=this.Xd)throw Error("Too many percent/permill");if(this.mj&&1E3!=this.Xd)throw Error("Inconsistent use of percent/permill characters");this.Xd=1E3;this.mj=!1;c+=zn.wC;break;default:c+=g}}return c};
d.a5=function(a,b){for(var c=-1,e=0,f=0,g=0,k=-1,p=a.length,q=!0;b[0]<p&&q;b[0]++)switch(a.charAt(b[0])){case "#":0<f?g++:e++;0<=k&&0>c&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>c&&k++;break;case ",":0<k&&this.Wi.push(k);k=0;break;case ".":if(0<=c)throw Error('Multiple decimal separators in pattern "'+a+'"');c=e+f+g;break;case "E":if(this.Su)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.Su=!0;this.at=0;b[0]+1<p&&"+"==a.charAt(b[0]+
1)&&(b[0]++,this.$O=!0);for(;b[0]+1<p&&"0"==a.charAt(b[0]+1);)b[0]++,this.at++;if(1>e+f||1>this.at)throw Error('Malformed exponential pattern "'+a+'"');q=!1;break;default:b[0]--,q=!1}0==f&&0<e&&0<=c&&(f=c,0==f&&f++,g=e-f,e=f-1,f=1);if(0>c&&0<g||0<=c&&(c<e||c>e+f)||0==k)throw Error('Malformed pattern "'+a+'"');a=e+f+g;this.ij=0<=c?a-c:0;0<=c&&(this.ng=e+f-c,0>this.ng&&(this.ng=0));this.ye=(0<=c?c:a)-e;this.Su&&(this.Ws=e+this.ye,0==this.ij&&0==this.ye&&(this.ye=1));this.Wi.push(Math.max(0,k));this.vE=
0==c||c==a};var Bn={prefix:"",fO:"",Hw:0};An.prototype.CH=function(a,b){var c=1==this.pn?vn.nC:vn.xP;null==c&&(c=vn.nC);if(3>a)return Bn;a=Math.min(14,a);var e=c[Math.pow(10,a)];for(--a;!e&&3<=a;)e=c[Math.pow(10,a)],a--;if(!e)return Bn;b=e[b];return b&&"0"!=b?(b=/([^0]*)(0+)(.*)/.exec(b))?{prefix:b[1],fO:b[3],Hw:a+1-(b[2].length-1)}:Bn:Bn};
An.prototype.RZ=function(a){if(0==this.pn)return Bn;a=Math.abs(a);var b=this.CH(1>=a?0:this.xs(a),"other").Hw;return this.CH(b+this.xs(this.DL(a/Math.pow(10,b)).mI),"other")};An.prototype.xs=function(a){for(var b=0;1<=(a/=10);)b++;return b};An.prototype.u7=function(a,b,c){if(!a)return a;b=b-this.xs(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};var Cn=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},Dn=Cn,Dn=Cn;var En=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},Fn=En,Fn=En;var Gn=function(a){this.El=[];this.Fz=[];this.ez=new An(1);this.N4(a)},Hn=/'([{}#].*?)'/g,In=/''/g;d=Gn.prototype;d.format=function(a){return this.Dr(a,!1)};d.Dr=function(a,b){if(0==this.Fz.length)return"";var c=[];this.Yw(this.Fz,a,b,c);for(a=c.join("");0<this.El.length;)a=a.replace(this.Rv(this.El),this.El.pop());return a};
d.Yw=function(a,b,c,e){for(var f=0;f<a.length;f++)switch(a[f].type){case 4:e.push(a[f].value);break;case 3:var g=a[f].value;this.nV(g,b,e);break;case 2:g=a[f].value;this.mV(g,b,c,e);break;case 0:g=a[f].value;this.uF(g,b,Fn,c,e);break;case 1:g=a[f].value;this.uF(g,b,Dn,c,e);break;default:Ya("Unrecognized block type: "+a[f].type)}};d.nV=function(a,b,c){b=b[a];l(b)?(this.El.push(b),c.push(this.Rv(this.El))):c.push("Undefined parameter - "+a)};
d.mV=function(a,b,c,e){var f=a.Dq;l(b[f])?(f=a[b[f]],l(f)||(f=a.other),this.Yw(f,b,c,e)):e.push("Undefined parameter - "+f)};d.uF=function(a,b,c,e,f){var g=a.Dq,k=a.fD,p=+b[g];isNaN(p)?f.push("Undefined or invalid parameter - "+g):(k=p-k,g=a[b[g]],l(g)||(c=this.ez.fY?c(k,this.ez.fY()):c(k),g=a[c],l(g)||(g=a.other)),a=[],this.Yw(g,b,e,a),b=a.join(""),e?f.push(b):(e=this.ez.format(k),f.push(b.replace(/#/g,e))))};d.N4=function(a){a&&(a=this.A0(a),this.Fz=this.ot(a))};
d.A0=function(a){var b=this.El,c=u(this.Rv,this);a=a.replace(In,function(){b.push("'");return c(b)});return a=a.replace(Hn,function(a,f){b.push(f);return c(b)})};d.ur=function(a){var b=0,c=[],e=[],f=/[{}]/g;f.lastIndex=0;for(var g;g=f.exec(a);){var k=g.index;"}"==g[0]?(c.pop(),0==c.length&&(g={type:1},g.value=a.substring(b,k),e.push(g),b=k+1)):(0==c.length&&(b=a.substring(b,k),""!=b&&e.push({type:0,value:b}),b=k+1),c.push("{"))}b=a.substring(b);""!=b&&e.push({type:0,value:b});return e};
var Jn=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Kn=/^\s*(\w+)\s*,\s*selectordinal\s*,/,Ln=/^\s*(\w+)\s*,\s*select\s*,/;d=Gn.prototype;d.k4=function(a){return Jn.test(a)?0:Kn.test(a)?1:Ln.test(a)?2:/^\s*\w+\s*/.test(a)?3:5};
d.ot=function(a){var b=[];a=this.ur(a);for(var c=0;c<a.length;c++){var e={};if(0==a[c].type)e.type=4,e.value=a[c].value;else if(1==a[c].type)switch(this.k4(a[c].value)){case 2:e.type=2;e.value=this.S4(a[c].value);break;case 0:e.type=0;e.value=this.O4(a[c].value);break;case 1:e.type=1;e.value=this.M4(a[c].value);break;case 3:e.type=3;e.value=a[c].value;break;default:Ya("Unknown block type for pattern: "+a[c].value)}else Ya("Unknown part of the pattern.");b.push(e)}return b};
d.S4=function(a){var b="";a=a.replace(Ln,function(a,c){b=c;return""});var c={};c.Dq=b;a=this.ur(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.ot(a[e].value);else Ya("Expected block type.");c[f.replace(/\s/g,"")]=g;e++}return c};
d.O4=function(a){var b="",c=0;a=a.replace(Jn,function(a,e,f){b=e;f&&(c=parseInt(f,10));return""});var e={};e.Dq=b;e.fD=c;a=this.ur(a);for(var f=0;f<a.length;){var g=a[f].value;f++;if(1==a[f].type)var k=this.ot(a[f].value);else Ya("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e};
d.M4=function(a){var b="";a=a.replace(Kn,function(a,c){b=c;return""});var c={};c.Dq=b;c.fD=0;a=this.ur(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.ot(a[e].value);else Ya("Expected block type.");c[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return c};d.Rv=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var Mn=chrome.i18n.getMessage("1522140683318860351"),Nn=chrome.i18n.getMessage("4246483347873264186"),On=chrome.i18n.getMessage("5991427458288444010"),Pn=chrome.i18n.getMessage("6063910461797960050"),Qn=chrome.i18n.getMessage("7735695102441495789"),Rn=chrome.i18n.getMessage("4575332923598659024"),Sn=chrome.i18n.getMessage("2297080986956220930"),Tn=new Gn(Sn),Un=function(a,b){return Tn.format({ORGANIZER:a,PARTICIPANTS:b})};var Vn=function(a){this.qb=a;this.a=D("mr.cloud.mesi.MesiService")};
Vn.prototype.cV=function(){var a=Mm.Qg;.1>Math.random()&&(a=a.replace("v1","v1_preprod"));a=this.qb.Hi(a,["hangouts","search"]);G(this.a,"Retrieving Hangouts from MESI: "+a);return this.qb.Ug(a,"POST",Wn).then(function(a){var b=[];a.result&&(b=a.result.map(function(a){var b=a.hangout,c,e;b.external_key?(c=b.external_key.value.replace(/@.*/,""),e=b.external_key.service):b.sharing_url&&(e=b.sharing_url.split("/"),c=e[4],e=e[3]);var p=b.meeting_room_name,q;b.meeting_domain?(q=b.meeting_domain,p&&(c=
p,e=q)):"BUSINESS"==b.type&&b.company_title&&(q=b.company_title.toLowerCase());var B=Un("",0);if((a=a.participant)&&0<a.length){var O=a[0].display_name;a=a.reduce(function(a,b){a.add(b.user_id);"ORGANIZER"==b.role&&(O=b.display_name);return a},new Mc);B=Un(O,a.S())}return new Im(c,e,p,q,B,b.hangout_id)}));return b})};var Wn={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};var Xn=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},Yn=function(a){this.qb=a};d=Yn.prototype;d.U7=function(a,b,c){var e=this;return this.WL(Um,a,b,c,35E3).then(function(a){return e.PH(a)})};d.W7=function(a,b,c){var e=this;return this.WL(Vm,a,b,c,23E3).then(function(a){var b=a.state;return"done"==b?(a=e.AK(a),new Xn(b,a.type,new Rm(a.sessionDescription))):new Xn(b)})};d.b8=function(a){return this.zf(a,Wm,{})};
d.WL=function(a,b,c,e,f){var g={_webrtcMessage:JSON.stringify(c.presentationUrl?new Rm(c.description,null,c.presentationUrl):new Rm(c.description))};c.settings&&(g._settings=c.settings.IB());c.mediaConstraints&&(g._optMediaConstraints=JSON.stringify(c.mediaConstraints));e&&(g._user=JSON.stringify(e));return this.zf(b,a,g,f)};
d.PH=function(a){var b=this,c=a.state;switch(c){case "done":return Promise.resolve(this.w4(a));case "queued":case "inProgress":return this.Ada(a).then(function(a){return b.PH(a)});default:return Promise.resolve(new Xn(c))}};d.Ada=function(a){var b=this;return new Promise(function(c){var e=setInterval(function(){b.UU(a.id).then(function(a){"queued"!=a.state&&"inProgress"!=a.state&&(clearInterval(e),c(a))})},2E3)})};
d.w4=function(a){a=this.AK(a);return"__cloud_webrtc_session_message__"==a.type?new Xn("done","knocking_cloud_webrtc_session_message",new Rm(a.sessionDescription)):new Xn("done",a.type)};d.zf=function(a,b,c,e){a={deviceId:a,name:"_cloudCast."+b.name,parameters:c,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=this.qb.Hi(Km.Qg,["commands"],b);return this.qb.Ug(e,"POST",a)};d.AK=function(a){return a.results&&a.results.results?JSON.parse(a.results.results):null};
d.UU=function(a){a=this.qb.Hi(Km.Qg,["commands",a]);return this.qb.Ug(a,"GET")};Yn.$inject=["gapiService"];var Zn=function(a,b,c,e){this.bg=a;this.Zb=b;this.Xp=c;this.Qb=e};d=Zn.prototype;d.E_=function(a,b,c){var e=this;return this.P7(a,b,c).then(function(a){return e.o_(a,b.id)})};d.w_=function(a){var b=this;return this.Xp.lW().then(function(c){b.Qb.Ad(new Wg("TURN_CREDENTIALS",{credentials:c}),a.id)})};
d.P7=function(a,b,c){b=c.deviceId;var e=this.Zb.Qe,e=e?new Pm(e):void 0;a=a.data;switch(c.pv){case "owner":hn(0);break;case "manager":hn(1);break;case "user":hn(2);break;case "viewer":hn(3)}return"viewer"==c.pv?this.bg.U7(b,a,e):this.bg.W7(b,a,e)};
d.o_=function(a,b){if("done"!=a.state)return Promise.reject(Error("Offer not executed by receiver. State: "+a.state));switch(a.type){case "__cloud_webrtc_session_message__":a=new Wg("ANSWER",a.results.sessionDescription);this.Qb.Ad(a,b);break;case "knocking_cloud_webrtc_session_message":en(0);a=new Wg("KNOCK_ANSWER",a.results.sessionDescription);this.Qb.Ad(a,b);break;case "knock_denied":en(1);this.OH(Nn,b);break;case "knock_timeout":en(2);this.OH(On,b);break;default:return Promise.reject(Error("Invalid message type: "+
a.type))}return Promise.resolve()};d.OH=function(a,b){a=new sg(a,"warning","dismiss");a.S9(!0);this.Qb.dg().send(a);this.Qb.Ad(new Wg("STOP"),b)};var $n=function(){this.Ok=null;this.a=D("mr.cloud.messaging.CloudMessageListener");this.Mz=[]};d=$n.prototype;d.m9=function(a){this.Ok=a};d.onMessage=function(a){this.Ok?this.OK(a):(H(this.a,"[pending] "+a.data.notification),this.Mz.push(a))};d.K1=function(){var a=this;this.Ok&&(this.Mz.forEach(function(b){a.OK(b)}),this.Mz=[])};
d.OK=function(a){var b=this;if(a.data.notification&&(H(this.a,"[processing] "+a.data.notification),(a=JSON.parse(a.data.notification))&&a.events)){var c=Mi.N();a.events.forEach(function(a){var e=c.$k(a.deviceId);switch(a.type){case "deviceCreated":b.L2(a,e);break;case "deviceUpdated":b.Q2(a,e);break;case "deviceDeleted":b.N2(a,e);break;default:H(b.a,"[unhandled event] "+JSON.stringify(a))}})}};
d.L2=function(a,b){a=new kn(a.deviceId,a.statePatch._cloudCast.settings.receiverName,"owner","default",!0);this.Ok.K2({sinkId:b,cloudSink:a})};d.Q2=function(a,b){a.statePatch._cloudCast&&a.statePatch._cloudCast.appStatus&&this.Ok.P2({sinkId:b,isAvailable:"available"==a.statePatch._cloudCast.appStatus})};d.N2=function(a,b){this.Ok.M2({sinkId:b})};var ao=function(a,b){this.Zb=a;this.Qb=b};
ao.prototype.B_=function(a,b,c){var e=this,f,g;switch(a.type){case "REFRESH_AUTH":return f=c.deviceId,g=c.wA,this.Zb.l6().then(function(){e.Qb.Ad(new Wg("AUTH_READY",{hangoutId:f,resolvedId:g}),b.id)});case "LOCAL_PRESENT":return f=c.deviceId,g=c.wA,this.Qb.Ad(new Wg("AUTH_READY",{hangoutId:f,resolvedId:g,conferenceMode:!a.data.local}),b.id),Promise.resolve();case "STATUS_REQUEST":return this.Qb.Ad(a,b.id),Promise.resolve();case "STATUS_RESPONSE":return this.Qb.Ad(a,b.id,!0),a.data.routeDescription||
this.Qb.Ad(a,b.id),Promise.resolve();case "HANGOUT_INACTIVE":return this.Qb.Zj(b,4,new sg(Qn,"warning","dismiss"));case "HANGOUT_INVALID":return this.Qb.Zj(b,3,new sg(Rn,"warning","dismiss"));default:return Promise.reject(Error("Unknown type: "+a.type))}};var bo=function(a,b,c){this.zk=a;this.no=b;this.Qb=c};
bo.prototype.x5=function(a,b,c,e){var f=this;return new Promise(function(g){switch(a){case "cloud":case "mesi":break;default:throw Error("Unrecognized channel type");}if(!b.type)throw Error("Message has no type");switch(b.type){case "STOP":g(f.Qb.Zj(c,1,null));return;case "SESSION_START_SUCCESS":fn(0);break;case "SESSION_END":break;case "SESSION_FAILURE":fn(1);g(f.Qb.Zj(c,2,new sg(Mn,"warning","dismiss")));return;case "__webrtc_stats__":break;case "PRESENTATION_CONNECTION_MESSAGE":f.Qb.Ad(b.data,
c.id,!0);break;case "OFFER":g(f.zk.E_(b,c,e));return;case "GET_TURN_CREDENTIALS":g(f.zk.w_(c));return;case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":g(f.no.B_(b,c,e));return;case "new_session":f.Qb.Ad(b,c.id,!0);break;case "remove_session":f.Qb.Ad(b,c.id,!0);f.Qb.hd(c.id);break;default:throw Error("Unknown type: "+b.type);}g()})};var co=function(){var a=this;this.a=D("mr.cloud.settings.SettingsService");this.iz=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(b){if(a.iz){b=ia(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,"media_router.cloudservices.enabled"==c.key){a.iz.call(null,c.value);break}}})};d=co.prototype;d.L$=function(a){this.iz=a};d.Rca=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&F(a,"Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})};
d.hW=function(){var a=this;return this.YF().catch(function(){return a.YF().catch(function(b){F(a.a,"Error retrieving cloud on setting: "+JSON.stringify(b));return!1})})};d.YF=function(){return this.yG("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})};d.yG=function(a){return new Promise(function(b,c){chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?c(chrome.runtime.lastError):b(a)})})};
d.fW=function(){var a=this;return this.WF().catch(function(){return a.WF().catch(function(b){F(a.a,"Error retrieving cloud enabled setting: "+JSON.stringify(b));return!1})})};d.WF=function(){return this.IY("media_router.cloudservices.enabled").then(function(a){return!!a.value})};d.IY=function(a){return new Promise(function(b,c){chrome.settingsPrivate.getPref(a,function(a){chrome.runtime.lastError?c(chrome.runtime.lastError):b(a)})})};
d.J$=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&F(a,"Error setting notified Hangout privacy: "+JSON.stringify(chrome.runtime.lastError))})};d.uY=function(){var a=this;return this.TG().catch(function(){return a.TG().catch(function(b){F(a.a,"Error retrieving hangouts notified setting: "+JSON.stringify(b));return!1})})};d.TG=function(){return this.yG("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var eo=function(a){this.a=D("mr.cloud.CredentialService");this.qb=a};eo.prototype.lW=function(){var a=this,b=new Vd,c=Nm.Qg+"/iceconfig?key="+Nm.Sca;G(this.a,"Requesting TURN credentials from "+c);var e=vf(c,function(){return a.c4(e,b)},"POST",void 0,{"Content-Type":"application/json"});return b.promise};eo.prototype.c4=function(a,b){a.Vd()?(G(this.a,"Got TURN credentials: "+a.Qi()),b.resolve(this.V2(a.cZ()))):b.resolve(this.W2(null))};
eo.prototype.V2=function(a){try{var b=[];a.iceServers.forEach(function(a){a.urls.forEach(function(c){0==c.indexOf("turn:")&&b.push({url:c,credential:a.credential,username:a.username})})});return b}catch(c){return E(this.a,"Error parsing TURN credentials.",c),[]}};eo.prototype.W2=function(a){E(this.a,"XHR failed fetching TURN credentials.",a instanceof Error?a:void 0);return[]};var fo=function(){this.ax=this.Xp=this.Je=this.Ml=this.no=this.zk=this.bg=this.Yx=this.Wv=this.Yy=this.pw=this.nw=this.qb=this.Hv=null};d=fo.prototype;d.hl=function(){null==this.Hv&&(this.Hv=new sn);return this.Hv};d.Rn=function(){null==this.qb&&(this.qb=new rn(this.hl()));return this.qb};d.eW=function(){null==this.nw&&(this.nw=new Ym(this.Rn()));return this.nw};d.XF=function(){this.ax||(this.ax=new $n);return this.ax};d.iW=function(a){null==this.pw&&(this.pw=new on(this.eW(),a,this.XF()));return this.pw};
d.cY=function(){null==this.Yy&&(this.Yy=new Vn(this.Rn()));return this.Yy};d.QV=function(){null==this.Wv&&(this.Wv=new Om(this.Rn(),this.hl()));return this.Wv};d.oX=function(a){null==this.Yx&&(this.Yx=new qn(this.QV(),this.cY(),a));return this.Yx};d.pG=function(){null==this.bg&&(this.bg=new Yn(this.Rn()));return this.bg};d.gW=function(a){null==this.zk&&(this.zk=new Zn(this.pG(),this.hl(),this.OZ(),a));return this.zk};d.hX=function(a){null==this.no&&(this.no=new ao(this.hl(),a));return this.no};
d.dY=function(a){null==this.Ml&&(this.Ml=new bo(this.gW(a),this.hX(a),a));return this.Ml};d.tZ=function(){null==this.Je&&(this.Je=new co);return this.Je};d.OZ=function(){null==this.Xp&&(this.Xp=new eo(this.Rn()));return this.Xp};ra(fo);var go=function(a,b,c){I.call(this);this.Ch=null!=c?u(a,c):a;this.ud=b;this.oi=u(this.wz,this);this.li=[]};w(go,I);d=go.prototype;d.Ke=!1;d.Ee=0;d.xa=null;d.Gn=function(a){this.li=arguments;this.xa||this.Ee?this.Ke=!0:this.Uk()};d.stop=function(){this.xa&&(gf(this.xa),this.xa=null,this.Ke=!1,this.li=[])};d.pause=function(){this.Ee++};d.resume=function(){this.Ee--;this.Ee||!this.Ke||this.xa||(this.Ke=!1,this.Uk())};d.L=function(){go.U.L.call(this);this.stop()};
d.wz=function(){this.xa=null;this.Ke&&!this.Ee&&(this.Ke=!1,this.Uk())};d.Uk=function(){this.xa=ff(this.oi,this.ud);this.Ch.apply(null,this.li)};var ho=function(){this.hc=null;this.a=D("mr.IssueSenderImpl")};ho.prototype.init=function(a){this.hc=a};ho.prototype.send=function(a){if(this.hc)if(this.hc.onIssue)this.hc.onIssue(a);else E(this.a,"MediaRouterService.onIssue not defined.");else E(this.a,"MediaRouterService is not set.")};var io=new Set;var jo=function(a,b){J.call(this,"internal_message");this.routeId=a;this.message=b};ja(jo,J);var ko=function(a,b,c){I.call(this);this.EL=a;this.zf=b;this.V1=c;this.onMessage=pa;c.listen("internal_message",this.ht,!1,this)};ja(ko,I);ko.prototype.sendMessage=function(a,b){return this.zf(this.EL,a,b)};ko.prototype.ht=function(a){if(a.routeId==this.EL)this.onMessage(a.message)};ko.prototype.L=function(){this.V1.jd("internal_message",this.ht,!1,this)};var lo=new ko("",function(){return Promise.resolve()},new K),mo=function(a){this.w=a};
mo.prototype.Qr=function(a){var b=this.w.Gx(a);return b?new ko(a,u(b.Zh,b),this.w.Kx()):lo};var no=function(){this.a=D("mr.ProviderManager");this.Zd=[];this.ae=new Map;this.hm=new Map;this.Dg=new Set;this.Ej=new Set;this.lj=new Map;this.hc=null;this.um=!1;this.FL=new K;this.GL=new go(this.Z7,500,this);this.Jba=new go(this.LU,500,this);this.Ko=new dm(this,524288);this.Nz=0;this.CI=new ho;this.vm=new Map;this.$s=-1==window.navigator.userAgent.indexOf("Windows");this.Zs=[];this.Gs=[];this.createRoute=this.Ye;this.joinRoute=this.bj;this.connectRouteByRouteId=this.vi;this.terminateRoute=this.hd;
this.startObservingMediaSinks=this.Tj;this.stopObservingMediaSinks=this.Wj;this.sendRouteMessage=this.Zh;this.sendRouteBinaryMessage=this.Y7;this.startListeningForRouteMessages=this.Xba;this.stopListeningForRouteMessages=this.AB;this.startObservingMediaRoutes=this.Sj;this.stopObservingMediaRoutes=this.Vj;this.onPresentationSessionDetached=this.detachRoute=this.eh;this.enableMdnsDiscovery=this.RE;this.searchSinksAndCreateRoute=this.K7;this.searchSinks=this.yg;this.updateMediaSinks=this.eda};d=no.prototype;
d.gY=function(a){return this.lj.get(a).Fl()};d.m6=function(a){a.forEach(this.q6,this)};d.Ud=function(a,b){this.lj.set("webrtc",new dh(new Hm(this)));this.lj.set("cast_streaming",new dh(new Em(this)));var c=zh.N();c.s$(this);c.O9(fo.N().hl());this.lj.set("hangouts",c);c=new mo(this);rg||(rg=c);this.hc=a;this.CI.init(a);this.Ko.init(this.hc.onRouteMessagesReceived.bind(this.hc));this.m6(b);Ci(this)};
d.q6=function(a){if(this.Yr(a.getName()))F(this.a,"Provider "+a.getName()+" already registered.");else try{a.Ud(),this.Zd.push(a),this.vm.set(a.getName(),0)}catch(b){F(this.a,"Provider "+a.getName()+" failed to initialize.",b)}};
d.uq=function(a,b){var c=this;return new Promise(function(e,f){var g=null;c.t5();var g=window.setTimeout(function(){g=null;a.cancel(new Jk(2,"timeout after "+b+" ms."))},b),k=function(){c.sR();null!=g&&window.clearTimeout(g)};a.promise.then(function(a){k();e(a)},function(a){k();f(a instanceof Jk?a:a instanceof Error?new Jk(0,a.message,a.stack):new Jk(0))})})};d.cR=function(a,b){return this.uq(wg(a),b)};d.t5=function(){this.Nz++;this.Uy()};d.sR=function(){this.Nz--;this.Uy()};
d.Ye=function(a,b,c,e,f,g,k){var p=this,q=this.NY(a,b);if(!q)return Promise.reject(new Jk(7,"No provider supports createRoute with source: "+a+" and sink: "+b));io.add(b);this.Rc();g=g&&0<g?g:6E4;a=q.Ye(a,b,c,k||!1,g,e,f);return this.uq(a,g).then(function(a){io.delete(b);p.Rc();return a},function(a){E(p.a,"Error creating route.",a);io.delete(b);p.Rc();throw a;})};
d.vi=function(a,b,c,e,f,g){var k=this.ae.get(b);if(!k)return Promise.reject(new Jk(7,"No provider supports join "+b));a=k.vi(a,b,c,e,f);return this.uq(a,g&&0<g?g:3E4)};d.bj=function(a,b,c,e,f,g){var k=this.MY(a);if(!k)return Promise.reject(new Jk(7,"No provider supports join "+b));f=f&&0<f?f:3E4;a=k.bj(a,b,g||!1,f,c,e);return this.uq(a,f)};d.hd=function(a){var b=this.ae.get(a);return b?this.oJ(a).then(function(){b.hd(a)}):Promise.reject(new Jk(3,"Route not found for routeId "+a))};
d.Tj=function(a){this.Dg.has(a)||(this.Dg.add(a),this.Zd.forEach(function(b){b.Tj(a)}));this.Zz(a)};d.Wj=function(a){this.Dg.delete(a)?this.ME(a):G(this.a,"No existing query "+a)};d.ME=function(a){this.Zd.forEach(function(b){b.Wj(a)})};
d.Zz=function(a){var b=this;if("urn:x-org.chromium.media:source:tab:-1"==a)F(this.a,"No sinks for sourceUrn: "+a);else{var c=new Map,e=[];this.Zd.forEach(function(f){var g=f.Jn(a);0<g.sinks.length&&(e=g.origins);g.sinks.forEach(function(a){c.has(a.id)?F(b.a,"Detected duplicate sink "+a.id+" from provider: "+f.getName()):c.set(a.id,a)})});this.a8(a,Array.from(c.values()),e||[])}};d.a8=function(a,b,c){G(this.a,"Sending "+b.length+" sinks to MR for "+a);oo(b);this.hc.onSinksReceived(a,b,c)};
var oo=function(a){a.forEach(function(a){a.isLaunching_=io.has(a.id)})};d=no.prototype;d.Zh=function(a,b,c){var e=this.ae.get(a);return e?this.cR(e.Zh(a,b,c),3E4):Promise.reject(Error("Invalid route ID "+a))};d.Y7=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data"))};d.Xba=function(a){this.Ko.n1(a)};d.AB=function(a){this.Ko.AB(a)};d.eh=function(a){var b=this.ae.get(a);b?b.eh(a):G(this.a,"Route "+a+" does not exist.")};
d.RE=function(){this.$s=!0;this.Zs.forEach(function(a){a()});this.Zs.length=0};d.NY=function(a,b){return this.Zd.find(function(c){return c.hn(a,b)})||null};d.MY=function(a){return this.Zd.find(function(b){return b.tk(a)})||null};d.LU=function(){var a=this;this.Dg.forEach(function(b){a.Zz(b)})};d.Uy=function(){this.hc.setKeepAlive(0<this.Nz||0<this.Gs.length)};d.Sj=function(a){this.Ej.has(a)||(this.um=!0,this.Ej.add(a),this.Zd.forEach(function(b){b.Sj(a)}));this.GL.Gn()};
d.Vj=function(a){this.Ej.delete(a)?(0==this.Ej.size&&(this.um=!1),this.Zd.forEach(function(b){b.Vj(a)})):G(this.a,"No existing route query "+a)};d.Z7=function(){var a=this;if(this.um){var b=[];this.Zd.forEach(function(a){b=b.concat(a.ig())});this.Ej.forEach(function(c){var e=[];a.Zd.forEach(function(a){a.ig().forEach(function(b){!b.Ik&&a.tk(c,b)&&e.push(b.id)})});a.hc.onRoutesUpdated(b,c,e)})}};d.la=function(){return"ProviderManager"};
d.getData=function(){return[new po(this.Zd.map(function(a){return a.getName()}),Array.from(this.Dg),Array.from(this.Ej),this.um,Array.from(this.ae,function(a){var b=ia(a);a=b.next().value;b=b.next().value;return[a,b.getName()]}),Array.from(this.vm),this.$s)]};
d.ib=function(){var a=zi(this);if(a){this.Dg=new Set(a.Iba);this.Ej=new Set(a.y7);this.um=a.Dba;for(var b=ia(a.w7),c=b.next();!c.done;c=b.next()){var e=ia(c.value),c=e.next().value,e=e.next().value,e=this.Yr(e);this.ae.set(c,e)}this.vm=new Map(a.Hba);a.O1&&this.RE()}};d.Gx=function(a){return this.ae.get(a)};d.Ul=function(a,b){this.ae.set(b.id,a);this.Jh(a,b)};d.oj=function(a,b){this.oJ(b.id);this.ae.delete(b.id);this.Ko.oj(b.id);this.Jh(a,b)};d.Jh=function(){this.um&&this.GL.Gn()};
d.$J=function(a){var b=this.ae.get(a.id);b&&this.Jh(b,a)};d.Be=function(a,b,c){this.ae.has(b)?("string"!=typeof c&&(c=JSON.stringify(c)),this.Ko.send(b,c)):F(this.a,"Got route message for closed route "+b)};d.onPresentationConnectionStateChanged=function(a,b){this.hc.onPresentationConnectionStateChanged(a,b)};
d.onPresentationConnectionClosed=function(a,b,c){if("function"!=typeof this.hc.onPresentationConnectionClosed)this.onPresentationConnectionStateChanged(a,"closed");else this.hc.onPresentationConnectionClosed(a,b,c)};d.nz=function(a){this.hm.delete(a);var b=this.ae.get(a);b&&b.hd(a)};d.gt=function(a,b,c){this.FL.dispatchEvent(new jo(b,c))};d.Rc=function(){this.Jba.Gn()};
d.onSinkAvailabilityUpdated=function(a,b){var c=this;if("function"==typeof this.hc.onSinkAvailabilityUpdated&&this.vm.get(a.getName())!=b){var e=this.bE();this.vm.set(a.getName(),b);a=this.bE();e!=a&&(this.hc.onSinkAvailabilityUpdated(a),0==a&&(this.Dg.forEach(function(a){c.ME(a)}),this.Dg.clear()))}};d.bE=function(){return Array.from(this.vm.values()).reduce(function(a,b){return Math.max(a,b)},0)};d.Kx=function(){return this.FL};d.dg=function(){return this.CI};
d.oJ=function(a){var b=this;return this.hm.has(a)?this.lj.get(this.hm.get(a)).Fl().then(function(c){b.hm.delete(a);return c.bO()}):Promise.resolve(!1)};d.Np=function(a,b,c,e){var f=a.Wn(b.sinkId);this.hm.set(b.id,f);return xg(this.lj.get(f).Fl(),function(f){return f.Np(b,b.mediaSource,a.fg(b.sinkId),c,e)})};d.Ou=function(a,b,c,e,f,g){var k=this.hm.get(b.id);return k?xg(this.lj.get(k).Fl(),function(k){return k.Ou(b,c,a.fg(b.sinkId),e,f,g)}):vg(Error("Route "+b.id+" is not mirroring"))};
d.fA=function(a){this.$s?a():-1==this.Zs.indexOf(a)&&this.Zs.push(a)};d.oy=function(){return this.$s};d.Vh=function(a,b){var c=this.Gs.indexOf(a),e=0<=c;b&&!e?this.Gs.push(a):!b&&e&&this.Gs.splice(c,1);this.Uy()};d.Yr=function(a){return this.Zd.find(function(b){return b.getName()==a})||null};d.$G=function(a){return a.startsWith("pseudo:")?a.substring(7):null};
d.K7=function(a,b,c,e,f,g,k,p){var q=this.$G(a),q=q?this.Yr(q):null,B=null;q&&(B=q.yg(b,c));if(B)return this.hc.onSearchSinkIdReceived(a,B.id),this.Ye(b,B.id,e,f,g,k,p);this.hc.onSearchSinkIdReceived(a,"");return Promise.reject(new Jk(0,"No sink found for search input: "+c.input+" and source: "+b))};d.yg=function(a,b,c){a=(a=this.$G(a))?this.Yr(a):null;var e=null;a&&(e=a.yg(b,c));return e?e.id:""};d.eda=function(a){this.Dg.has(a)||this.Zz(a)};
var po=function(a,b,c,e,f,g,k){this.Iba=b;this.y7=c;this.Dba=e;this.w7=f;this.Hba=g;this.O1=k};var qo=function(a,b){this.Ya=a;this.Rba=b;this.Uo=new Vd;this.o=this.Uo.promise;this.bd=rg.Qr(a.id);this.wa=new Vd;this.Fb=!1;this.Gp();this.kB();this.Db(new Wg("GET_TURN_CREDENTIALS"))};d=qo.prototype;d.start=function(){var a=this;return this.o.then(function(b){if(b.Bs())return Promise.reject(Error("Presentation already started"));b.start();return a.wa.promise})};d.stop=function(){var a=this;this.Fb=!1;return this.o.then(function(b){b.stop();a.o=Promise.reject(Error("Peer connection has already been stopped"))})};
d.Gp=function(){var a=this;this.bd.onMessage=function(b){if(b.type)switch(b.type){case "TURN_CREDENTIALS":a.Uo.resolve(new bh(a.Ya.id,b.data.credentials));break;case "ANSWER":a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "STOP":a.wa.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}else a.o.then(function(a){a.Q7({type:"PRESENTATION_CONNECTION_MESSAGE",data:b})})}};
d.kB=function(){var a=this;this.o.then(function(b){b.eN(function(b){a.Db(new Wg("OFFER",new Yg(b,null,null,a.Rba)))});b.dN(function(b){b=Xg(b);"STOP"==b.type&&a.stop();a.Db(b)});b.cN(function(){a.Fb=!0;a.Db(new Wg("SESSION_START_SUCCESS"));a.wa.resolve(a)});b.aN(function(){a.Db(new Wg("SESSION_END"))});b.bN(function(b){a.Fb||a.wa.reject(b);a.Db(new Wg("SESSION_FAILURE"))})})};d.Db=function(a){this.bd.sendMessage(a,ro)};var ro={channelType:"cloud"};var so=function(a){this.w=a;this.eb=new C;this.Pt=new Map;this.Ip=[];this.Je=this.Ml=this.Zb=this.bg=this.tl=null;this.Sl=this.ui=this.Zg=!1;this.Jp=new C;this.Jm=new C;Ci(this)};d=so.prototype;d.getName=function(){return"cloud"};
d.Ud=function(){var a=this;G(this.a,"Initializing Cloud MRP");var b=fo.N(),c=b.iW(this);this.Ip.push(c);this.tl=b.oX(this);this.Ip.push(this.tl);this.bg=b.pG();this.Zb=b.hl();this.Ml=b.dY(this);this.Je=b.tZ();this.Je.fW().then(function(b){a.Zg=b;G(a.a,"Cloud enabled setting: "+a.Zg)});this.Je.hW().then(function(b){a.ui=b;G(a.a,"Cloud on setting: "+a.ui)});this.Je.L$(function(b){a.Zg=b;G(a.a,"Cloud enabled setting: "+a.Zg);a.Zg&&a.jI()});this.Je.uY().then(function(b){a.Sl=b;G(a.a,"Privacy notified setting: "+
a.Sl)})};d.ig=function(){return this.eb.F()};
d.Jn=function(a){var b=this;if(!this.jy(a))return Lk;H(this.a,"GetAvailableSinks for "+a);var c=[];if(this.ui||this.Bba())c=this.jI();this.Jm.clear();this.Jp.F().forEach(function(a){var e=!1;c.forEach(function(b){b.bb.id==a.bb.id&&(e=!0,b.bb.friendlyName=a.bb.friendlyName)});e||b.Jm.set(a.bb.id,a)});c=c.concat(this.Jm.F());H(this.a,"Available sinks are..."+JSON.stringify(c));var e=c.map(function(a){return a.bb});this.tl&&(e=e.concat(to));return new Kk(e,-1!=a.indexOf("0F5096E8")?Rg:null)};
d.jI=function(){var a=[];G(this.a,"Checking cloud discovery services");Mi.N().Is=v();this.Ip.forEach(function(b){b=b.Nc();a=a.concat(b)});return a};d.Tj=function(){};d.Wj=function(){};d.Sj=function(){};d.Vj=function(){};d.Z=function(a){return(a=this.Ln(a))?a.bb:null};
d.Ye=function(a,b,c,e,f,g,k){var p=this;G(this.a,"createRoute called");H(this.a,"urn: "+a+" sinkId:"+b);if(f=this.Pt.get(b))return this.w.Ou(this,f,a,c,k,function(b){b.mediaSource=a;b.ze.tabId=k;return ug(b)}).bw(function(a){p.w.Jh(p,a);return a});f=this.Ln(b);return this.nr(a,f,b,c,e,g,k)};
d.sE=function(a,b,c,e){a instanceof Jk&&2==a.errorCode?this.Zj(b,6,null):(E(this.a,"Error on start session",a instanceof Error?a:Error("Expected an Error value, got "+a)),this.Zj(b,e,new sg(Mn,"warning","dismiss")));this.tl&&this.tl.D6(c)&&this.Ce([c.bb])};
d.nr=function(a,b,c,e,f,g,k){var p=this;if(f)return vg(Error("not supported"));f=!1;switch(this.Fx(b)){case "cloud":gn(1);break;case "mesi":f=!0,this.Sl||(this.Sl=!0,this.Je.J$(),g=new sg(Pn,"notification","learn_more"),g.Baa(["dismiss"]),g.M9(6320939),this.w.dg().send(g)),gn(0)}Mi.N().xj=new Li(b.model,null);var q=Pk(e,this.getName(),c,a,!0,"",null);f&&(q.customControllerPath="cloud_route_details/view.html?routeId="+q.id);this.eb.set(q.id,q);this.Pt.set(c,q);this.Jp.set(q.id,b);this.w.Ul(this,q);
this.w.Vh(this.la(),!0);if(Qg(a)&&!f)return G(this.a,"starting presentation on route: "+q.id),this.aca(q,a).catch(function(a){p.sE(a,q,b,7);throw a;});G(this.a,"starting mirroring on route: "+q.id);q.ze={tabId:k,sessionId:"",RN:"",SN:b.model};return this.w.Np(this,q,e).catch(function(a){p.sE(a,q,b,5);throw a;})};d.hd=function(a){var b=this.eb.get(a);return b?this.Zj(b,0,null):Promise.reject(new Jk(3,"Route in cloud provider not found for routeId "+a))};
d.Zj=function(a,b,c){G(this.a,"terminating route: "+a.id);this.eb.remove(a.id);this.Pt.delete(a.sinkId);var e=this.Jp.get(a.id);this.Jp.remove(a.id);c&&this.dg().send(c);Hg("MediaRouter.Cloud.Session.End",b,bn);switch(b){case 1:break;default:this.aT(e)}this.w.oj(this,a);this.eb.$b()&&this.w.Vh(this.la(),!1);this.w.onPresentationConnectionStateChanged(a.id,"terminated");this.Jm.ya(a.sinkId)&&(b=this.Jm.get(a.sinkId),this.Ce([b.bb]),this.Jm.remove(a.sinkId));return Promise.resolve()};
d.Zh=function(a,b,c){if(c&&c.channelType){c=c.channelType;var e=(a=this.eb.get(a)||void 0)?this.Ln(a.sinkId):void 0;return this.Ml.x5(c,b,a,e)}return r(b)?(this.Ad(b,a),Promise.resolve()):Promise.reject(Error("Channel type missing"))};d.fg=function(){return Eh(!0,!0)};d.Wn=function(a){var b=null;a=this.Ln(a);switch(this.Fx(a)){case "cloud":b="webrtc";break;case "mesi":b="hangouts"}G(this.a,"mirror service: "+b);return b};
d.hn=function(a,b){H(this.a,"Checking canRoute: "+a+" for sinkId: "+b);return this.jy(a)&&!!this.Z(b)};d.tk=function(a){return"chrome://media-router/cloudmrp-mirroring"==a};d.bj=function(a,b){return(a=this.eb.get(b))?ug(a):vg(Error("not supported"))};d.vi=function(){return vg(Error("not supported"))};d.eh=function(){};
d.uz=function(a){G(this.a,a.length+" sinks added");0<a.length&&!this.ui&&(this.Je.Rca(),this.ui=!0);a=this.Ln(a[0].id);Mi.N().wj=new Li(a.model,null);this.w.Rc();this.w.onSinkAvailabilityUpdated(this,2);G(this.a,"sinkAvailability changed to AVAILABLE")};d.Ce=function(a){G(this.a,a.length+" sinks removed");this.Ip.some(function(a){return 0<a.Nc().length})||(this.w.onSinkAvailabilityUpdated(this,0),G(this.a,"sinkAvailability changed to UNAVAILABLE"));this.w.Rc()};
d.Rc=function(a){G(this.a,a.length+" sinks updated");this.w.Rc()};d.dg=function(){return this.w.dg()};d.Ad=function(a,b,c){c?this.w.Be(this,b,a):this.w.gt(this,b,a)};d.Ln=function(a){var b=this.IW(a);b||(b=this.mZ(a));return b};d.IW=function(a){var b=null;this.Ip.some(function(c){b=c.Z(a);return!!b});return b};d.mZ=function(a){var b=null;(a=this.Pt.get(a))&&(b=this.Jp.get(a.id));return b};d.aT=function(a){switch(this.Fx(a)){case "cloud":this.bg.b8(a.deviceId)}};
d.Fx=function(a){return a.gO("cloud")?"cloud":a.gO("mesi")?"mesi":null};d.Bba=function(){var a=Mi.N().Is;return 3E5<=v()-a};d.jy=function(a){var b=Pg(a);a=Qg(a);if(this.Zb.Al&&!this.Zb.Df&&b)return this.w.onSinkAvailabilityUpdated(this,2),!0;var c=!1;this.Zg&&this.Zb.Df&&(c=!0);return chrome.declarativeWebRequest||this.Zb.b1()||!a?c&&(b||a):!1};d.yg=function(a,b){if(!this.jy(a))return null;(a=this.tl.eR(b))&&this.uz([a]);return a};d.la=function(){return"CloudProvider"};
d.getData=function(){return[void 0,{cloudEnabled:this.Zg,cloudOn:this.ui,notifiedHangoutsPrivacy:this.Sl}]};d.ib=function(){var a=Ai(this);a&&(a.cloudEnabled&&(this.Zg=a.cloudEnabled),a.cloudOn&&(this.ui=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.Sl=a.notifiedHangoutsPrivacy))};d.aca=function(a,b){a=new qo(a,b);return wg(a.start())};d.a=D("mr.CloudProvider");var to=new wi("pseudo:cloud","","hangout","Add a hangout","default");var uo=function(a){this.$o=a;this.a=D("mr.ExternalMessageHandler")};uo.prototype.gA=function(){chrome.runtime.onMessageExternal.addListener(this.Ch.bind(this))};
uo.prototype.Ch=function(a,b,c){if(!b.id||-1==vo.indexOf(b.id))return!1;G(this.a,"Received a message from "+b.id+" type: "+a.type);var e=chrome.runtime.id;if("start"==a.type)a=a.message,a=this.$o.yg("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new pn(a.meetingName,a.domain)),b="PresentationId"+b.id+wo++,this.$o.Ye("urn:x-org.chromium.media:source:desktop",a,b).then(function(a){c(new Ef(e,"route",a.id))}).catch(function(a){c(new Ef(e,"error",a))});else if("stop"==a.type)this.$o.hd(a.message.routeId).then(function(){c(new Ef(e,
"stopped"))});else return!1;return!0};var vo=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"],wo=0;var xo=function(){this.QK=u(this.dR,this);this.qe=new fi;this.qe.rB=!1;this.qe.ou=!1;this.rI=this.qe.aD=!1;this.aV={}};xo.prototype.O8=function(a){if(a!=this.rI){var b=Md();a?b.LC(this.QK):b.C6(this.QK);this.rI=a}};xo.prototype.dR=function(a){if(!this.aV[a.bJ]){var b=this.qe.Zw(a),c=yo;if(c)switch(a.Bh){case Bd:zo(c,"info",b);break;case Cd:zo(c,"error",b);break;case Dd:zo(c,"warn",b);break;default:zo(c,"debug",b)}}};var yo=h.console,zo=function(a,b,c){if(a[b])a[b](c);else a.log(c)};var Ao=function(){this.Nf=new bm(1E3);this.qe=new fi};d=Ao.prototype;d.init=function(){var a=this.uW();Nd("mr").pm(a);Nd("goog").pm(Ed);rd(Od(Nd("browser")));Md().LC(u(this.m3,this));this.qe.sB=!0;this.qe.ou=!0;if(a=window.localStorage["debug.logs"]){var b={all:Id,fine:Gd,info:Ed,warning:Dd,severe:Cd,off:Ad};Nd("mr").pm(b[a.toLowerCase()]||Gd)}window.localStorage["debug.console"]&&(a=new xo,a.qe.sB=!0,a.qe.ou=!0,a.qe.rB=!0,a.O8(!0))};
d.m3=function(a){this.Nf.enqueue(this.qe.Zw(a));(a=a.tr)&&a.stack&&this.Nf.enqueue(a.stack)};d.getLogs=function(){return 0==this.Nf.S()?"NA":this.Nf.F().join("")};d.uW=function(){return Ed};d.n6=function(){Ci(this)};d.la=function(){return"LogManager"};d.getData=function(){return[this.Nf.F()]};d.ib=function(){var a=this.Nf.F();this.Nf.clear();for(var b=ia(zi(this)||[]),c=b.next();!c.done;c=b.next())this.Nf.enqueue(c.value);a=ia(a);for(c=a.next();!c.done;c=a.next())this.Nf.enqueue(c.value)};ra(Ao);var Bo=function(a){this.$o=a};Bo.prototype.gA=function(){chrome.runtime.onMessage.addListener(this.l3.bind(this))};
Bo.prototype.l3=function(a,b,c){if(b.id!=chrome.runtime.id||b.url!="chrome-extension://"+b.id+"/feedback.html")return!1;if("retrieve_log_data"==a.type){var e={logs:Ao.N().getLogs(),device:Mi.N().QY()};b=Df(e.device.ip).then(function(a){a&&(e.device.version=a)});var f=this.$o.gY("cast_streaming").then(function(b){return b.hY(a.source)}).then(function(a){e.castStreamingLogs=a});Gl([b,f]).then(function(){c(e)});return!0}return!1};var Co,Do=D("mr.Init"),Eo=function(a){var b=new $k(a),c=new Xl(a,b),b=[b,c];b.push(new so(a));return b};Ao.N().init();Co=new Bg("MediaRouter.Provider.WakeDuration");
var Fo=new no,Go=(new Promise(function(a,b){switch(window.location.host){case "enhhojjnijigcajfphajepfemndkmdlo":a();break;case "pkedcjkdefgpdelpbcmbmeomcjbeemfm":chrome.management.get("enhhojjnijigcajfphajepfemndkmdlo",function(c){chrome.runtime.lastError||!c.enabled?a():b(Error("Dev extension is enabled"))});break;default:b(Error("Unknown extension id"))}})).then(function(){return chrome.mojoPrivate&&chrome.mojoPrivate.requireAsync?new Promise(function(a){chrome.mojoPrivate.requireAsync("media_router_bindings").then(function(b){b.start().then(function(c){a({mrService:b,mrInstanceId:c})})})}):
Promise.reject(Error("No mojo service loaded"))}).then(function(a){if(!a.mrService)throw Error("Failed to get MR service");var b=a.mrInstanceId;if(!b)throw Error("Failed to get MR instance ID.");G(Do,"MR instance ID: "+b);a=a.mrService;if(!Fo)throw Error("providerManager not initialized.");a.setHandlers(Fo);Ei(b)&&Co.qm("MediaRouter.Provider.FirstWakeDuration");chrome.runtime.onSuspend.addListener(Co.end.bind(Co));Ii(b);Ao.N().n6();b=Eo(Fo);window.addEventListener("unhandledrejection",function(a){a=
a.reason;a.stack||(a=Error(a));E(Do,"Unhandled promise rejection.",a)});Fo.Ud(a,b)}).then(void 0,function(a){F(Do,a.message);throw a;});(function(a){[].concat([new Bo(a),new uo(a)],ka([].concat(ka(Rl()),ka([jj(),lj()])))).forEach(function(a){return a.gA()});a=fo.N().XF();chrome.gcm.onMessage.addListener(a.onMessage.bind(a))})(Fo);Go.then(void 0,function(){return window.close()});
